/* USER CODE BEGIN Header */
/**
 ******************************************************************************
 * @file           : main.c
 * @brief          : Main program body
 ******************************************************************************
 * @attention
 *
 * Copyright (c) 2025 STMicroelectronics.
 * All rights reserved.
 *
 * This software is licensed under terms that can be found in the LICENSE file
 * in the root directory of this software component.
 * If no LICENSE file comes with this software, it is provided AS-IS.
 *********************************************
 * References
 * printf SWO tutorial: https://youtu.be/iR34qmfyZtU?si=ymslVCKYRUU1sUiR
 *
 * Googoomuck github project is what informed me this was even possible on
 * this hardware: https://github.com/deadsy/googoomuck
 *
 * MIDI UART: https://learn.sparkfun.com/tutorials/midi-tutorial/all
 *
 * Double Buffering for I2S sound drive: https://www.youtube.com/watch?v=zlGSxZGwj-E
 *
ADCs
IN1 LPQF
IN3 Decay
IN8 Fx Amt
IN9 Attack
IN11 Release
IN12 Waveform
IN14 Leg/Arp Rt

Buttons
PB4 PLA button
PE5 Preset button
PD0 Fx button
PE4 Doodle button

LEDs
PB5 Poly
PB7 Legato
PD7 Arp
PE2 Pre 1
PE0 Pre 2
PB8 Pre 3
PC8 Vib
PA15 Trem
PC11 X FX
PC13 LED
 *
 ******************************************************************************
 */
/* USER CODE END Header */
/* Includes ------------------------------------------------------------------*/
#include "main.h"

/* Private includes ----------------------------------------------------------*/
/* USER CODE BEGIN Includes */
#include <math.h>
#include <stdio.h>
#include <string.h>


/* USER CODE END Includes */

/* Private typedef -----------------------------------------------------------*/
/* USER CODE BEGIN PTD */

/* USER CODE END PTD */

/* Private define ------------------------------------------------------------*/
/* USER CODE BEGIN PD */
#define PI 3.1415926535897932384626433832795028841971693993751058209749445923078164062862089986280348253421170679f
#define TAU (2.0f * PI)
#define BUFFER_SIZE 128 //Phil's lab used 128
#define INT16_TO_FLOAT 1.0f/(32767.0f)
#define FLOAT_TO_INT16 32767.0f
#define FS 32063.0f //42751.0f ////see .ioc see for kHz inaccuracy
#define TS 1.0f/(float)FS // sample time
#define SINE_LOOKUP_SIZE 4096
#define WAVE_TABLE_SIZE 128

#define max(a,b) ((a) > (b) ? (a) : (b))
#define min(a,b) ((a) < (b) ? (a) : (b))

//compressor
// These ratios are more like a limiter
#define thresh -6.0f
#define ratio  0.33f //s.t. thresh + (3-thresh)*ratio = 1. 3 is a realistic max sample.
#define COMP_TABLE_SIZE 1024
//#define thresh 0.5f
//#define ratio  0.5f //s.t. thresh + (3-thresh)*ratio = 1. 3 is a realistic max sample.

#define N_ADC 7

#define RX_BUFFER_SIZE 256

// For ftable. I know it's redundant with other variables.
#define MIDI_PITCH_MIN 0
#define MIDI_PITCH_MAX 127
#define MIDI_PITCH_COUNT (MIDI_PITCH_MAX - MIDI_PITCH_MIN + 1) // 128 notes
#define A4_FREQUENCY 440.0f // Frequency of A4 in Hz
#define A4_MIDI_NOTE 69     // MIDI note number for A4

#define MIDI_PTR_HIST_SIZE 16

#define N_VOICES 10 //20 is def too many

// DAC PARAMS from GOOGOOMUCK
#if 1
#define DACADDR 0x94
#define CS43L22_REG_ID                              0x01
#define CS43L22_REG_Power_Ctl_1                     0x02
#define CS43L22_REG_Power_Ctl_2                     0x04
#define CS43L22_REG_Clocking_Ctl                    0x05
#define CS43L22_REG_Interface_Ctl_1                 0x06
#define CS43L22_REG_Interface_Ctl_2                 0x07
#define CS43L22_REG_Passthrough_A_Select            0x08
#define CS43L22_REG_Passthrough_B_Select            0x09
#define CS43L22_REG_Analog_ZC_and_SR_Settings       0x0A
#define CS43L22_REG_Passthrough_Gang_Control        0x0C
#define CS43L22_REG_Playback_Ctl_1                  0x0D
#define CS43L22_REG_Misc_Ctl                        0x0E
#define CS43L22_REG_Playback_Ctl_2                  0x0F
#define CS43L22_REG_Passthrough_A_Vol               0x14
#define CS43L22_REG_Passthrough_B_Vol               0x15
#define CS43L22_REG_PCMA_Vol                        0x1A
#define CS43L22_REG_PCMB_Vol                        0x1B
#define CS43L22_REG_BEEP_Freq_On_Time               0x1C
#define CS43L22_REG_BEEP_Vol_Off_Time               0x1D
#define CS43L22_REG_BEEP_Tone_Cfg                   0x1E
#define CS43L22_REG_Tone_Ctl                        0x1F
#define CS43L22_REG_Master_A_Vol                    0x20
#define CS43L22_REG_Master_B_Vol                    0x21
#define CS43L22_REG_Headphone_A_Volume              0x22
#define CS43L22_REG_Headphone_B_Volume              0x23
#define CS43L22_REG_Speaker_A_Volume                0x24
#define CS43L22_REG_Speaker_B_Volume                0x25
#define CS43L22_REG_Channel_Mixer_Swap              0x26
#define CS43L22_REG_Limit_Ctl_1_Thresholds          0x27
#define CS43L22_REG_Limit_Ctl_2_Release_Rate        0x28
#define CS43L22_REG_Limiter_Attack_Rate             0x29
#define CS43L22_REG_Overflow_Clock_Status           0x2E
#define CS43L22_REG_Battery_Compensation            0x2F
#define CS43L22_REG_VP_Battery_Level                0x30
#define CS43L22_REG_Speaker_Status                  0x31
#define CS43L22_REG_Charge_Pump_Frequency           0x34
#endif

#define ADR_TABLE_SIZE 256

// Some macros for effects
#define VIB_MASK 0b001
#define TREM_MASK 0b010
#define LPM_MASK 0b100

// Note state data structure
typedef struct {
    uint8_t  vel[MIDI_PITCH_COUNT];            // MIDI standard velocity (0-127) for each pitch
    uint8_t  released[MIDI_PITCH_COUNT];       // True if the note has been released, false if pressed for each pitch
    uint32_t ticks_pressed[MIDI_PITCH_COUNT];  // Ticks elapsed since the note was pressed for each pitch
    uint32_t ticks_released[MIDI_PITCH_COUNT]; // Ticks elapsed since the note was released for each pitch
    float    env[MIDI_PITCH_COUNT];            // Current envelope level (e.g., 0.0 to 1.0) for each pitch
    float    phase_decimal[MIDI_PITCH_COUNT]; // fractional part of phase (LUT
    uint16_t phase_integer[MIDI_PITCH_COUNT]; // integer part of phase.
} Notes; // Renamed to Notes (plural) as it now holds data for multiple notes

typedef struct {
    uint8_t  vel;            // MIDI standard velocity (0-127) for each pitch
    uint8_t  released;       // True if the note has been released, false if pressed for each pitch
    uint32_t ticks_pressed;  // Ticks elapsed since the note was pressed for each pitch
    uint32_t ticks_released; // Ticks elapsed since the note was released for each pitch
    float    freq;							   // freq (Hz)
    float    target_freq;                      // target freq (Hz)
    uint8_t  target_pitch;					   // target pitch (MIDI 0-127)
    float    env;            // Current envelope level (e.g., 0.0 to 1.0) for each pitch
    float 	 current_phase;  // Phase w.r.t lookuptable.
} LegatoNote;

typedef struct {
	uint8_t bools[MIDI_PITCH_COUNT];
	uint8_t vels[MIDI_PITCH_COUNT];
	uint8_t notes[MIDI_PITCH_COUNT];
	uint8_t num_notes;
	uint32_t ticks_played;
	uint8_t cycle_num;
	uint8_t cycle_map[16];
} ArpeggioState;



/* USER CODE END PD */

/* Private macro -------------------------------------------------------------*/
/* USER CODE BEGIN PM */

/* USER CODE END PM */

/* Private variables ---------------------------------------------------------*/
ADC_HandleTypeDef hadc1;
DMA_HandleTypeDef hdma_adc1;

I2C_HandleTypeDef hi2c1;

I2S_HandleTypeDef hi2s3;
DMA_HandleTypeDef hdma_spi3_tx;

SPI_HandleTypeDef hspi1;

UART_HandleTypeDef huart2;
DMA_HandleTypeDef hdma_usart2_rx;

PCD_HandleTypeDef hpcd_USB_OTG_FS;

/* USER CODE BEGIN PV */
uint16_t rc = 999;
int16_t dac_data[BUFFER_SIZE];
// ADC Variables
uint16_t AD_RES_BUFFER[N_ADC];
uint16_t AD_RES_COPY[N_ADC];
uint8_t AD_LPF;
uint8_t AD_decay;
uint8_t AD_FX;
uint8_t AD_attack;
uint8_t AD_release;
uint8_t AD_waveform;
uint8_t AD_LA_rate;
uint8_t wave_knob_edges[] = {7,26,56,99,151,194,222,245};

// Button variables
uint8_t PLA_press;
uint8_t preset_press;
uint8_t FX_press;
uint8_t doodle_press;

// ARPEGG VARIABLES
volatile uint8_t arp_ind;
volatile uint8_t arp_pitch;
volatile uint8_t arp_vel;

// Button states
uint8_t doodle_mode;
uint64_t loops_doodle_press = 0;
uint64_t loops_preset_press = 0;
volatile uint64_t loops_PLA_press = 0;
uint64_t loops_FX_press = 0;
uint64_t loops_sustain_press = 0;
uint8_t  rotor = 1;
volatile float vib_freq;
volatile float vib_amp;

uint8_t preset_ind;
uint8_t preset_disp_map[] = {0, 0b001, 0b010, 0b100, 0b011, 0b110, 0b101, 0b111};

uint8_t FX_ind = 0;
uint8_t FX_bool_map[] = {0, 0b001, 0b010, 0b100, 0b101, 0b110};

uint8_t PLA_ind = 0;
uint8_t PLA_disp_map[] = {0b001, 0b010, 0b100};
uint8_t arp_cycle_map[16] = {0,6,3,2,8,1,9,4,5,15,11,12,14,10,13,7};
uint8_t arp_cycle_matrix[10][10] = {
        {0, 0, 0, 0, 0, 0, 0, 0, 0, 0}, // Row 0 (1 note).  Only up to index 0 matters.
        {0, 1, 0, 0, 0, 0, 0, 0, 0, 0},  // Row 1 (2 notes). Only up to index 1 matters.
		{0, 2, 1, 0, 0, 0, 0, 0, 0, 0}, // 2 (3 notes)
		{0, 2, 1, 3, 0, 0, 0, 0, 0, 0},
		{0, 3, 1, 2, 4, 0, 0, 0, 0, 0}, // 4 (5 notes)
		{0, 3, 1, 2, 5, 4, 0, 0, 0, 0}, // 5 (6 notes)
		{0, 3, 1, 6, 5, 4, 2, 0, 0, 0}, // 6 (7 notes)
		{0, 3, 1, 6, 5, 4, 7, 2, 0, 0}, // 7 (8 notes)
		{0, 6, 1, 3, 4, 8, 2, 7, 5, 0}, // 8 (9 notes)
		{0, 6, 1, 9, 4, 8, 2, 7, 5, 3}, // 9 (10 notes)
    };

uint8_t preset_matrix[7][10] = {
// AD_LPF, AD_decay, AD_FX, AD_attack, AD_release, AD_waveform, AD_LA_rate, doodle_mode, PLA_ind, FX_ind
		{2, 128, 162, 53, 59, 206, 195, 0, 0, 3}, //1: funky wah saw
		{129, 174, 55, 103, 64, 198, 130, 0, 1, 1}, //2: searing saw lead
		{141, 129, 54, 92, 72, 0, 130, 1, 0, 1}, //3 : cello suite
		{91, 129, 53, 20, 69, 255, 130, 1, 0, 1},//4: little piano
		{102, 73, 56, 45, 82, 125, 87, 0, 0, 0},//5: harp dreams
		{88, 255, 50, 23, 38, 86, 87, 0, 0, 1},//6: pocket hammond
		{154, 175, 55, 88, 64, 231, 55, 1, 0, 1},//7: clarinet choir

};



volatile uint32_t ticks_arpeggio;

// Effects states
float    trem_phase;
uint16_t trem_phase_int;
float    vib_phase;
uint16_t vib_phase_int;
float    total_env;

// MIDI and UART handling
uint8_t RX_UART[RX_BUFFER_SIZE];
volatile uint16_t old_pos = 0;
typedef enum { // MIDI command states
    LAST_READ_STATUS,
    LAST_READ_PITCH,
    LAST_READ_VELOCITY,
	LAST_READ_CONTROL, // Control event, i.e. pedal
    LAST_READ_PEDAL, // Control event identifier = 0d40
	LAST_READ_PEDAL_VELOCITY,
    LAST_READ_NONE, // Good to have an initial/default state
} lastRead_t; // Using a typedef for easier use, and _t suffix is common for enums/structs
lastRead_t current_last_read = LAST_READ_NONE;
uint8_t in_note_event = 0;
volatile uint16_t curr_MIDI_pitch = 255; //actual values are 0-127
volatile uint16_t MIDI_ptr = 253;
volatile uint8_t playing_note;
volatile uint8_t sustain = 0;

// Useful for "where am I" debugging. View this variable in live expressions during debug.
volatile uint8_t debug_flag;
// Keep track of what notes are being played or released (lingering)
volatile uint8_t active_notes[N_VOICES];
volatile uint8_t num_active_notes;

volatile Notes my_midi_notes; // Declare an instance of the Notes struct
LegatoNote my_legato_note; // declare an instance of legato note
ArpeggioState arp_state;

// Audio output double buffering state variables. 'Volatile' tells the compiler
// not to optimize away, because compiler is confused by interrupt variables.
static volatile int16_t *out_buf_ptr = &dac_data[0];
volatile uint8_t data_ready_flag = 0; // added this = 0
volatile uint8_t write_first_half = 0;
volatile uint64_t ticks = 0; //number of samples output
volatile uint64_t loops = 0;

// Button flag
volatile uint8_t button_flag = 0;
// Waveform mode
uint8_t wave_mode = 0;
uint8_t num_wave_modes = 4;
const float *p_wave_table;

// Legato mode
uint8_t legato_mode = 0;
// Arpeggio mode
uint8_t arpeggio_mode = 0;

// Can use this nice ode to joy with bassline if you don't have keyboard input yet
int8_t ode_to_joy[] =  {4,4,5,7,7,5,4,2,0,0,2,4,4,4,2,2,4,4,5,7,7,5,4,2,0,0,2,4,2,2,0,0};
int8_t ode_to_joy2[] = {0, -5, -3, -1, -5, -3, -4, -1, -3, -4, -5, -6, -10, -6, -5, -1, 0, -5, -3, -1, -5, -3, -4, -1, -3, -4, -10, -6, -7, -5, -8, -12};
uint8_t len_joy = sizeof(ode_to_joy);

// Studying max samples for compression
float samp_max = 0.0f;
float attack_coeff = exp(-1.0 / (10.0 * FS / 1000.0));
float release_coeff = exp(-1.0 / (100.0 * FS / 1000.0));
float envelope_gain = 1.0;

// Filtering
float a_coeffs[5] = {1.0f         ,-3.25488493f,  4.02988597f, -2.24299626f,  0.47269615f}; // b0, b1, b2, b3, b4
float b_coeffs[5] = {0.00029381f, 0.00117523f, 0.00176285f, 0.00117523f, 0.00029381f};    // a0, a1, a2, a3, a4 (a0 should be 1.0)
float w_states[4] = {0.0f, 0.0f, 0.0f, 0.0f}; // w1, w2, w3, w4

// WWaveform lookup tables
#if 1

//assuming a sampling rate of 44kHz, this table goes from 440 Hz cutoff to 20k cutoff, with log spacing
//245 * 5 entries // 150/40k. For 4th order filters.
const float a_table[] = {
		1.0, -3.835825540647348, 5.520819136622229, -3.5335352194630145, 0.848555999266477, 1.0, -3.8332483565553495, 5.513507600922927, -3.526614081756418, 0.8463701183916887, 1.0, -3.830630729697611, 5.506087921312571, -3.5195965899386197, 0.8441556412439922, 1.0, -3.8279720260620476, 5.498558607781811, -3.51248160073554, 0.8419122840729084, 1.0, -3.8252716017277453, 5.490918153381163, -3.5052679636862556, 0.8396397631898608, 1.0, -3.82252880271154, 5.4831650341530995, -3.497954521328069, 0.8373377950809864, 1.0, -3.819742964812283, 5.475297709069018, -3.490540109391955, 0.8350060965239359, 1.0, -3.8169134134527667, 5.467314619971363, -3.483023557008737, 0.8326443847087583,
		1.0, -3.814039463519293, 5.4592141915211725, -3.475403686926331, 0.8302523773629524, 1.0, -3.8111204191988137, 5.450994831151252, -3.4676793157383066, 0.8278297928807439, 1.0, -3.8081555738136617, 5.4426549290253465, -3.4598492541242125, 0.8253763504567007, 1.0, -3.8051442096537906, 5.4341928580035095, -3.451912307101895, 0.8228917702237374, 1.0, -3.802085597806532, 5.42560697361403, -3.4438672742922494, 0.8203757733956086, 1.0, -3.7989789979838027, 5.416895614032181, -3.43571295019668, 0.8178280824139594, 1.0, -3.7958236583467544, 5.408057100066128, -3.427448124487691, 0.815248421100012, 1.0, -3.792618815327815, 5.399089735150311, -3.4190715823129176, 0.8126365148109701,
		1.0, -3.7893636934501034, 5.389991805346672, -3.4105821046130242, 0.8099920906012175, 1.0, -3.78605750514416, 5.380761579354002, -3.4019784684537786, 0.8073148773883757, 1.0, -3.7826994505619878, 5.371397308525852, -3.39325944737275, 0.8046046061243086, 1.0, -3.7792887173883454, 5.361897226897337, -3.3844238117409673, 0.801861009971134, 1.0, -3.7758244806492725, 5.352259551221211, -3.3754703291399655, 0.7990838244823225, 1.0, -3.772305902517802, 5.3424824810136275, -3.3663977647545926, 0.7962727877889438, 1.0, -3.768732132116834, 5.332564198609988, -3.357204881781989, 0.7934276407911298, 1.0, -3.7651023053191244, 5.322502869231296, -3.3478904418571513, 0.7905481273548208,
		1.0, -3.761415544544369, 5.312296641061461, -3.3384532054954863, 0.7876339945138547, 1.0, -3.7576709585533283, 5.301943645335983, -3.3288919325527693, 0.7846849926774547, 1.0, -3.7538676422389727, 5.291441996442514, -3.319205382702939, 0.7817008758431782, 1.0, -3.7500046764146076, 5.280789792033727, -3.3093923159341347, 0.7786814018153726, 1.0, -3.7460811275989334, 5.269985113153012, -3.299451493063414, 0.7756263324291885, 1.0, -3.7420960477980323, 5.2590260243735525, -3.2893816762706094, 0.772535433780211, 1.0, -3.738048474284195, 5.247910573951153, -3.279181629651671, 0.7694084764597111, 1.0, -3.7339374293716228, 5.236636793991582, -3.2688501197920656, 0.7662452357956124,
		1.0, -3.729761920188887, 5.225202700632743, -3.2583859163605244, 0.7630454920991463, 1.0, -3.7255209384481893, 5.2136062942424575, -3.247787792723709, 0.7598090309172718, 1.0, -3.7212134602113256, 5.201845559632292, -3.2370545265821415, 0.7565356432908511, 1.0, -3.716838445652348, 5.189918466288113, -3.226184900627892, 0.7532251260186125, 1.0, -3.7123948388168913, 5.17782296861798, -3.2151777032244566, 0.749877281926914, 1.0, -3.7078815673781063, 5.16555700621801, -3.2040317291092606, 0.7464919201453055, 1.0, -3.703297542389189, 5.153118504156861, -3.1927457801192194, 0.7430688563878907, 1.0, -3.698641658032454, 5.140505373279551, -3.181318665939836, 0.739607913240488,
		1.0, -3.6939127913649203, 5.127715510531257, -3.1697492048782094, 0.7361089204535652, 1.0, -3.6891098020603836, 5.114746799301871, -3.158036224660455, 0.7325717152409347, 1.0, -3.684231532147926, 5.101597109792001, -3.1461785632539243, 0.7289961425841758, 1.0, -3.6792768057468437, 5.088264299401203, -3.1341750697146558, 0.7253820555427399, 1.0, -3.67424442879794, 5.074746213139221, -3.1220246050604996, 0.7217293155697067, 1.0, -3.669133188791169, 5.0610406840610125, -3.1097260431702964, 0.7180377928331121, 1.0, -3.66394185448959, 5.047145533726437, -3.0972782717095653, 0.7143073665428122, 1.0, -3.658669175649588, 5.033058572685376, -3.084680193083042, 0.7105379252827737,
		1.0, -3.6533138827373444, 5.018777600989222, -3.071930725414508, 0.7067293673487344, 1.0, -3.647874686641523, 5.004300408729607, -3.059028803554277, 0.7028816010911204, 1.0, -3.642350278382124, 4.989624776605243, -3.0459733801146767, 0.6989945452631152, 1.0, -3.636739328815495, 4.97474847651788, -3.032763426533934, 0.6950681293737622, 1.0, -3.631040488335465, 4.959669272198323, -3.01939793416878, 0.6911022940459715, 1.0, -3.6252523865705477, 4.944384919863436, -3.0058759154160732, 0.6870969913792755, 1.0, -3.61937363207723, 4.928893168905268, -2.9921964048638268, 0.6830521853171936, 1.0, -3.6134028120292743, 4.913191762613225, -2.9783584604718643, 0.6789678520190168,
		1.0, -3.6073384919030227, 4.897278438930399, -2.9643611647823933, 0.674843980235833, 1.0, -3.6011792151586905, 4.881150931245176, -2.950203626160794, 0.670680571690602, 1.0, -3.5949235029176014, 4.864806969219194, -2.935884980066795, 0.6664776414620517, 1.0, -3.5885698536353496, 4.848244279652821, -2.92140439035628, 0.6622352183721731, 1.0, -3.582116742770861, 4.831460587389315, -2.9067610506138917, 0.6579533453770637, 1.0, -3.57556262245134, 4.814453616258891, -2.8919541855165978, 0.6536320799608621, 1.0, -3.5689059211330587, 4.797221090063905, -2.87698305222833, 0.6492714945324858, 1.0, -3.562145043257992, 4.7797607336064125, -2.8618469418257977, 0.6448716768248831,
		1.0, -3.5552783689062633, 4.762070273759415, -2.84654518075553, 0.6404327302964772, 1.0, -3.54830425344438, 4.744147440583087, -2.8310771323221804, 0.635954774534476, 1.0, -3.541221027169252, 4.725989968487343, -2.8154421982080557, 0.6314379456596885, 1.0, -3.5340269949479657, 4.707595597442125, -2.7996398200238466, 0.6268823967324805, 1.0, -3.526720435853303, 4.688962074236815, -2.7836694808904285, 0.6222882981594792, 1.0, -3.5192996027949928, 4.670087153790218, -2.767530707051622, 0.6176558381006122, 1.0, -3.5117627221466714, 4.650968600512579, -2.751223069517692, 0.6129852228760526, 1.0, -3.504107993368556, 4.631604189721144, -2.7347461857393864, 0.6082766773726209,
		1.0, -3.4963335886258013, 4.611991709110791, -2.7180997213121607, 0.6035304454491565, 1.0, -3.488437652402545, 4.592128960281306, -2.701283391710312, 0.5987467903403846, 1.0, -3.480418301111632, 4.572013760322904, -2.6842969640505614, 0.5939259950587479, 1.0, -3.4722736226999964, 4.551643943461609, -2.6671402588846402, 0.5890683627936648, 1.0, -3.46400167624971, 4.531017362766159, -2.6498131520203354, 0.5841742173076595, 1.0, -3.4556004915746947, 4.5101318919181725, -2.6323155763704245, 0.5792439033287798, 1.0, -3.4470680688130733, 4.488985427047227, -2.6146475238287814, 0.5742777869386892, 1.0, -3.4384023780151827, 4.467575888632686, -2.59680904717295, 0.5692762559558137,
		1.0, -3.4296013587272314, 4.445901223474021, -2.5788002619923454, 0.5642397203128859, 1.0, -3.4206629195706078, 4.423959406731484, -2.5606213486411913, 0.5591686124282176, 1.0, -3.4115849378168353, 4.401748444038971, -2.542272554215189, 0.5540633875699937, 1.0, -3.402365258958178, 4.379266373690973, -2.523754194550861, 0.5489245242128776, 1.0, -3.3930016962739007, 4.356511268905568, -2.50506665624641, 0.5437525243861813, 1.0, -3.3834920303921763, 4.333481240165363, -2.4862103987027875, 0.5385479140128278, 1.0, -3.3738340088476693, 4.310174437638454, -2.467185956183699, 0.5333112432383372, 1.0, -3.3640253456347486, 4.2865890536813325, -2.4479939398929638, 0.5280430867489955,
		1.0, -3.3540637207563977, 4.2627233254259025, -2.4286350400677827, 0.5227440440784116, 1.0, -3.343946779768769, 4.238575537452636, -2.409110028086139, 0.5174147399015776, 1.0, -3.333672133321418, 4.214144024552016, -2.3894197585865955, 0.5120558243155824, 1.0, -3.3232373566932045, 4.18942717457641, -2.3695651715985204, 0.5066679731060666, 1.0, -3.312639989323875, 4.164423431384627, -2.3495472946807734, 0.5012518879985259, 1.0, -3.3018775343413083, 4.1391312978813, -2.3293672450666074, 0.49580829689351447, 1.0, -3.290947458084435, 4.1135493391534155, -2.309026231812536, 0.4903379540848054, 1.0, -3.2798471896218313, 4.087676185706286, -2.288525557948724, 0.4848416404595505,
		1.0, -3.2685741202659684, 4.06151053680126, -2.267866622628317, 0.4793201636794482, 1.0, -3.2571256030831144, 4.035051163897558, -2.247050923272976, 0.47377435834192594, 1.0, -3.245498952398874, 4.008296914200625, -2.2260800577117683, 0.4682050861203346, 1.0, -3.2336914432993655, 3.981246714319451, -2.2049557263103807, 0.46261323588213193, 1.0, -3.22170031112798, 3.953899574035267, -2.1836797340874408, 0.45699972378401793, 1.0, -3.209522750977732, 3.9262545901842065, -2.1622539928146383, 0.45136549334299764, 1.0, -3.1971559171791437, 3.898310950656374, -2.1406805230970853, 0.445711515482311, 1.0, -3.184596922783646, 3.8700679385139978, -2.1189614564302612, 0.4400387885511958,
		1.0, -3.171842839042421, 3.841524936231161, -2.0970990372296208, 0.4343483383174145, 1.0, -3.1588906948806574, 3.8126814300578578, -2.075095624828853, 0.428641217931504, 1.0, -3.145737476367141, 3.783537014511016, -2.052953695442533, 0.42291850786169655, 1.0, -3.1323801261790996, 3.7540913969952077, -2.0306758440887114, 0.4171813157984564, 1.0, -3.1188155430622317, 3.7243444025558388, -2.008264786466834, 0.4114307765276051, 1.0, -3.1050405812857917, 3.6942959787676055, -1.9857233607861304, 0.4056680517709936, 1.0, -3.0910520500926446, 3.6639462007610883, -1.9630545295394395, 0.3998943299937141, 1.0, -3.076846713144145, 3.633295276390398, -1.94026138121722, 0.3941108261768495,
		1.0, -3.062421287959685, 3.60234355154479, -1.917347131956245, 0.38831878155477156, 1.0, -3.0477724453507564, 3.57109151560727, -1.894315127117296, 0.38251946331603665, 1.0, -3.0328968088493298, 3.5395398070632695, -1.8711688427859383, 0.376714164266945, 1.0, -3.0177909541303505, 3.507689219262494, -1.8479118871902065, 0.37090420245686184, 1.0, -3.0024514084280964, 3.4755407063371107, -1.8245480020287947, 0.36509092076442873, 1.0, -2.986874649946154, 3.443095389279552, -1.801081063703124, 0.35927568644383917, 1.0, -2.9710571072607115, 3.410354562183263, -1.7775150844463925, 0.35345989063039274, 1.0, -2.9549951587168373, 3.3773196986497465, -1.753854213342439, 0.34764494780458044,
		1.0, -2.938685131817417, 3.3439924583654865, -1.7301027372270652, 0.3418322952140267, 1.0, -2.9221233026043025, 3.3103746938522125, -1.7062650814640659, 0.33602339225263933, 1.0, -2.9053058950313018, 3.2764684573943046, -1.6823458105881055, 0.3302197197964175, 1.0, -2.888229080328471, 3.2422760081470363, -1.6583496288061406, 0.3244227794953987, 1.0, -2.870888976357243, 3.2077998194296513, -1.6342813803489415, 0.31863409302133155, 1.0, -2.853281646955769, 3.173042586207229, -1.6101460496638471, 0.3128552012707072, 1.0, -2.8354031012738905, 3.1380072327656126, -1.5859487614397068, 0.3070876635228998, 1.0, -2.8172492930970314, 3.1026969205836745, -1.561694780454546, 0.3013330565532261,
		1.0, -2.798816120158281, 3.0671150564074714, -1.5373895112362657, 0.2955929737008551, 1.0, -2.780099423437858, 3.031265300530978, -1.513038497526292, 0.289869023891588, 1.0, -2.761094986449085, 2.9951515752883116, -1.488647421535805, 0.2841628306156432, 1.0, -2.7417985345099085, 2.958778073762566, -1.4642221029837883, 0.2784760308607, 1.0, -2.7222057339989494, 2.9221492687166393, -1.439768497905819, 0.2728102740005742, 1.0, -2.702312191594965, 2.8852699217517137, -1.415292697222124, 0.26716722064003895, 1.0, -2.6821134534985287, 2.8481450926993137, -1.3908009250530542, 0.2615485414164355, 1.0, -2.6616050046346142, 2.810780149253197, -1.366299536769713, 0.2559559157588706,
		1.0, -2.640782267834704, 2.7731807768477195, -1.3417950167670836, 0.25039103060595447, 1.0, -2.619640602996916, 2.735352988789663, -1.317293975946546, 0.24485557908319727, 1.0, -2.598175306222519, 2.6973031366509304, -1.2928031488942104, 0.23935125914135377, 1.0, -2.5763816089271296, 2.6590379209300385, -1.2683293907410544, 0.23387977215719666, 1.0, -2.554254676924687, 2.6205644019907104, -1.243879673690271, 0.22844282149837886, 1.0, -2.5317896094822663, 2.581890011286616, -1.2194610831968262, 0.2230421110542728, 1.0, -2.508981438343535, 2.543022562881659, -1.1950808137834938, 0.21767934373485498, 1.0, -2.4858251267186287, 2.5039702652761067, -1.1707461644772204, 0.21235621993997,
		1.0, -2.462315568237954, 2.4647417335493635, -1.1464645338488757, 0.20707443600150838, 1.0, -2.4384475858673618, 2.4253460018311093, -1.122243414638888, 0.20183568260131435, 1.0, -2.414215930781885, 2.3857925361132724, -1.098090387950461, 0.19664164316788285, 1.0, -2.3896152811950886, 2.346091247416236, -1.0740131169913192, 0.1914939922551914, 1.0, -2.364640241140913, 2.306252505323736, -1.0500193403441094, 0.1863943939073103, 1.0, -2.3392853392046318, 2.26628715190187, -1.0261168647446555, 0.18134450001273555, 1.0, -2.3135450271993916, 2.2262065160188977, -1.0023135573462993, 0.17634594865272077, 1.0, -2.2874136787845556, 2.186022428083737, -0.9786173374475202, 0.17140036244822954,
		1.0, -2.260885588021867, 2.145747235222463, -0.9550361676588913, 0.16650934691049962, 1.0, -2.2339549678651927, 2.1053938169135824, -0.9315780444841669, 0.16167448880059138, 1.0, -2.206615948579352, 2.064975601104449, -0.9082509882889653, 0.1568973545037082, 1.0, -2.1788625760833105, 2.024506580832983, -0.8850630326290511, 0.1521794884245162, 1.0, -2.150688810212733, 1.9840013313807316, -0.862022212908622, 0.14752241141015604, 1.0, -2.122088522896627, 1.9434750279853286, -0.8391365543372655, 0.14292761920813835, 1.0, -2.093055496242447, 1.902943464142575, -0.8164140591522867, 0.1383965809668355, 1.0, -2.063583420523875, 1.8624230705309044, -0.793862693071134, 0.13393073778687237,
		1.0, -2.0336658920650565, 1.8219309345934058, -0.7714903709362662, 0.1295315013323135, 1.0, -2.0032964110147913, 1.781484820815425, -0.7493049415123167, 0.12520025251120226, 1.0, -1.972468379003872, 1.7411031917387914, -0.7273141713927056, 0.12093834023572568, 1.0, -1.9411750966784203, 1.700805229756941, -0.7055257279697902, 0.11674708027303737, 1.0, -1.9094097611016987, 1.6606108597386866, -0.6839471614193497, 0.11262775419859873, 1.0, -1.87716546301654, 1.6205407725321685, -0.6625858856465506, 0.10858160846480124, 1.0, -1.8444351839601616, 1.5806164494045805, -0.641449158136536, 0.104609853598607, 1.0, -1.8112117932227916, 1.5408601874776846, -0.6205440586484064, 0.10071366354301686,
		1.0, -1.7774880446411077, 1.5012951262237828, -0.599877466686473, 0.09689417515833065, 1.0, -1.7432565732171366, 1.461945275091956, -0.5794560376773652, 0.09315248790044636, 1.0, -1.7085098915528558, 1.4228355423398278, -0.5592861777756872, 0.08948966369483682, 1.0, -1.6732403860903835, 1.3839917651520763, -0.5393740172144875, 0.08590672702638763, 1.0, -1.6374403131471988, 1.3454407411331915, -0.5197253821096375, 0.08240466526696283, 1.0, -1.6011017947354655, 1.3072102612688885, -0.5003457646194036, 0.07898442926443726, 1.0, -1.5642168141541326, 1.2693291444579358, -0.48124029135183755, 0.07564693421899937, 1.0, -1.5267772113421387, 1.231827273724142, -0.4624136899030905, 0.07239306087481351,
		1.0, -1.4887746779805833, 1.1947356342267312, -0.4438702533992105, 0.06922365705766367, 1.0, -1.4502007523314282, 1.1580863531965961, -0.42561380290240686, 0.06613953959201893, 1.0, -1.4110468137999272, 1.1219127419358474, -0.407647647529969, 0.06314149663409782, 1.0, -1.3713040772076217, 1.0862493400287225, -0.38997454211987903, 0.06023029046099582, 1.0, -1.3309635867624285, 1.051131961923431, -0.37259664226156114, 0.05740666075983848, 1.0, -1.2900162097120869, 1.016597746056918, -0.35551545649299154, 0.054671328465278904, 1.0, -1.2484526296669705, 0.9826852067078613, -0.33873179544633764, 0.05202500019852574, 1.0, -1.2062633395780589, 0.949434288777582, -0.3222457177032545, 0.04946837336654602,
		1.0, -1.163438634355704, 0.9168864257140241, -0.3060564720976825, 0.047002141986203935, 1.0, -1.1199686031147504, 0.8850846008106485, -0.2901624361782518, 0.044627003304969, 1.0, -1.0758431210315544, 0.8540734121300568, -0.27456105051390384, 0.04234366529755034, 1.0, -1.0310518407984843, 0.823899141321494, -0.2592487484947696, 0.040152855126502185, 1.0, -0.9855841836616637, 0.794609826622249, -0.24422088124539829, 0.038055328664638864, 1.0, -0.9394293300279863, 0.7662553403554431, -0.22947163722867306, 0.03605188118813826, 1.0, -0.8925762096279031, 0.7388874712609435, -0.21499395607579497, 0.034143359361681835, 1.0, -0.8450134912209584, 0.7125600120221866, -0.2007794361300063, 0.032330674651065254,
		1.0, -0.796729571831889, 0.6873288523798724, -0.18681823513879864, 0.030614818314658183, 1.0, -0.7477125655059929, 0.663252078253761, -0.17309896347051712, 0.02899687814314432, 1.0, -0.6979502915737772, 0.6403900773265194, -0.15960856916590382, 0.027478057137448875, 1.0, -0.6474302624162454, 0.6188056515786919, -0.14633221406234684, 0.026059694337992517, 1.0, -0.5961396707240747, 0.5985641373018178, -0.13325314014764528, 0.02474328804481935, 1.0, -0.5440653762461058, 0.5797335331575597, -0.12035252520989671, 0.023530521698185022, 1.0, -0.4911938920250968, 0.5623846368946354, -0.10760932674952949, 0.022423292723398856, 1.0, -0.4375113701217962, 0.5465911913826839, -0.09500011300732215, 0.021423744682723248,
		1.0, -0.38300358683201585, 0.532430040673112, -0.08249887983699303, 0.02053430312166303, 1.0, -0.3276559274056509, 0.5199812968516877, -0.0700768520109822, 0.019757715547872284, 1.0, -0.27145337028151256, 0.509328518506461, -0.05770226739152977, 0.019097096039149004, 1.0, -0.21438047085773831, 0.5005589016977423, -0.04534014222401507, 0.018555975043725043, 1.0, -0.15642134482410128, 0.4937634843845414, -0.03295201561329325, 0.018138355012624088, 1.0, -0.09755965109059717, 0.48903736533445646, -0.02049567102388846, 0.017848772591827714, 1.0, -0.037778574355521136, 0.4864799386215255, -0.007924832398104462, 0.017692368203181635, 1.0, 0.02293919263337149, 0.48619514489940796, 0.004811167790973168, 0.01767496395955588,
		1.0, 0.08461146705883697, 0.4882917407255497, 0.017767751545976856, 0.01780315099427085, 1.0, 0.14725659417593945, 0.49288358730579607, 0.031005492755989707, 0.018084387440197944, 1.0, 0.21089346552048047, 0.5000899601284037, 0.044590552750582026, 0.018527108473763817, 1.0, 0.27554153707078305, 0.510035881061474, 0.05859515818057676, 0.019140850047489007, 1.0, 0.3412208472291483, 0.5228524745984051, 0.07309812591014975, 0.019936388176607964, 1.0, 0.40795203446540795, 0.5386773500516684, 0.0881854401704221, 0.020925895926593358, 1.0, 0.4757563544387542, 0.5576550116157363, 0.1039508878637915, 0.02212312057600988, 1.0, 0.5446556963831677, 0.5799372983443714, 0.12049675863056901, 0.02354358381132509,
		1.0, 0.6146725985076807, 0.6056838562149367, 0.13793461710699179, 0.025204808257018665, 1.0, 0.6858302621236403, 0.6350626445813043, 0.15638615572930337, 0.02712657416738615, 1.0, 0.7581525641672499, 0.6682504794454553, 0.17598413748758301, 0.029331210720028675, 1.0, 0.8316640677364542, 0.7054336161035648, 0.1968734392226749, 0.03184392707222348, 1.0, 0.9063900302056935, 0.7468083738416873, 0.21921220740953468, 0.03469318919071325, 1.0, 0.9823564084204925, 0.7925818054652821, 0.24317313990339456, 0.03791114946776942, 1.0, 1.0595898604052492, 0.8429724145401363, 0.2689449088669856, 0.04153413732168243, 1.0, 1.1381177429413958, 0.898210923292898, 0.2967337420770179, 0.04560322038453097,
		1.0, 1.217968104289994, 0.9585410941595127, 0.3267651820600085, 0.050164847548522205, 1.0, 1.2991696712415584, 1.024220607968207, 0.35928604506910455, 0.05527158712836787, 1.0, 1.3817518295775009, 1.0955220016878213, 0.39456660482826833, 0.060982975767171266, 1.0, 1.4657445969225145, 1.1727336685463028, 0.4329030292869017, 0.06736649654817951, 1.0, 1.5511785868559755, 1.256160923108039, 0.47462010240147334, 0.07449870817410482, 1.0, 1.6380849630361065, 1.3461271335698022, 0.5200742672531024, 0.08246655116253353, 1.0, 1.7264953819752145, 1.4429749230642228, 0.5696570316896499, 0.09136886193226, 1.0, 1.8164419229920234, 1.5470674411126175, 0.6237987832233225, 0.10131813160996475,
		1.0, 1.9079570037651208, 1.6587897055062075, 0.6829730662032638, 0.11244255360471406, 1.0, 2.001073279826965, 1.7785500137673609, 0.7477013814052023, 0.12488841277299328, 1.0, 2.0958235262833185, 1.9067814218959993, 0.8185585762307281, 0.13882287969798413, 1.0, 2.1922405000328844, 2.043943286276103, 0.8961789027814282, 0.15443728669729334, 1.0, 2.290356780817601, 2.1905228623328172, 0.9812628312601526, 0.17195097823957373, 1.0, 2.390204589581369, 2.3470369507127358, 1.0745847175335603, 0.19161584823598077, 1.0, 2.4918155828875257, 2.514033578324703, 1.1770014363246208, 0.2137217011243847, 1.0, 2.59522062258741, 2.6920936974447485, 1.2894621054100297, 0.23860260399494798,
		1.0, 2.7004495205956065, 2.881832881179444, 1.4130190413254868, 0.2666444347725086, 1.0, 2.8075307595773795, 3.0839029878440636, 1.5488401032768078, 0.2982938786855207, 1.0, 2.9164911916668195, 3.2989937602341763, 1.698222598897543, 0.3340691845226879, 1.0, 3.0273557190946723, 3.5278343184104317, 1.8626089426111052, 0.37457306690911674, 1.0, 3.1401469629045375, 3.7711944966625577, 2.043604273698289, 0.42050823548406263, 1.0, 3.2548849288561117, 4.02988596714369, 2.2429962552164433, 0.4726961523085512,
};
//245 * 5 entries For 4th order filters.
const float b_table[] = {
		8.984861463970648e-07, 3.593944585588259e-06, 5.390916878382389e-06, 3.593944585588259e-06, 8.984861463970648e-07, 9.5506267805516e-07, 3.82025071222064e-06, 5.73037606833096e-06, 3.82025071222064e-06, 9.5506267805516e-07, 1.0151825207955492e-06, 4.060730083182197e-06, 6.091095124773295e-06, 4.060730083182197e-06, 1.0151825207955492e-06, 1.0790660707672021e-06, 4.3162642830688085e-06, 6.474396424603213e-06, 4.3162642830688085e-06, 1.0790660707672021e-06, 1.146947313938784e-06, 4.587789255755136e-06, 6.881683883632704e-06, 4.587789255755136e-06, 1.146947313938784e-06, 1.219074654781361e-06, 4.876298619125444e-06, 7.314447928688166e-06, 4.876298619125444e-06, 1.219074654781361e-06, 1.2957117947638695e-06, 5.182847179055478e-06, 7.774270768583218e-06, 5.182847179055478e-06, 1.2957117947638695e-06, 1.377138663600573e-06, 5.508554654402292e-06, 8.262831981603438e-06, 5.508554654402292e-06, 1.377138663600573e-06,
		1.4636524063586083e-06, 5.854609625434433e-06, 8.781914438151651e-06, 5.854609625434433e-06, 1.4636524063586083e-06, 1.5555684297126502e-06, 6.222273718850601e-06, 9.333410578275902e-06, 6.222273718850601e-06, 1.5555684297126502e-06, 1.6532215108219885e-06, 6.612886043287954e-06, 9.91932906493193e-06, 6.612886043287954e-06, 1.6532215108219885e-06, 1.7569669725046012e-06, 7.027867890018405e-06, 1.0541801835027608e-05, 7.027867890018405e-06, 1.7569669725046012e-06, 1.867181928592537e-06, 7.468727714370148e-06, 1.1203091571555222e-05, 7.468727714370148e-06, 1.867181928592537e-06, 1.984266603574789e-06, 7.937066414299155e-06, 1.1905599621448733e-05, 7.937066414299155e-06, 1.984266603574789e-06, 2.108645730867325e-06, 8.4345829234693e-06, 1.2651874385203949e-05, 8.4345829234693e-06, 2.108645730867325e-06, 2.2407700342969098e-06, 8.963080137187639e-06, 1.3444620205781459e-05, 8.963080137187639e-06, 2.2407700342969098e-06,
		2.381117797645041e-06, 9.524471190580164e-06, 1.4286706785870246e-05, 9.524471190580164e-06, 2.381117797645041e-06, 2.530196527373134e-06, 1.0120786109492535e-05, 1.5181179164238803e-05, 1.0120786109492535e-05, 2.530196527373134e-06, 2.6885447139387383e-06, 1.0754178855754953e-05, 1.613126828363243e-05, 1.0754178855754953e-05, 2.6885447139387383e-06, 2.856733697418188e-06, 1.1426934789672752e-05, 1.7140402184509127e-05, 1.1426934789672752e-05, 2.856733697418188e-06, 3.0353696434718336e-06, 1.2141478573887335e-05, 1.8212217860831e-05, 1.2141478573887335e-05, 3.0353696434718336e-06, 3.22509563602747e-06, 1.290038254410988e-05, 1.935057381616482e-05, 1.290038254410988e-05, 3.22509563602747e-06, 3.4265938934141874e-06, 1.370637557365675e-05, 2.0559563360485124e-05, 1.370637557365675e-05, 3.4265938934141874e-06, 3.640588115055075e-06, 1.45623524602203e-05, 2.184352869033045e-05, 1.45623524602203e-05, 3.640588115055075e-06,
		3.867845966224007e-06, 1.5471383864896028e-05, 2.320707579734404e-05, 1.5471383864896028e-05, 3.867845966224007e-06, 4.1091817087884705e-06, 1.6436726835153882e-05, 2.4655090252730823e-05, 1.6436726835153882e-05, 4.1091817087884705e-06, 4.365458986300916e-06, 1.7461835945203665e-05, 2.6192753917805497e-05, 1.7461835945203665e-05, 4.365458986300916e-06, 4.637593772263207e-06, 1.855037508905283e-05, 2.7825562633579245e-05, 1.855037508905283e-05, 4.637593772263207e-06, 4.926557490877128e-06, 1.9706229963508513e-05, 2.955934494526277e-05, 1.9706229963508513e-05, 4.926557490877128e-06, 5.233380320106085e-06, 2.093352128042434e-05, 3.140028192063651e-05, 2.093352128042434e-05, 5.233380320106085e-06, 5.559154687414121e-06, 2.2236618749656484e-05, 3.3354928124484724e-05, 2.2236618749656484e-05, 5.559154687414121e-06, 5.90503896911575e-06, 2.3620155876463e-05, 3.54302338146945e-05, 2.3620155876463e-05, 5.90503896911575e-06,
		6.272261404869014e-06, 2.5089045619476055e-05, 3.763356842921408e-05, 2.5089045619476055e-05, 6.272261404869014e-06, 6.662124239472186e-06, 2.6648496957888743e-05, 3.997274543683311e-05, 2.6648496957888743e-05, 6.662124239472186e-06, 7.076008104787208e-06, 2.8304032419148833e-05, 4.245604862872325e-05, 2.8304032419148833e-05, 7.076008104787208e-06, 7.515376655307347e-06, 3.006150662122939e-05, 4.509225993184408e-05, 3.006150662122939e-05, 7.515376655307347e-06, 7.981781471619604e-06, 3.1927125886478414e-05, 4.789068882971762e-05, 3.1927125886478414e-05, 7.981781471619604e-06, 8.47686724677955e-06, 3.39074689871182e-05, 5.086120348067731e-05, 3.39074689871182e-05, 8.47686724677955e-06, 9.002377271426332e-06, 3.600950908570533e-05, 5.401426362855799e-05, 3.600950908570533e-05, 9.002377271426332e-06, 9.560159234312747e-06, 3.824063693725099e-05, 5.736095540587648e-05, 3.824063693725099e-05, 9.560159234312747e-06,
		1.01521713558195e-05, 4.0608685423278e-05, 6.0913028134916994e-05, 4.0608685423278e-05, 1.01521713558195e-05, 1.0780488872958608e-05, 4.312195549183443e-05, 6.468293323775165e-05, 4.312195549183443e-05, 1.0780488872958608e-05, 1.1447310895355186e-05, 4.5789243581420745e-05, 6.868386537213112e-05, 4.5789243581420745e-05, 1.1447310895355186e-05, 1.2154967652731845e-05, 4.861987061092738e-05, 7.292980591639107e-05, 4.861987061092738e-05, 1.2154967652731845e-05, 1.2905928155502352e-05, 5.162371262200941e-05, 7.743556893301411e-05, 5.162371262200941e-05, 1.2905928155502352e-05, 1.3702808291222862e-05, 5.481123316489145e-05, 8.221684974733717e-05, 5.481123316489145e-05, 1.3702808291222862e-05, 1.4548379380841235e-05, 5.819351752336494e-05, 8.729027628504741e-05, 5.819351752336494e-05, 1.4548379380841235e-05, 1.5445577219941605e-05, 6.178230887976642e-05, 9.267346331964964e-05, 6.178230887976642e-05, 1.5445577219941605e-05,
		1.6397511631493268e-05, 6.559004652597307e-05, 9.83850697889596e-05, 6.559004652597307e-05, 1.6397511631493268e-05, 1.7407476557996103e-05, 6.962990623198441e-05, 0.00010444485934797663, 6.962990623198441e-05, 1.7407476557996103e-05, 1.8478960722356397e-05, 7.391584288942559e-05, 0.00011087376433413837, 7.391584288942559e-05, 1.8478960722356397e-05, 1.9615658888348136e-05, 7.846263555339254e-05, 0.00011769395333008882, 7.846263555339254e-05, 1.9615658888348136e-05, 2.082148375309804e-05, 8.328593501239216e-05, 0.00012492890251858825, 8.328593501239216e-05, 2.082148375309804e-05, 2.2100578505703562e-05, 8.840231402281425e-05, 0.00013260347103422136, 8.840231402281425e-05, 2.2100578505703562e-05, 2.345733008783148e-05, 9.382932035132592e-05, 0.0001407439805269889, 9.382932035132592e-05, 2.345733008783148e-05, 2.4896383193976147e-05, 9.958553277590459e-05, 0.0001493782991638569, 9.958553277590459e-05, 2.4896383193976147e-05,
		2.6422655050967576e-05, 0.0001056906202038703, 0.00015853593030580544, 0.0001056906202038703, 2.6422655050967576e-05, 2.8041351018321212e-05, 0.00011216540407328485, 0.0001682481061099273, 0.00011216540407328485, 2.8041351018321212e-05, 2.9757981053119652e-05, 0.00011903192421247861, 0.00017854788631871792, 0.00011903192421247861, 2.9757981053119652e-05, 3.157837708530958e-05, 0.00012631350834123832, 0.00018947026251185748, 0.00012631350834123832, 3.157837708530958e-05, 3.35087113515917e-05, 0.0001340348454063668, 0.0002010522681095502, 0.0001340348454063668, 3.35087113515917e-05, 3.5555515738480725e-05, 0.0001422220629539229, 0.00021333309443088435, 0.0001422220629539229, 3.5555515738480725e-05, 3.7725702187627883e-05, 0.00015090280875051153, 0.00022635421312576731, 0.00015090280875051153, 3.7725702187627883e-05, 4.002658421911474e-05, 0.00016010633687645897, 0.00024015950531468846, 0.00016010633687645897, 4.002658421911474e-05,
		4.246589963117962e-05, 0.00016986359852471847, 0.00025479539778707773, 0.00016986359852471847, 4.246589963117962e-05, 4.505183443769568e-05, 0.0001802073377507827, 0.0002703110066261741, 0.0001802073377507827, 4.505183443769568e-05, 4.7793048107723806e-05, 0.00019117219243089523, 0.00028675828864634285, 0.00019117219243089523, 4.7793048107723806e-05, 5.069870017458174e-05, 0.00020279480069832696, 0.00030419220104749045, 0.00020279480069832696, 5.069870017458174e-05, 5.3778478285149535e-05, 0.00021511391314059814, 0.0003226708697108972, 0.00021511391314059814, 5.3778478285149535e-05, 5.704262776352953e-05, 0.0002281705110541181, 0.0003422557665811772, 0.0002281705110541181, 5.704262776352953e-05, 6.0501982766751695e-05, 0.00024200793106700678, 0.0003630118966005102, 0.00024200793106700678, 6.0501982766751695e-05, 6.416799911391847e-05, 0.00025667199645567387, 0.00038500799468351083, 0.00025667199645567387, 6.416799911391847e-05,
		6.805278887407138e-05, 0.0002722111554962855, 0.00040831673324442827, 0.0002722111554962855, 6.805278887407138e-05, 7.216915680209178e-05, 0.00028867662720836714, 0.0004330149408125507, 0.00028867662720836714, 7.216915680209178e-05, 7.653063871617729e-05, 0.00030612255486470917, 0.0004591838322970638, 0.00030612255486470917, 7.653063871617729e-05, 8.115154191482196e-05, 0.00032460616765928784, 0.0004869092514889318, 0.00032460616765928784, 8.115154191482196e-05, 8.60469877358128e-05, 0.0003441879509432512, 0.0005162819264148768, 0.0003441879509432512, 8.60469877358128e-05, 9.123295636453284e-05, 0.00036493182545813135, 0.0005473977381871971, 0.00036493182545813135, 9.123295636453284e-05, 9.67263340038343e-05, 0.0003869053360153372, 0.0005803580040230058, 0.0003869053360153372, 9.67263340038343e-05, 0.00010254496252292855, 0.0004101798500917142, 0.0006152697751375713, 0.0004101798500917142, 0.00010254496252292855,
		0.00010870769170813402, 0.0004348307668325361, 0.0006522461502488042, 0.0004348307668325361, 0.00010870769170813402, 0.00011523443424395277, 0.0004609377369758111, 0.0006914066054637166, 0.0004609377369758111, 0.00011523443424395277, 0.0001221462235587831, 0.0004885848942351324, 0.0007328773413526985, 0.0004885848942351324, 0.0001221462235587831, 0.00012946527467568424, 0.000517861098702737, 0.0007767916480541054, 0.000517861098702737, 0.00012946527467568424, 0.00013721504821492445, 0.0005488601928596978, 0.0008232902892895467, 0.0005488601928596978, 0.00013721504821492445, 0.0001454203177016652, 0.0005816812708066607, 0.0008725219062099912, 0.0005816812708066607, 0.0001454203177016652, 0.00015410724033896299, 0.0006164289613558519, 0.0009246434420337779, 0.0006164289613558519, 0.00015410724033896299, 0.0001633034314134412, 0.0006532137256537648, 0.0009798205884806472, 0.0006532137256537648, 0.0001633034314134412,
		0.00017303804250836657, 0.0006921521700334663, 0.0010382282550501995, 0.0006921521700334663, 0.00017303804250836657, 0.00018334184370661695, 0.0007333673748264678, 0.0011000510622397016, 0.0007333673748264678, 0.00018334184370661695, 0.00019424730997402826, 0.000776989239896113, 0.0011654838598441695, 0.000776989239896113, 0.00019424730997402826, 0.00020578871192195, 0.0008231548476878, 0.0012347322715317, 0.0008231548476878, 0.00020578871192195, 0.00021800221115651493, 0.0008720088446260597, 0.0013080132669390896, 0.0008720088446260597, 0.00021800221115651493, 0.00023092596043114086, 0.0009237038417245634, 0.0013855557625868451, 0.0009237038417245634, 0.00023092596043114086, 0.0002446002088281409, 0.0009784008353125636, 0.0014676012529688453, 0.0009784008353125636, 0.0002446002088281409, 0.00025906741220504655, 0.0010362696488201862, 0.0015544044732302793, 0.0010362696488201862, 0.00025906741220504655,
		0.000274372349151377, 0.001097489396605508, 0.0016462340949082621, 0.001097489396605508, 0.000274372349151377, 0.0002905622427120905, 0.001162248970848362, 0.001743373456272543, 0.001162248970848362, 0.0002905622427120905, 0.000307686888144878, 0.001230747552579512, 0.001846121328869268, 0.001230747552579512, 0.000307686888144878, 0.00032579878698979356, 0.0013031951479591743, 0.0019547927219387613, 0.0013031951479591743, 0.00032579878698979356, 0.0003449532877415602, 0.0013798131509662407, 0.002069719726449361, 0.0013798131509662407, 0.0003449532877415602, 0.0003652087334270806, 0.0014608349337083223, 0.0021912524005624837, 0.0014608349337083223, 0.0003652087334270806, 0.00038662661640350977, 0.001546506465614039, 0.0023197596984210586, 0.001546506465614039, 0.00038662661640350977, 0.00040927174070540874, 0.001637086962821635, 0.0024556304442324524, 0.001637086962821635, 0.00040927174070540874,
		0.00043321239228336485, 0.0017328495691334594, 0.0025992743537001893, 0.0017328495691334594, 0.00043321239228336485, 0.00045852051749070623, 0.001834082069962825, 0.0027511231049442376, 0.001834082069962825, 0.00045852051749070623, 0.0004852719101899177, 0.0019410876407596708, 0.0029116314611395064, 0.0019410876407596708, 0.0004852719101899177, 0.000513546407865803, 0.002054185631463212, 0.0030812784471948183, 0.002054185631463212, 0.000513546407865803, 0.0005434280971486327, 0.0021737123885945306, 0.0032605685828917957, 0.0021737123885945306, 0.0005434280971486327, 0.0005750055291672863, 0.0023000221166691454, 0.003450033175003718, 0.0023000221166691454, 0.0005750055291672863, 0.0006083719451698894, 0.0024334877806795577, 0.0036502316710193368, 0.0024334877806795577, 0.0006083719451698894, 0.0006436255128676949, 0.0025745020514707797, 0.0038617530772061693, 0.0025745020514707797, 0.0006436255128676949,
		0.0006808695739769544, 0.0027234782959078174, 0.004085217443861726, 0.0027234782959078174, 0.0006808695739769544, 0.0007202129034533445, 0.002880851613813378, 0.0043212774207200665, 0.002880851613813378, 0.0007202129034533445, 0.0007617699809341377, 0.0030470799237365506, 0.004570619885604826, 0.0030470799237365506, 0.0007617699809341377, 0.0008056612749249683, 0.003222645099699873, 0.0048339676495498096, 0.003222645099699873, 0.0008056612749249683, 0.0008520135402905249, 0.0034080541611620995, 0.005112081241743149, 0.0034080541611620995, 0.0008520135402905249, 0.0009009601296320979, 0.0036038405185283917, 0.005405760777792588, 0.0036038405185283917, 0.0009009601296320979, 0.0009526413191594782, 0.003810565276637913, 0.005715847914956869, 0.003810565276637913, 0.0009526413191594782, 0.0010072046496906377, 0.004028818598762551, 0.006043227898143827, 0.004028818598762551, 0.0010072046496906377,
		0.0010648052834394469, 0.0042592211337577875, 0.006388831700636682, 0.0042592211337577875, 0.0010648052834394469, 0.0011256063772801912, 0.004502425509120765, 0.006753638263681147, 0.004502425509120765, 0.0011256063772801912, 0.00118977947320716, 0.00475911789282864, 0.00713867683924296, 0.00475911789282864, 0.00118977947320716, 0.0012575049067389836, 0.005030019626955934, 0.007545029440433901, 0.005030019626955934, 0.0012575049067389836, 0.001328972234049909, 0.005315888936199636, 0.007973833404299455, 0.005315888936199636, 0.001328972234049909, 0.001404380678645002, 0.005617522714580008, 0.008426284071870013, 0.005617522714580008, 0.001404380678645002, 0.001483939598432193, 0.005935758393728772, 0.008903637590593158, 0.005935758393728772, 0.001483939598432193, 0.0015678689740826672, 0.006271475896330669, 0.009407213844496004, 0.006271475896330669, 0.0015678689740826672,
		0.0016563999196112383, 0.006625599678444953, 0.00993839951766743, 0.006625599678444953, 0.0016563999196112383, 0.0017497752161509989, 0.0069991008646039955, 0.010498651296905994, 0.0069991008646039955, 0.0017497752161509989, 0.0018482498699415862, 0.007392999479766345, 0.011089499219649517, 0.007392999479766345, 0.0018482498699415862, 0.0019520916955980566, 0.007808366782392226, 0.01171255017358834, 0.007808366782392226, 0.0019520916955980566, 0.0020615819257778266, 0.008246327703111307, 0.01236949155466696, 0.008246327703111307, 0.0020615819257778266, 0.002177015848416503, 0.008708063393666012, 0.013062095090499017, 0.008708063393666012, 0.002177015848416503, 0.0022987034727604003, 0.009194813891041601, 0.013792220836562402, 0.009194813891041601, 0.0022987034727604003, 0.00242697022548377, 0.00970788090193508, 0.014561821352902621, 0.00970788090193508, 0.00242697022548377,
		0.0025621576782428905, 0.010248630712971562, 0.015372946069457343, 0.010248630712971562, 0.0025621576782428905, 0.00270462430808738, 0.01081849723234952, 0.01622774584852428, 0.01081849723234952, 0.00270462430808738, 0.002854746292222177, 0.011418985168888708, 0.017128477753333062, 0.011418985168888708, 0.002854746292222177, 0.003012918338690684, 0.012051673354762735, 0.018077510032144105, 0.012051673354762735, 0.003012918338690684, 0.0031795545546331808, 0.012718218218532723, 0.019077327327799085, 0.012718218218532723, 0.0031795545546331808, 0.003355089353862279, 0.013420357415449115, 0.020130536123173674, 0.013420357415449115, 0.003355089353862279, 0.0035399784055928324, 0.01415991362237133, 0.021239870433556993, 0.01415991362237133, 0.0035399784055928324, 0.0037346996262642537, 0.014938798505057015, 0.022408197757585523, 0.014938798505057015, 0.0037346996262642537,
		0.003939754216502646, 0.015759016866010583, 0.023638525299015875, 0.015759016866010583, 0.003939754216502646, 0.004155667745385873, 0.01662267098154349, 0.024934006472315237, 0.01662267098154349, 0.004155667745385873, 0.004382991284300556, 0.017531965137202225, 0.026297947705803338, 0.017531965137202225, 0.004382991284300556, 0.004622302592813732, 0.01848921037125493, 0.027733815556882393, 0.01848921037125493, 0.004622302592813732, 0.004874207359126493, 0.01949682943650597, 0.029245244154758956, 0.01949682943650597, 0.004874207359126493, 0.005139340497832388, 0.020557361991329553, 0.030836042986994328, 0.020557361991329553, 0.005139340497832388, 0.005418367507870484, 0.021673470031481935, 0.032510205047222906, 0.021673470031481935, 0.005418367507870484, 0.005711985893743163, 0.022847943574972652, 0.03427191536245898, 0.022847943574972652, 0.005711985893743163,
		0.006020926653262784, 0.024083706613051137, 0.03612555991957671, 0.024083706613051137, 0.006020926653262784, 0.006345955835300902, 0.025383823341203607, 0.03807573501180541, 0.025383823341203607, 0.006345955835300902, 0.006687876171239961, 0.026751504684959845, 0.040127257027439765, 0.026751504684959845, 0.006687876171239961, 0.007047528784071131, 0.028190115136284524, 0.042285172704426784, 0.028190115136284524, 0.007047528784071131, 0.007425794979345794, 0.029703179917383176, 0.04455476987607476, 0.029703179917383176, 0.007425794979345794, 0.007823598122473385, 0.03129439248989354, 0.046941588734840306, 0.03129439248989354, 0.007823598122473385, 0.008241905607167326, 0.0329676224286693, 0.04945143364300396, 0.0329676224286693, 0.008241905607167326, 0.008681730920172999, 0.034726923680691996, 0.05209038552103799, 0.034726923680691996, 0.008681730920172999,
		0.009144135807774794, 0.03657654323109918, 0.05486481484664876, 0.03657654323109918, 0.009144135807774794, 0.009630232549969942, 0.03852093019987977, 0.057781395299819654, 0.03852093019987977, 0.009630232549969942, 0.010141186348621213, 0.040564745394484854, 0.060847118091727284, 0.040564745394484854, 0.010141186348621213, 0.010678217836360505, 0.04271287134544202, 0.06406930701816303, 0.04271287134544202, 0.010678217836360505, 0.011242605713514814, 0.04497042285405926, 0.06745563428108889, 0.04497042285405926, 0.011242605713514814, 0.011835689520867443, 0.04734275808346977, 0.07101413712520466, 0.04734275808346977, 0.011835689520867443, 0.012458872556655622, 0.04983549022662249, 0.07475323533993374, 0.04983549022662249, 0.012458872556655622, 0.013113624946843974, 0.052454499787375895, 0.07868174968106384, 0.052454499787375895, 0.013113624946843974,
		0.013801486878408294, 0.055205947513633176, 0.08280892127044977, 0.055205947513633176, 0.013801486878408294, 0.014524072006118776, 0.058096288024475105, 0.08714443203671265, 0.058096288024475105, 0.014524072006118776, 0.01528307104413262, 0.06113228417653048, 0.09169842626479571, 0.06113228417653048, 0.01528307104413262, 0.016080255554599555, 0.06432102221839822, 0.09648153332759733, 0.06432102221839822, 0.016080255554599555, 0.016917481946457372, 0.06766992778582949, 0.10150489167874424, 0.06766992778582949, 0.016917481946457372, 0.017796695698653543, 0.07118678279461417, 0.10678017419192126, 0.07118678279461417, 0.017796695698653543, 0.018719935823185308, 0.07487974329274123, 0.11231961493911186, 0.07487974329274123, 0.018719935823185308, 0.019689339584607883, 0.07875735833843153, 0.1181360375076473, 0.07875735833843153, 0.019689339584607883,
		0.020707147494037577, 0.08282858997615031, 0.12424288496422546, 0.08282858997615031, 0.020707147494037577, 0.02177570859717376, 0.08710283438869504, 0.13065425158304256, 0.08710283438869504, 0.02177570859717376, 0.02289748607750306, 0.09158994431001224, 0.13738491646501838, 0.09158994431001224, 0.02289748607750306, 0.024075063197638597, 0.09630025279055439, 0.1444503791858316, 0.09630025279055439, 0.024075063197638597, 0.025311149603705, 0.10124459841482, 0.15186689762223, 0.10124459841482, 0.025311149603705, 0.026608588019819898, 0.10643435207927959, 0.1596515281189194, 0.10643435207927959, 0.026608588019819898, 0.027970361362067455, 0.11188144544826982, 0.16782216817240472, 0.11188144544826982, 0.027970361362067455, 0.029399600303925938, 0.11759840121570375, 0.17639760182355563, 0.11759840121570375, 0.029399600303925938,
		0.030899591327927613, 0.12359836531171045, 0.1853975479675657, 0.12359836531171045, 0.030899591327927613, 0.032473785301413455, 0.12989514120565382, 0.19484271180848073, 0.12989514120565382, 0.032473785301413455, 0.03412580661763431, 0.13650322647053725, 0.20475483970580588, 0.13650322647053725, 0.03412580661763431, 0.035859462947171405, 0.14343785178868562, 0.21515677768302843, 0.14343785178868562, 0.035859462947171405, 0.03767875564873912, 0.15071502259495648, 0.2260725338924347, 0.15071502259495648, 0.03767875564873912, 0.03958789089293264, 0.15835156357173055, 0.23752734535759584, 0.15835156357173055, 0.03958789089293264, 0.04159129155743296, 0.16636516622973185, 0.24954774934459778, 0.16636516622973185, 0.04159129155743296, 0.04369360995764295, 0.1747744398305718, 0.2621616597458577, 0.1747744398305718, 0.04369360995764295,
		0.04589974148274018, 0.18359896593096073, 0.2753984488964411, 0.18359896593096073, 0.04589974148274018, 0.04821483921377471, 0.19285935685509883, 0.28928903528264827, 0.19285935685509883, 0.04821483921377471, 0.050644329607767956, 0.20257731843107182, 0.3038659776466077, 0.20257731843107182, 0.050644329607767956, 0.053193929339880756, 0.21277571735952303, 0.3191635760392845, 0.21277571735952303, 0.053193929339880756, 0.05586966340468232, 0.2234786536187293, 0.3352179804280939, 0.2234786536187293, 0.05586966340468232, 0.0586778845874839, 0.2347115383499356, 0.3520673075249034, 0.2347115383499356, 0.0586778845874839, 0.061625294427713, 0.246501177710852, 0.369751766566278, 0.246501177710852, 0.061625294427713, 0.06471896580851806, 0.25887586323407225, 0.3883137948511084, 0.25887586323407225, 0.06471896580851806,
		0.06796636732036036, 0.27186546928144145, 0.40779820392216215, 0.27186546928144145, 0.06796636732036036, 0.07137538956143294, 0.28550155824573176, 0.42825233736859764, 0.28550155824573176, 0.07137538956143294, 0.07495437355453546, 0.29981749421814186, 0.4497262413272128, 0.29981749421814186, 0.07495437355453546, 0.07871214147873212, 0.3148485659149285, 0.47227284887239274, 0.3148485659149285, 0.07871214147873212, 0.08265802993498571, 0.33063211973994283, 0.4959481796099142, 0.33063211973994283, 0.08265802993498571, 0.08680192598823742, 0.3472077039529497, 0.5208115559294245, 0.3472077039529497, 0.08680192598823742, 0.09115430625444261, 0.36461722501777044, 0.5469258375266557, 0.36461722501777044, 0.09115430625444261, 0.09572627933020679, 0.38290511732082716, 0.5743576759812408, 0.38290511732082716, 0.09572627933020679,
		0.10052963189528966, 0.4021185275811586, 0.603177791371738, 0.4021185275811586, 0.10052963189528966, 0.10557687885487019, 0.42230751541948075, 0.6334612731292211, 0.42230751541948075, 0.10557687885487019, 0.11088131792957687, 0.44352527171830747, 0.6652879075774611, 0.44352527171830747, 0.11088131792957687, 0.11645708914752012, 0.4658283565900805, 0.6987425348851207, 0.4658283565900805, 0.11645708914752012, 0.12231923974464437, 0.4892769589785775, 0.7339154384678662, 0.4892769589785775, 0.12231923974464437, 0.12848379503838073, 0.5139351801535229, 0.7709027702302844, 0.5139351801535229, 0.12848379503838073, 0.13496783590589326, 0.539871343623573, 0.8098070154353596, 0.539871343623573, 0.13496783590589326, 0.1417895835730896, 0.5671583342923584, 0.8507375014385377, 0.5671583342923584, 0.1417895835730896,
		0.14896849250541422, 0.5958739700216569, 0.8938109550324853, 0.5958739700216569, 0.14896849250541422, 0.15652535228760217, 0.6261014091504087, 0.939152113725613, 0.6261014091504087, 0.15652535228760217, 0.16448239948876986, 0.6579295979550794, 0.9868943969326192, 0.6579295979550794, 0.16448239948876986, 0.17286344063343237, 0.6914537625337295, 1.0371806438005942, 0.6914537625337295, 0.17286344063343237, 0.18169398754047683, 0.7267759501619073, 1.090163925242861, 0.7267759501619073, 0.18169398754047683, 0.19100140645355868, 0.7640056258142347, 1.146008438721352, 0.7640056258142347, 0.19100140645355868, 0.20081508257087832, 0.8032603302835133, 1.20489049542527, 0.8032603302835133, 0.20081508257087832, 0.2111666017934902, 0.8446664071739608, 1.2669996107609411, 0.8446664071739608, 0.2111666017934902,
		0.2220899517536274, 0.8883598070145096, 1.3325397105217642, 0.8883598070145096, 0.2220899517536274, 0.23362174446295242, 0.9344869778518097, 1.4017304667777144, 0.9344869778518097, 0.23362174446295242, 0.2458014632412976, 0.9832058529651904, 1.4748087794477855, 0.9832058529651904, 0.2458014632412976, 0.25867173695649354, 1.0346869478259741, 1.5520304217389613, 1.0346869478259741, 0.25867173695649354, 0.2722786450337245, 1.089114580134898, 1.6336718702023472, 1.089114580134898, 0.2722786450337245, 0.2866720571888464, 1.1466882287553857, 1.7200323431330786, 1.1466882287553857, 0.2866720571888464, 0.3019060124163342, 1.2076240496653368, 1.8114360744980051, 1.2076240496653368, 0.3019060124163342, 0.3180391424336205, 1.272156569734482, 1.9082348546017232, 1.272156569734482, 0.3180391424336205,
		0.3351351455674565, 1.340540582269826, 2.010810873404739, 1.340540582269826, 0.3351351455674565, 0.3532633179857825, 1.41305327194313, 2.119579907914695, 1.41305327194313, 0.3532633179857825, 0.3724991502567518, 1.4899966010270072, 2.2349949015405106, 1.4899966010270072, 0.3724991502567518, 0.39292499848673185, 1.5716999939469274, 2.357549990920391, 1.5716999939469274, 0.39292499848673185, 0.414630840790634, 1.658523363162536, 2.487785044743804, 1.658523363162536, 0.414630840790634, 0.437715131628978, 1.750860526515912, 2.626290789773868, 1.750860526515912, 0.437715131628978, 0.4622857686663271, 1.8491430746653084, 2.7737146119979625, 1.8491430746653084, 0.4622857686663271, 0.48846118933982097, 1.9538447573592839, 2.930767136038926, 1.9538447573592839, 0.48846118933982097,
		0.5163716173670654, 2.0654864694682615, 3.0982297042023923, 2.0654864694682615, 0.5163716173670654, 0.5461604830864857, 2.1846419323459427, 3.276962898518914, 2.1846419323459427, 0.5461604830864857, 0.5779860459575765, 2.311944183830306, 3.467916275745459, 2.311944183830306, 0.5779860459575765, 0.6120232529390829, 2.4480930117563315, 3.6721395176344975, 2.4480930117563315, 0.6120232529390829, 0.6484658730468403, 2.5938634921873613, 3.890795238281042, 2.5938634921873613, 0.6484658730468403, 0.6875289564702999, 2.7501158258811995, 4.1251737388217995, 2.7501158258811995, 0.6875289564702999,
};

const float sine_table[] = { //4096 entries.
		0.0000000000e+00,1.5343547843e-03,3.0687059564e-03,4.6030499040e-03,6.1373830149e-03,7.6717016768e-03,9.2060022777e-03,1.0740281205e-02,1.2274534848e-02,1.3808759593e-02,1.5342951829e-02,1.6877107944e-02,1.8411224326e-02,1.9945297363e-02,2.1479323445e-02,2.3013298958e-02,2.4547220293e-02,2.6081083838e-02,2.7614885981e-02,2.9148623112e-02,3.0682291620e-02,3.2215887894e-02,3.3749408324e-02,3.5282849300e-02,3.6816207211e-02,3.8349478448e-02,3.9882659401e-02,4.1415746460e-02,4.2948736017e-02,4.4481624461e-02,4.6014408185e-02,4.7547083579e-02,4.9079647036e-02,5.0612094948e-02,5.2144423706e-02,5.3676629703e-02,5.5208709332e-02,5.6740658987e-02,5.8272475060e-02,5.9804153945e-02,6.1335692037e-02,6.2867085729e-02,6.4398331416e-02,6.5929425495e-02,6.7460364359e-02,6.8991144404e-02,7.0521762028e-02,7.2052213626e-02,7.3582495595e-02,7.5112604334e-02,7.6642536238e-02,7.8172287707e-02,7.9701855140e-02,8.1231234934e-02,8.2760423491e-02,8.4289417208e-02,8.5818212488e-02,8.7346805731e-02,8.8875193338e-02,9.0403371711e-02,9.1931337252e-02,9.3459086364e-02,9.4986615450e-02,9.6513920915e-02,9.8040999161e-02,9.9567846596e-02,1.0109445962e-01,1.0262083465e-01,1.0414696808e-01,1.0567285632e-01,1.0719849579e-01,1.0872388288e-01,1.1024901401e-01,1.1177388558e-01,1.1329849402e-01,1.1482283572e-01,1.1634690710e-01,1.1787070457e-01,1.1939422454e-01,1.2091746343e-01,1.2244041765e-01,1.2396308362e-01,1.2548545774e-01,1.2700753644e-01,1.2852931614e-01,1.3005079325e-01,1.3157196418e-01,1.3309282536e-01,1.3461337321e-01,1.3613360414e-01,1.3765351459e-01,1.3917310096e-01,1.4069235969e-01,1.4221128719e-01,1.4372987989e-01,1.4524813421e-01,1.4676604659e-01,1.4828361344e-01,1.4980083119e-01,1.5131769628e-01,1.5283420513e-01,1.5435035417e-01,1.5586613983e-01,1.5738155854e-01,1.5889660674e-01,1.6041128086e-01,1.6192557733e-01,1.6343949258e-01,1.6495302306e-01,1.6646616520e-01,1.6797891544e-01,1.6949127021e-01,1.7100322596e-01,1.7251477913e-01,1.7402592615e-01,1.7553666348e-01,1.7704698754e-01,1.7855689480e-01,1.8006638169e-01,1.8157544465e-01,1.8308408015e-01,1.8459228462e-01,1.8610005451e-01,1.8760738628e-01,1.8911427638e-01,1.9062072125e-01,1.9212671735e-01,1.9363226115e-01,1.9513734908e-01,1.9664197761e-01,1.9814614320e-01,1.9964984230e-01,2.0115307138e-01,2.0265582690e-01,2.0415810531e-01,2.0565990309e-01,2.0716121669e-01,2.0866204258e-01,2.1016237723e-01,2.1166221711e-01,2.1316155868e-01,2.1466039842e-01,2.1615873279e-01,2.1765655827e-01,2.1915387134e-01,2.2065066846e-01,2.2214694612e-01,2.2364270079e-01,2.2513792895e-01,2.2663262708e-01,2.2812679166e-01,2.2962041917e-01,2.3111350610e-01,2.3260604894e-01,2.3409804416e-01,2.3558948825e-01,2.3708037772e-01,2.3857070903e-01,2.4006047869e-01,2.4154968319e-01,2.4303831902e-01,2.4452638269e-01,2.4601387067e-01,2.4750077948e-01,2.4898710561e-01,2.5047284556e-01,2.5195799584e-01,2.5344255295e-01,2.5492651339e-01,2.5640987367e-01,2.5789263030e-01,2.5937477979e-01,2.6085631864e-01,2.6233724338e-01,2.6381755051e-01,2.6529723655e-01,2.6677629801e-01,2.6825473141e-01,2.6973253328e-01,2.7120970013e-01,2.7268622849e-01,2.7416211488e-01,2.7563735582e-01,2.7711194784e-01,2.7858588747e-01,2.8005917125e-01,2.8153179569e-01,2.8300375734e-01,2.8447505273e-01,2.8594567840e-01,2.8741563088e-01,2.8888490671e-01,2.9035350244e-01,2.9182141460e-01,2.9328863974e-01,2.9475517441e-01,2.9622101515e-01,2.9768615852e-01,2.9915060106e-01,3.0061433933e-01,3.0207736987e-01,3.0353968925e-01,3.0500129403e-01,3.0646218075e-01,3.0792234599e-01,3.0938178630e-01,3.1084049826e-01,3.1229847841e-01,3.1375572334e-01,3.1521222962e-01,3.1666799380e-01,3.1812301247e-01,3.1957728220e-01,3.2103079957e-01,3.2248356115e-01,3.2393556353e-01,3.2538680328e-01,3.2683727699e-01,3.2828698125e-01,3.2973591264e-01,3.3118406774e-01,3.3263144316e-01,3.3407803549e-01,3.3552384131e-01,3.3696885723e-01,3.3841307983e-01,3.3985650573e-01,3.4129913153e-01,3.4274095382e-01,3.4418196922e-01,3.4562217433e-01,3.4706156575e-01,3.4850014011e-01,3.4993789402e-01,3.5137482408e-01,3.5281092692e-01,3.5424619916e-01,3.5568063742e-01,3.5711423831e-01,3.5854699847e-01,3.5997891453e-01,3.6140998310e-01,3.6284020083e-01,3.6426956434e-01,3.6569807027e-01,3.6712571525e-01,3.6855249594e-01,3.6997840896e-01,3.7140345096e-01,3.7282761858e-01,3.7425090848e-01,3.7567331730e-01,3.7709484169e-01,3.7851547831e-01,3.7993522380e-01,3.8135407484e-01,3.8277202808e-01,3.8418908017e-01,3.8560522779e-01,3.8702046760e-01,3.8843479627e-01,3.8984821047e-01,3.9126070687e-01,3.9267228215e-01,3.9408293298e-01,3.9549265604e-01,3.9690144801e-01,3.9830930558e-01,3.9971622544e-01,4.0112220426e-01,4.0252723874e-01,4.0393132557e-01,4.0533446145e-01,4.0673664308e-01,4.0813786714e-01,4.0953813035e-01,4.1093742940e-01,4.1233576101e-01,4.1373312188e-01,4.1512950871e-01,4.1652491823e-01,4.1791934715e-01,4.1931279218e-01,4.2070525005e-01,4.2209671747e-01,4.2348719118e-01,4.2487666789e-01,4.2626514434e-01,4.2765261725e-01,4.2903908337e-01,4.3042453942e-01,4.3180898214e-01,4.3319240828e-01,4.3457481458e-01,4.3595619779e-01,4.3733655464e-01,4.3871588190e-01,4.4009417631e-01,4.4147143464e-01,4.4284765363e-01,4.4422283005e-01,4.4559696065e-01,4.4697004222e-01,4.4834207150e-01,4.4971304528e-01,4.5108296032e-01,4.5245181341e-01,4.5381960131e-01,4.5518632081e-01,4.5655196868e-01,4.5791654172e-01,4.5928003672e-01,4.6064245045e-01,4.6200377972e-01,4.6336402132e-01,4.6472317204e-01,4.6608122870e-01,4.6743818808e-01,4.6879404700e-01,4.7014880226e-01,4.7150245068e-01,4.7285498906e-01,4.7420641423e-01,4.7555672299e-01,4.7690591218e-01,4.7825397862e-01,4.7960091913e-01,4.8094673054e-01,4.8229140968e-01,4.8363495340e-01,4.8497735851e-01,4.8631862187e-01,4.8765874032e-01,4.8899771069e-01,4.9033552985e-01,4.9167219463e-01,4.9300770190e-01,4.9434204851e-01,4.9567523131e-01,4.9700724718e-01,4.9833809296e-01,4.9966776554e-01,5.0099626177e-01,5.0232357854e-01,5.0364971271e-01,5.0497466117e-01,5.0629842079e-01,5.0762098846e-01,5.0894236107e-01,5.1026253550e-01,5.1158150865e-01,5.1289927741e-01,5.1421583867e-01,5.1553118935e-01,5.1684532634e-01,5.1815824655e-01,5.1946994689e-01,5.2078042427e-01,5.2208967560e-01,5.2339769780e-01,5.2470448780e-01,5.2601004251e-01,5.2731435887e-01,5.2861743380e-01,5.2991926423e-01,5.3121984711e-01,5.3251917936e-01,5.3381725793e-01,5.3511407976e-01,5.3640964180e-01,5.3770394101e-01,5.3899697432e-01,5.4028873871e-01,5.4157923112e-01,5.4286844852e-01,5.4415638787e-01,5.4544304615e-01,5.4672842032e-01,5.4801250735e-01,5.4929530423e-01,5.5057680794e-01,5.5185701545e-01,5.5313592375e-01,5.5441352984e-01,5.5568983070e-01,5.5696482333e-01,5.5823850472e-01,5.5951087189e-01,5.6078192183e-01,5.6205165155e-01,5.6332005806e-01,5.6458713838e-01,5.6585288953e-01,5.6711730851e-01,5.6838039236e-01,5.6964213811e-01,5.7090254277e-01,5.7216160340e-01,5.7341931701e-01,5.7467568065e-01,5.7593069137e-01,5.7718434620e-01,5.7843664220e-01,5.7968757641e-01,5.8093714590e-01,5.8218534772e-01,5.8343217893e-01,5.8467763660e-01,5.8592171780e-01,5.8716441959e-01,5.8840573905e-01,5.8964567326e-01,5.9088421930e-01,5.9212137425e-01,5.9335713520e-01,5.9459149924e-01,5.9582446347e-01,5.9705602498e-01,5.9828618088e-01,5.9951492826e-01,6.0074226424e-01,6.0196818592e-01,6.0319269042e-01,6.0441577486e-01,6.0563743635e-01,6.0685767202e-01,6.0807647900e-01,6.0929385442e-01,6.1050979541e-01,6.1172429912e-01,6.1293736267e-01,6.1414898321e-01,6.1535915790e-01,6.1656788388e-01,6.1777515831e-01,6.1898097835e-01,6.2018534115e-01,6.2138824388e-01,6.2258968372e-01,6.2378965782e-01,6.2498816337e-01,6.2618519754e-01,6.2738075752e-01,6.2857484049e-01,6.2976744364e-01,6.3095856416e-01,6.3214819925e-01,6.3333634611e-01,6.3452300194e-01,6.3570816394e-01,6.3689182933e-01,6.3807399533e-01,6.3925465914e-01,6.4043381798e-01,6.4161146909e-01,6.4278760969e-01,6.4396223700e-01,6.4513534827e-01,6.4630694074e-01,6.4747701163e-01,6.4864555821e-01,6.4981257772e-01,6.5097806741e-01,6.5214202453e-01,6.5330444635e-01,6.5446533014e-01,6.5562467315e-01,6.5678247266e-01,6.5793872594e-01,6.5909343027e-01,6.6024658294e-01,6.6139818122e-01,6.6254822240e-01,6.6369670379e-01,6.6484362267e-01,6.6598897634e-01,6.6713276212e-01,6.6827497730e-01,6.6941561919e-01,6.7055468512e-01,6.7169217239e-01,6.7282807834e-01,6.7396240028e-01,6.7509513555e-01,6.7622628148e-01,6.7735583541e-01,6.7848379467e-01,6.7961015662e-01,6.8073491860e-01,6.8185807796e-01,6.8297963206e-01,6.8409957825e-01,6.8521791391e-01,6.8633463640e-01,6.8744974308e-01,6.8856323134e-01,6.8967509856e-01,6.9078534210e-01,6.9189395937e-01,6.9300094775e-01,6.9410630464e-01,6.9521002743e-01,6.9631211352e-01,6.9741256033e-01,6.9851136525e-01,6.9960852570e-01,7.0070403911e-01,7.0179790288e-01,7.0289011445e-01,7.0398067125e-01,7.0506957070e-01,7.0615681024e-01,
		7.0724238732e-01,7.0832629937e-01,7.0940854385e-01,7.1048911821e-01,7.1156801990e-01,7.1264524638e-01,7.1372079513e-01,7.1479466359e-01,7.1586684926e-01,7.1693734960e-01,7.1800616209e-01,7.1907328422e-01,7.2013871347e-01,7.2120244734e-01,7.2226448333e-01,7.2332481892e-01,7.2438345163e-01,7.2544037896e-01,7.2649559843e-01,7.2754910755e-01,7.2860090383e-01,7.2965098482e-01,7.3069934802e-01,7.3174599098e-01,7.3279091123e-01,7.3383410631e-01,7.3487557376e-01,7.3591531114e-01,7.3695331598e-01,7.3798958586e-01,7.3902411833e-01,7.4005691096e-01,7.4108796131e-01,7.4211726696e-01,7.4314482548e-01,7.4417063445e-01,7.4519469147e-01,7.4621699411e-01,7.4723753997e-01,7.4825632665e-01,7.4927335176e-01,7.5028861289e-01,7.5130210765e-01,7.5231383367e-01,7.5332378855e-01,7.5433196992e-01,7.5533837542e-01,7.5634300265e-01,7.5734584928e-01,7.5834691292e-01,7.5934619123e-01,7.6034368185e-01,7.6133938243e-01,7.6233329063e-01,7.6332540412e-01,7.6431572055e-01,7.6530423759e-01,7.6629095291e-01,7.6727586420e-01,7.6825896913e-01,7.6924026540e-01,7.7021975068e-01,7.7119742267e-01,7.7217327908e-01,7.7314731760e-01,7.7411953594e-01,7.7508993181e-01,7.7605850293e-01,7.7702524702e-01,7.7799016180e-01,7.7895324500e-01,7.7991449435e-01,7.8087390760e-01,7.8183148247e-01,7.8278721672e-01,7.8374110809e-01,7.8469315435e-01,7.8564335324e-01,7.8659170254e-01,7.8753820001e-01,7.8848284341e-01,7.8942563054e-01,7.9036655916e-01,7.9130562707e-01,7.9224283205e-01,7.9317817189e-01,7.9411164440e-01,7.9504324737e-01,7.9597297862e-01,7.9690083595e-01,7.9782681717e-01,7.9875092012e-01,7.9967314261e-01,8.0059348248e-01,8.0151193755e-01,8.0242850566e-01,8.0334318467e-01,8.0425597240e-01,8.0516686671e-01,8.0607586547e-01,8.0698296652e-01,8.0788816774e-01,8.0879146699e-01,8.0969286215e-01,8.1059235109e-01,8.1148993170e-01,8.1238560186e-01,8.1327935946e-01,8.1417120241e-01,8.1506112859e-01,8.1594913592e-01,8.1683522231e-01,8.1771938566e-01,8.1860162391e-01,8.1948193496e-01,8.2036031675e-01,8.2123676721e-01,8.2211128428e-01,8.2298386589e-01,8.2385451000e-01,8.2472321455e-01,8.2558997751e-01,8.2645479682e-01,8.2731767045e-01,8.2817859637e-01,8.2903757256e-01,8.2989459698e-01,8.3074966763e-01,8.3160278250e-01,8.3245393956e-01,8.3330313683e-01,8.3415037229e-01,8.3499564396e-01,8.3583894984e-01,8.3668028795e-01,8.3751965631e-01,8.3835705295e-01,8.3919247588e-01,8.4002592315e-01,8.4085739279e-01,8.4168688285e-01,8.4251439137e-01,8.4333991640e-01,8.4416345600e-01,8.4498500824e-01,8.4580457117e-01,8.4662214287e-01,8.4743772141e-01,8.4825130488e-01,8.4906289135e-01,8.4987247893e-01,8.5068006569e-01,8.5148564974e-01,8.5228922919e-01,8.5309080213e-01,8.5389036669e-01,8.5468792099e-01,8.5548346313e-01,8.5627699126e-01,8.5706850351e-01,8.5785799800e-01,8.5864547288e-01,8.5943092630e-01,8.6021435641e-01,8.6099576137e-01,8.6177513932e-01,8.6255248845e-01,8.6332780692e-01,8.6410109290e-01,8.6487234457e-01,8.6564156012e-01,8.6640873774e-01,8.6717387562e-01,8.6793697196e-01,8.6869802496e-01,8.6945703283e-01,8.7021399378e-01,8.7096890604e-01,8.7172176783e-01,8.7247257736e-01,8.7322133288e-01,8.7396803263e-01,8.7471267483e-01,8.7545525775e-01,8.7619577963e-01,8.7693423874e-01,8.7767063332e-01,8.7840496165e-01,8.7913722200e-01,8.7986741264e-01,8.8059553186e-01,8.8132157794e-01,8.8204554917e-01,8.8276744385e-01,8.8348726028e-01,8.8420499676e-01,8.8492065161e-01,8.8563422313e-01,8.8634570966e-01,8.8705510950e-01,8.8776242101e-01,8.8846764250e-01,8.8917077232e-01,8.8987180881e-01,8.9057075033e-01,8.9126759522e-01,8.9196234185e-01,8.9265498858e-01,8.9334553379e-01,8.9403397583e-01,8.9472031310e-01,8.9540454398e-01,8.9608666686e-01,8.9676668013e-01,8.9744458219e-01,8.9812037144e-01,8.9879404630e-01,8.9946560517e-01,9.0013504649e-01,9.0080236866e-01,9.0146757012e-01,9.0213064931e-01,9.0279160466e-01,9.0345043461e-01,9.0410713762e-01,9.0476171214e-01,9.0541415663e-01,9.0606446955e-01,9.0671264937e-01,9.0735869457e-01,9.0800260362e-01,9.0864437501e-01,9.0928400723e-01,9.0992149877e-01,9.1055684813e-01,9.1119005381e-01,9.1182111433e-01,9.1245002820e-01,9.1307679394e-01,9.1370141007e-01,9.1432387512e-01,9.1494418763e-01,9.1556234613e-01,9.1617834918e-01,9.1679219532e-01,9.1740388310e-01,9.1801341109e-01,9.1862077785e-01,9.1922598194e-01,9.1982902196e-01,9.2042989647e-01,9.2102860406e-01,9.2162514333e-01,9.2221951286e-01,9.2281171126e-01,9.2340173714e-01,9.2398958910e-01,9.2457526576e-01,9.2515876574e-01,9.2574008768e-01,9.2631923019e-01,9.2689619192e-01,9.2747097151e-01,9.2804356760e-01,9.2861397885e-01,9.2918220392e-01,9.2974824146e-01,9.3031209014e-01,9.3087374864e-01,9.3143321564e-01,9.3199048981e-01,9.3254556985e-01,9.3309845445e-01,9.3364914230e-01,9.3419763211e-01,9.3474392260e-01,9.3528801246e-01,9.3582990043e-01,9.3636958522e-01,9.3690706557e-01,9.3744234021e-01,9.3797540788e-01,9.3850626732e-01,9.3903491729e-01,9.3956135654e-01,9.4008558384e-01,9.4060759794e-01,9.4112739761e-01,9.4164498165e-01,9.4216034881e-01,9.4267349790e-01,9.4318442771e-01,9.4369313703e-01,9.4419962466e-01,9.4470388941e-01,9.4520593010e-01,9.4570574554e-01,9.4620333456e-01,9.4669869598e-01,9.4719182864e-01,9.4768273138e-01,9.4817140304e-01,9.4865784247e-01,9.4914204853e-01,9.4962402007e-01,9.5010375596e-01,9.5058125508e-01,9.5105651630e-01,9.5152953849e-01,9.5200032055e-01,9.5246886136e-01,9.5293515983e-01,9.5339921486e-01,9.5386102535e-01,9.5432059021e-01,9.5477790838e-01,9.5523297875e-01,9.5568580028e-01,9.5613637188e-01,9.5658469251e-01,9.5703076110e-01,9.5747457660e-01,9.5791613798e-01,9.5835544418e-01,9.5879249418e-01,9.5922728695e-01,9.5965982145e-01,9.6009009669e-01,9.6051811163e-01,9.6094386528e-01,9.6136735663e-01,9.6178858469e-01,9.6220754845e-01,9.6262424695e-01,9.6303867919e-01,9.6345084420e-01,9.6386074101e-01,9.6426836866e-01,9.6467372618e-01,9.6507681262e-01,9.6547762703e-01,9.6587616847e-01,9.6627243601e-01,9.6666642869e-01,9.6705814561e-01,9.6744758584e-01,9.6783474845e-01,9.6821963254e-01,9.6860223721e-01,9.6898256155e-01,9.6936060467e-01,9.6973636567e-01,9.7010984367e-01,9.7048103780e-01,9.7084994718e-01,9.7121657093e-01,9.7158090821e-01,9.7194295814e-01,9.7230271988e-01,9.7266019258e-01,9.7301537540e-01,9.7336826750e-01,9.7371886806e-01,9.7406717624e-01,9.7441319122e-01,9.7475691220e-01,9.7509833836e-01,9.7543746890e-01,9.7577430302e-01,9.7610883992e-01,9.7644107883e-01,9.7677101895e-01,9.7709865952e-01,9.7742399975e-01,9.7774703889e-01,9.7806777617e-01,9.7838621084e-01,9.7870234214e-01,9.7901616934e-01,9.7932769170e-01,9.7963690847e-01,9.7994381894e-01,9.8024842239e-01,9.8055071808e-01,9.8085070532e-01,9.8114838339e-01,9.8144375160e-01,9.8173680925e-01,9.8202755565e-01,9.8231599012e-01,9.8260211197e-01,9.8288592054e-01,9.8316741514e-01,9.8344659514e-01,9.8372345985e-01,9.8399800864e-01,9.8427024086e-01,9.8454015586e-01,9.8480775301e-01,9.8507303168e-01,9.8533599125e-01,9.8559663110e-01,9.8585495061e-01,9.8611094917e-01,9.8636462618e-01,9.8661598105e-01,9.8686501319e-01,9.8711172200e-01,9.8735610690e-01,9.8759816733e-01,9.8783790271e-01,9.8807531247e-01,9.8831039607e-01,9.8854315293e-01,9.8877358253e-01,9.8900168430e-01,9.8922745773e-01,9.8945090227e-01,9.8967201739e-01,9.8989080259e-01,9.9010725734e-01,9.9032138114e-01,9.9053317347e-01,9.9074263384e-01,9.9094976177e-01,9.9115455675e-01,9.9135701831e-01,9.9155714598e-01,9.9175493927e-01,9.9195039773e-01,9.9214352090e-01,9.9233430831e-01,9.9252275953e-01,9.9270887410e-01,9.9289265159e-01,9.9307409157e-01,9.9325319361e-01,9.9342995728e-01,9.9360438218e-01,9.9377646788e-01,9.9394621400e-01,9.9411362012e-01,9.9427868585e-01,9.9444141080e-01,9.9460179460e-01,9.9475983685e-01,9.9491553720e-01,9.9506889528e-01,9.9521991071e-01,9.9536858315e-01,9.9551491225e-01,9.9565889767e-01,9.9580053905e-01,9.9593983608e-01,9.9607678842e-01,9.9621139575e-01,9.9634365776e-01,9.9647357412e-01,9.9660114455e-01,9.9672636873e-01,9.9684924636e-01,9.9696977717e-01,9.9708796087e-01,9.9720379718e-01,9.9731728583e-01,9.9742842654e-01,9.9753721906e-01,9.9764366314e-01,9.9774775852e-01,9.9784950495e-01,9.9794890220e-01,9.9804595003e-01,9.9814064822e-01,9.9823299654e-01,9.9832299477e-01,9.9841064270e-01,9.9849594013e-01,9.9857888686e-01,9.9865948268e-01,9.9873772741e-01,9.9881362087e-01,9.9888716288e-01,9.9895835326e-01,9.9902719185e-01,9.9909367848e-01,9.9915781300e-01,9.9921959526e-01,9.9927902510e-01,9.9933610240e-01,9.9939082702e-01,9.9944319882e-01,9.9949321769e-01,9.9954088351e-01,9.9958619616e-01,9.9962915554e-01,9.9966976154e-01,9.9970801408e-01,9.9974391306e-01,9.9977745839e-01,9.9980865001e-01,9.9983748783e-01,9.9986397178e-01,9.9988810181e-01,9.9990987786e-01,9.9992929987e-01,9.9994636780e-01,9.9996108162e-01,9.9997344127e-01,9.9998344675e-01,9.9999109802e-01,9.9999639506e-01,9.9999933787e-01,
		9.9999992643e-01,9.9999816075e-01,9.9999404082e-01,9.9998756666e-01,9.9997873829e-01,9.9996755572e-01,9.9995401898e-01,9.9993812810e-01,9.9991988312e-01,9.9989928408e-01,9.9987633104e-01,9.9985102404e-01,9.9982336315e-01,9.9979334842e-01,9.9976097994e-01,9.9972625777e-01,9.9968918200e-01,9.9964975272e-01,9.9960797001e-01,9.9956383399e-01,9.9951734474e-01,9.9946850238e-01,9.9941730703e-01,9.9936375880e-01,9.9930785783e-01,9.9924960424e-01,9.9918899817e-01,9.9912603977e-01,9.9906072917e-01,9.9899306654e-01,9.9892305204e-01,9.9885068582e-01,9.9877596807e-01,9.9869889895e-01,9.9861947864e-01,9.9853770734e-01,9.9845358524e-01,9.9836711253e-01,9.9827828943e-01,9.9818711612e-01,9.9809359284e-01,9.9799771981e-01,9.9789949724e-01,9.9779892537e-01,9.9769600443e-01,9.9759073467e-01,9.9748311634e-01,9.9737314969e-01,9.9726083498e-01,9.9714617247e-01,9.9702916243e-01,9.9690980514e-01,9.9678810088e-01,9.9666404994e-01,9.9653765260e-01,9.9640890917e-01,9.9627781994e-01,9.9614438524e-01,9.9600860536e-01,9.9587048063e-01,9.9573001139e-01,9.9558719794e-01,9.9544204064e-01,9.9529453983e-01,9.9514469584e-01,9.9499250905e-01,9.9483797979e-01,9.9468110844e-01,9.9452189537e-01,9.9436034095e-01,9.9419644555e-01,9.9403020958e-01,9.9386163341e-01,9.9369071745e-01,9.9351746210e-01,9.9334186776e-01,9.9316393486e-01,9.9298366379e-01,9.9280105501e-01,9.9261610892e-01,9.9242882597e-01,9.9223920660e-01,9.9204725125e-01,9.9185296039e-01,9.9165633445e-01,9.9145737391e-01,9.9125607924e-01,9.9105245091e-01,9.9084648939e-01,9.9063819518e-01,9.9042756877e-01,9.9021461064e-01,9.8999932130e-01,9.8978170127e-01,9.8956175104e-01,9.8933947114e-01,9.8911486209e-01,9.8888792443e-01,9.8865865867e-01,9.8842706538e-01,9.8819314508e-01,9.8795689833e-01,9.8771832569e-01,9.8747742771e-01,9.8723420497e-01,9.8698865804e-01,9.8674078750e-01,9.8649059392e-01,9.8623807791e-01,9.8598324004e-01,9.8572608093e-01,9.8546660118e-01,9.8520480140e-01,9.8494068220e-01,9.8467424421e-01,9.8440548805e-01,9.8413441436e-01,9.8386102378e-01,9.8358531695e-01,9.8330729451e-01,9.8302695713e-01,9.8274430546e-01,9.8245934016e-01,9.8217206192e-01,9.8188247140e-01,9.8159056929e-01,9.8129635628e-01,9.8099983305e-01,9.8070100030e-01,9.8039985875e-01,9.8009640909e-01,9.7979065204e-01,9.7948258833e-01,9.7917221867e-01,9.7885954380e-01,9.7854456446e-01,9.7822728138e-01,9.7790769531e-01,9.7758580700e-01,9.7726161722e-01,9.7693512673e-01,9.7660633629e-01,9.7627524668e-01,9.7594185867e-01,9.7560617306e-01,9.7526819063e-01,9.7492791218e-01,9.7458533851e-01,9.7424047043e-01,9.7389330874e-01,9.7354385427e-01,9.7319210784e-01,9.7283807028e-01,9.7248174241e-01,9.7212312509e-01,9.7176221914e-01,9.7139902543e-01,9.7103354481e-01,9.7066577814e-01,9.7029572628e-01,9.6992339010e-01,9.6954877049e-01,9.6917186832e-01,9.6879268448e-01,9.6841121986e-01,9.6802747537e-01,9.6764145190e-01,9.6725315037e-01,9.6686257168e-01,9.6646971676e-01,9.6607458654e-01,9.6567718193e-01,9.6527750389e-01,9.6487555334e-01,9.6447133124e-01,9.6406483854e-01,9.6365607619e-01,9.6324504516e-01,9.6283174641e-01,9.6241618092e-01,9.6199834967e-01,9.6157825363e-01,9.6115589381e-01,9.6073127118e-01,9.6030438676e-01,9.5987524154e-01,9.5944383655e-01,9.5901017278e-01,9.5857425127e-01,9.5813607304e-01,9.5769563912e-01,9.5725295055e-01,9.5680800838e-01,9.5636081364e-01,9.5591136739e-01,9.5545967069e-01,9.5500572460e-01,9.5454953020e-01,9.5409108855e-01,9.5363040074e-01,9.5316746784e-01,9.5270229096e-01,9.5223487118e-01,9.5176520960e-01,9.5129330734e-01,9.5081916550e-01,9.5034278519e-01,9.4986416754e-01,9.4938331368e-01,9.4890022474e-01,9.4841490186e-01,9.4792734617e-01,9.4743755882e-01,9.4694554098e-01,9.4645129379e-01,9.4595481843e-01,9.4545611605e-01,9.4495518784e-01,9.4445203497e-01,9.4394665863e-01,9.4343906001e-01,9.4292924029e-01,9.4241720069e-01,9.4190294241e-01,9.4138646666e-01,9.4086777465e-01,9.4034686761e-01,9.3982374676e-01,9.3929841334e-01,9.3877086857e-01,9.3824111371e-01,9.3770914999e-01,9.3717497868e-01,9.3663860103e-01,9.3610001830e-01,9.3555923176e-01,9.3501624269e-01,9.3447105235e-01,9.3392366204e-01,9.3337407305e-01,9.3282228666e-01,9.3226830418e-01,9.3171212691e-01,9.3115375616e-01,9.3059319325e-01,9.3003043949e-01,9.2946549621e-01,9.2889836474e-01,9.2832904642e-01,9.2775754258e-01,9.2718385457e-01,9.2660798374e-01,9.2602993145e-01,9.2544969905e-01,9.2486728792e-01,9.2428269943e-01,9.2369593494e-01,9.2310699585e-01,9.2251588354e-01,9.2192259940e-01,9.2132714483e-01,9.2072952122e-01,9.2012972999e-01,9.1952777255e-01,9.1892365032e-01,9.1831736471e-01,9.1770891716e-01,9.1709830909e-01,9.1648554195e-01,9.1587061718e-01,9.1525353622e-01,9.1463430053e-01,9.1401291157e-01,9.1338937080e-01,9.1276367968e-01,9.1213583969e-01,9.1150585231e-01,9.1087371902e-01,9.1023944131e-01,9.0960302068e-01,9.0896445861e-01,9.0832375662e-01,9.0768091621e-01,9.0703593889e-01,9.0638882619e-01,9.0573957963e-01,9.0508820073e-01,9.0443469104e-01,9.0377905208e-01,9.0312128540e-01,9.0246139256e-01,9.0179937510e-01,9.0113523458e-01,9.0046897256e-01,8.9980059062e-01,8.9913009033e-01,8.9845747327e-01,8.9778274101e-01,8.9710589516e-01,8.9642693730e-01,8.9574586902e-01,8.9506269194e-01,8.9437740767e-01,8.9369001780e-01,8.9300052398e-01,8.9230892781e-01,8.9161523092e-01,8.9091943495e-01,8.9022154154e-01,8.8952155233e-01,8.8881946897e-01,8.8811529311e-01,8.8740902640e-01,8.8670067052e-01,8.8599022712e-01,8.8527769789e-01,8.8456308449e-01,8.8384638862e-01,8.8312761195e-01,8.8240675618e-01,8.8168382302e-01,8.8095881415e-01,8.8023173128e-01,8.7950257614e-01,8.7877135043e-01,8.7803805587e-01,8.7730269420e-01,8.7656526714e-01,8.7582577643e-01,8.7508422381e-01,8.7434061103e-01,8.7359493984e-01,8.7284721199e-01,8.7209742924e-01,8.7134559336e-01,8.7059170611e-01,8.6983576928e-01,8.6907778465e-01,8.6831775399e-01,8.6755567909e-01,8.6679156176e-01,8.6602540378e-01,8.6525720697e-01,8.6448697313e-01,8.6371470408e-01,8.6294040163e-01,8.6216406761e-01,8.6138570383e-01,8.6060531215e-01,8.5982289439e-01,8.5903845239e-01,8.5825198801e-01,8.5746350309e-01,8.5667299949e-01,8.5588047907e-01,8.5508594370e-01,8.5428939524e-01,8.5349083558e-01,8.5269026659e-01,8.5188769016e-01,8.5108310817e-01,8.5027652253e-01,8.4946793512e-01,8.4865734786e-01,8.4784476265e-01,8.4703018141e-01,8.4621360604e-01,8.4539503849e-01,8.4457448066e-01,8.4375193450e-01,8.4292740194e-01,8.4210088492e-01,8.4127238539e-01,8.4044190530e-01,8.3960944660e-01,8.3877501125e-01,8.3793860122e-01,8.3710021847e-01,8.3625986499e-01,8.3541754275e-01,8.3457325372e-01,8.3372699991e-01,8.3287878329e-01,8.3202860588e-01,8.3117646966e-01,8.3032237666e-01,8.2946632886e-01,8.2860832831e-01,8.2774837700e-01,8.2688647697e-01,8.2602263024e-01,8.2515683886e-01,8.2428910485e-01,8.2341943026e-01,8.2254781715e-01,8.2167426755e-01,8.2079878353e-01,8.1992136714e-01,8.1904202046e-01,8.1816074555e-01,8.1727754450e-01,8.1639241937e-01,8.1550537225e-01,8.1461640523e-01,8.1372552040e-01,8.1283271986e-01,8.1193800572e-01,8.1104138007e-01,8.1014284503e-01,8.0924240272e-01,8.0834005525e-01,8.0743580475e-01,8.0652965334e-01,8.0562160317e-01,8.0471165637e-01,8.0379981507e-01,8.0288608144e-01,8.0197045761e-01,8.0105294575e-01,8.0013354801e-01,7.9921226656e-01,7.9828910357e-01,7.9736406121e-01,7.9643714166e-01,7.9550834710e-01,7.9457767971e-01,7.9364514170e-01,7.9271073525e-01,7.9177446256e-01,7.9083632584e-01,7.8989632730e-01,7.8895446915e-01,7.8801075361e-01,7.8706518289e-01,7.8611775923e-01,7.8516848485e-01,7.8421736200e-01,7.8326439290e-01,7.8230957981e-01,7.8135292497e-01,7.8039443063e-01,7.7943409905e-01,7.7847193249e-01,7.7750793322e-01,7.7654210350e-01,7.7557444561e-01,7.7460496183e-01,7.7363365443e-01,7.7266052572e-01,7.7168557797e-01,7.7070881348e-01,7.6973023455e-01,7.6874984349e-01,7.6776764261e-01,7.6678363421e-01,7.6579782061e-01,7.6481020414e-01,7.6382078711e-01,7.6282957186e-01,7.6183656073e-01,7.6084175604e-01,7.5984516014e-01,7.5884677539e-01,7.5784660412e-01,7.5684464869e-01,7.5584091146e-01,7.5483539480e-01,7.5382810108e-01,7.5281903265e-01,7.5180819190e-01,7.5079558121e-01,7.4978120297e-01,7.4876505955e-01,7.4774715336e-01,7.4672748679e-01,7.4570606223e-01,7.4468288210e-01,7.4365794881e-01,7.4263126476e-01,7.4160283237e-01,7.4057265407e-01,7.3954073228e-01,7.3850706943e-01,7.3747166795e-01,7.3643453028e-01,7.3539565886e-01,7.3435505614e-01,7.3331272457e-01,7.3226866660e-01,7.3122288469e-01,7.3017538130e-01,7.2912615889e-01,7.2807521995e-01,7.2702256694e-01,7.2596820233e-01,7.2491212862e-01,7.2385434829e-01,7.2279486383e-01,7.2173367773e-01,7.2067079249e-01,7.1960621061e-01,7.1853993461e-01,7.1747196698e-01,7.1640231025e-01,7.1533096694e-01,7.1425793955e-01,7.1318323063e-01,7.1210684270e-01,7.1102877830e-01,7.0994903995e-01,7.0886763022e-01,7.0778455163e-01,
		7.0669980675e-01,7.0561339812e-01,7.0452532830e-01,7.0343559986e-01,7.0234421536e-01,7.0125117736e-01,7.0015648845e-01,6.9906015120e-01,6.9796216818e-01,6.9686254200e-01,6.9576127522e-01,6.9465837046e-01,6.9355383030e-01,6.9244765734e-01,6.9133985419e-01,6.9023042345e-01,6.8911936774e-01,6.8800668968e-01,6.8689239188e-01,6.8577647697e-01,6.8465894756e-01,6.8353980631e-01,6.8241905583e-01,6.8129669877e-01,6.8017273777e-01,6.7904717548e-01,6.7792001454e-01,6.7679125761e-01,6.7566090735e-01,6.7452896642e-01,6.7339543748e-01,6.7226032320e-01,6.7112362625e-01,6.6998534932e-01,6.6884549507e-01,6.6770406620e-01,6.6656106539e-01,6.6541649533e-01,6.6427035871e-01,6.6312265824e-01,6.6197339662e-01,6.6082257654e-01,6.5967020073e-01,6.5851627189e-01,6.5736079275e-01,6.5620376601e-01,6.5504519441e-01,6.5388508067e-01,6.5272342753e-01,6.5156023771e-01,6.5039551396e-01,6.4922925902e-01,6.4806147564e-01,6.4689216655e-01,6.4572133453e-01,6.4454898232e-01,6.4337511268e-01,6.4219972838e-01,6.4102283218e-01,6.3984442685e-01,6.3866451518e-01,6.3748309993e-01,6.3630018389e-01,6.3511576984e-01,6.3392986058e-01,6.3274245888e-01,6.3155356756e-01,6.3036318940e-01,6.2917132721e-01,6.2797798380e-01,6.2678316198e-01,6.2558686455e-01,6.2438909434e-01,6.2318985416e-01,6.2198914684e-01,6.2078697520e-01,6.1958334208e-01,6.1837825031e-01,6.1717170272e-01,6.1596370216e-01,6.1475425147e-01,6.1354335349e-01,6.1233101109e-01,6.1111722710e-01,6.0990200440e-01,6.0868534584e-01,6.0746725428e-01,6.0624773259e-01,6.0502678365e-01,6.0380441033e-01,6.0258061550e-01,6.0135540205e-01,6.0012877286e-01,5.9890073082e-01,5.9767127882e-01,5.9644041975e-01,5.9520815652e-01,5.9397449202e-01,5.9273942916e-01,5.9150297084e-01,5.9026511998e-01,5.8902587949e-01,5.8778525229e-01,5.8654324130e-01,5.8529984944e-01,5.8405507964e-01,5.8280893484e-01,5.8156141795e-01,5.8031253193e-01,5.7906227971e-01,5.7781066424e-01,5.7655768845e-01,5.7530335531e-01,5.7404766776e-01,5.7279062876e-01,5.7153224128e-01,5.7027250826e-01,5.6901143268e-01,5.6774901751e-01,5.6648526572e-01,5.6522018029e-01,5.6395376418e-01,5.6268602039e-01,5.6141695190e-01,5.6014656170e-01,5.5887485277e-01,5.5760182812e-01,5.5632749073e-01,5.5505184361e-01,5.5377488976e-01,5.5249663219e-01,5.5121707391e-01,5.4993621792e-01,5.4865406725e-01,5.4737062492e-01,5.4608589394e-01,5.4479987733e-01,5.4351257814e-01,5.4222399938e-01,5.4093414410e-01,5.3964301532e-01,5.3835061609e-01,5.3705694945e-01,5.3576201845e-01,5.3446582613e-01,5.3316837554e-01,5.3186966975e-01,5.3056971181e-01,5.2926850477e-01,5.2796605170e-01,5.2666235568e-01,5.2535741976e-01,5.2405124702e-01,5.2274384053e-01,5.2143520338e-01,5.2012533864e-01,5.1881424940e-01,5.1750193874e-01,5.1618840975e-01,5.1487366553e-01,5.1355770917e-01,5.1224054377e-01,5.1092217243e-01,5.0960259825e-01,5.0828182434e-01,5.0695985381e-01,5.0563668978e-01,5.0431233535e-01,5.0298679364e-01,5.0166006778e-01,5.0033216089e-01,4.9900307610e-01,4.9767281653e-01,4.9634138531e-01,4.9500878558e-01,4.9367502049e-01,4.9234009315e-01,4.9100400673e-01,4.8966676437e-01,4.8832836921e-01,4.8698882440e-01,4.8564813311e-01,4.8430629848e-01,4.8296332367e-01,4.8161921184e-01,4.8027396617e-01,4.7892758982e-01,4.7758008595e-01,4.7623145774e-01,4.7488170836e-01,4.7353084099e-01,4.7217885882e-01,4.7082576502e-01,4.6947156279e-01,4.6811625530e-01,4.6675984575e-01,4.6540233733e-01,4.6404373324e-01,4.6268403668e-01,4.6132325084e-01,4.5996137894e-01,4.5859842418e-01,4.5723438976e-01,4.5586927890e-01,4.5450309481e-01,4.5313584071e-01,4.5176751981e-01,4.5039813535e-01,4.4902769053e-01,4.4765618860e-01,4.4628363277e-01,4.4491002628e-01,4.4353537236e-01,4.4215967425e-01,4.4078293519e-01,4.3940515842e-01,4.3802634717e-01,4.3664650471e-01,4.3526563428e-01,4.3388373912e-01,4.3250082249e-01,4.3111688765e-01,4.2973193785e-01,4.2834597636e-01,4.2695900644e-01,4.2557103135e-01,4.2418205436e-01,4.2279207875e-01,4.2140110777e-01,4.2000914472e-01,4.1861619286e-01,4.1722225547e-01,4.1582733584e-01,4.1443143725e-01,4.1303456299e-01,4.1163671634e-01,4.1023790060e-01,4.0883811906e-01,4.0743737501e-01,4.0603567175e-01,4.0463301259e-01,4.0322940082e-01,4.0182483975e-01,4.0041933268e-01,3.9901288293e-01,3.9760549381e-01,3.9619716862e-01,3.9478791069e-01,3.9337772333e-01,3.9196660986e-01,3.9055457361e-01,3.8914161789e-01,3.8772774604e-01,3.8631296138e-01,3.8489726725e-01,3.8348066698e-01,3.8206316389e-01,3.8064476134e-01,3.7922546265e-01,3.7780527118e-01,3.7638419026e-01,3.7496222323e-01,3.7353937346e-01,3.7211564428e-01,3.7069103905e-01,3.6926556112e-01,3.6783921384e-01,3.6641200059e-01,3.6498392471e-01,3.6355498957e-01,3.6212519853e-01,3.6069455496e-01,3.5926306222e-01,3.5783072369e-01,3.5639754274e-01,3.5496352275e-01,3.5352866708e-01,3.5209297912e-01,3.5065646224e-01,3.4921911983e-01,3.4778095528e-01,3.4634197196e-01,3.4490217327e-01,3.4346156259e-01,3.4202014333e-01,3.4057791886e-01,3.3913489258e-01,3.3769106791e-01,3.3624644822e-01,3.3480103692e-01,3.3335483743e-01,3.3190785313e-01,3.3046008744e-01,3.2901154376e-01,3.2756222552e-01,3.2611213610e-01,3.2466127895e-01,3.2320965745e-01,3.2175727505e-01,3.2030413515e-01,3.1885024117e-01,3.1739559654e-01,3.1594020468e-01,3.1448406903e-01,3.1302719300e-01,3.1156958002e-01,3.1011123354e-01,3.0865215698e-01,3.0719235377e-01,3.0573182736e-01,3.0427058118e-01,3.0280861867e-01,3.0134594328e-01,2.9988255844e-01,2.9841846761e-01,2.9695367422e-01,2.9548818174e-01,2.9402199360e-01,2.9255511326e-01,2.9108754418e-01,2.8961928980e-01,2.8815035359e-01,2.8668073900e-01,2.8521044950e-01,2.8373948854e-01,2.8226785958e-01,2.8079556610e-01,2.7932261156e-01,2.7784899942e-01,2.7637473316e-01,2.7489981624e-01,2.7342425215e-01,2.7194804434e-01,2.7047119630e-01,2.6899371151e-01,2.6751559344e-01,2.6603684557e-01,2.6455747138e-01,2.6307747436e-01,2.6159685799e-01,2.6011562576e-01,2.5863378116e-01,2.5715132766e-01,2.5566826877e-01,2.5418460797e-01,2.5270034876e-01,2.5121549463e-01,2.4973004908e-01,2.4824401560e-01,2.4675739769e-01,2.4527019886e-01,2.4378242260e-01,2.4229407241e-01,2.4080515181e-01,2.3931566429e-01,2.3782561336e-01,2.3633500253e-01,2.3484383532e-01,2.3335211522e-01,2.3185984575e-01,2.3036703043e-01,2.2887367277e-01,2.2737977628e-01,2.2588534449e-01,2.2439038090e-01,2.2289488905e-01,2.2139887245e-01,2.1990233461e-01,2.1840527908e-01,2.1690770936e-01,2.1540962899e-01,2.1391104150e-01,2.1241195040e-01,2.1091235924e-01,2.0941227153e-01,2.0791169082e-01,2.0641062063e-01,2.0490906450e-01,2.0340702596e-01,2.0190450856e-01,2.0040151582e-01,1.9889805128e-01,1.9739411849e-01,1.9588972099e-01,1.9438486232e-01,1.9287954601e-01,1.9137377562e-01,1.8986755469e-01,1.8836088676e-01,1.8685377538e-01,1.8534622411e-01,1.8383823648e-01,1.8232981606e-01,1.8082096638e-01,1.7931169101e-01,1.7780199349e-01,1.7629187739e-01,1.7478134625e-01,1.7327040363e-01,1.7175905309e-01,1.7024729819e-01,1.6873514248e-01,1.6722258953e-01,1.6570964290e-01,1.6419630614e-01,1.6268258283e-01,1.6116847652e-01,1.5965399078e-01,1.5813912918e-01,1.5662389528e-01,1.5510829264e-01,1.5359232485e-01,1.5207599546e-01,1.5055930804e-01,1.4904226618e-01,1.4752487343e-01,1.4600713337e-01,1.4448904957e-01,1.4297062561e-01,1.4145186506e-01,1.3993277150e-01,1.3841334851e-01,1.3689359965e-01,1.3537352851e-01,1.3385313868e-01,1.3233243371e-01,1.3081141721e-01,1.2929009274e-01,1.2776846389e-01,1.2624653425e-01,1.2472430738e-01,1.2320178689e-01,1.2167897635e-01,1.2015587934e-01,1.1863249946e-01,1.1710884029e-01,1.1558490542e-01,1.1406069843e-01,1.1253622292e-01,1.1101148247e-01,1.0948648066e-01,1.0796122110e-01,1.0643570738e-01,1.0490994307e-01,1.0338393179e-01,1.0185767711e-01,1.0033118263e-01,9.8804451955e-02,9.7277488665e-02,9.5750296360e-02,9.4222878635e-02,9.2695239086e-02,9.1167381310e-02,8.9639308903e-02,8.8111025464e-02,8.6582534589e-02,8.5053839878e-02,8.3524944929e-02,8.1995853342e-02,8.0466568717e-02,7.8937094653e-02,7.7407434752e-02,7.5877592615e-02,7.4347571844e-02,7.2817376039e-02,7.1287008805e-02,6.9756473744e-02,6.8225774459e-02,6.6694914554e-02,6.5163897632e-02,6.3632727298e-02,6.2101407158e-02,6.0569940815e-02,5.9038331876e-02,5.7506583946e-02,5.5974700632e-02,5.4442685539e-02,5.2910542275e-02,5.1378274446e-02,4.9845885661e-02,4.8313379526e-02,4.6780759649e-02,4.5248029639e-02,4.3715193103e-02,4.2182253652e-02,4.0649214893e-02,3.9116080436e-02,3.7582853890e-02,3.6049538864e-02,3.4516138970e-02,3.2982657815e-02,3.1449099012e-02,2.9915466169e-02,2.8381762899e-02,2.6847992810e-02,2.5314159515e-02,2.3780266624e-02,2.2246317748e-02,2.0712316499e-02,1.9178266488e-02,1.7644171327e-02,1.6110034627e-02,1.4575860000e-02,1.3041651058e-02,1.1507411413e-02,9.9731446765e-03,8.4388544607e-03,6.9045443777e-03,5.3702180398e-03,3.8358790590e-03,2.3015310477e-03,7.6717761793e-04,
		-7.6717761793e-04,-2.3015310477e-03,-3.8358790590e-03,-5.3702180398e-03,-6.9045443777e-03,-8.4388544607e-03,-9.9731446765e-03,-1.1507411413e-02,-1.3041651058e-02,-1.4575860000e-02,-1.6110034627e-02,-1.7644171327e-02,-1.9178266488e-02,-2.0712316499e-02,-2.2246317748e-02,-2.3780266624e-02,-2.5314159515e-02,-2.6847992810e-02,-2.8381762899e-02,-2.9915466169e-02,-3.1449099012e-02,-3.2982657815e-02,-3.4516138970e-02,-3.6049538864e-02,-3.7582853890e-02,-3.9116080436e-02,-4.0649214893e-02,-4.2182253652e-02,-4.3715193103e-02,-4.5248029639e-02,-4.6780759649e-02,-4.8313379526e-02,-4.9845885661e-02,-5.1378274446e-02,-5.2910542275e-02,-5.4442685539e-02,-5.5974700632e-02,-5.7506583946e-02,-5.9038331876e-02,-6.0569940815e-02,-6.2101407158e-02,-6.3632727298e-02,-6.5163897632e-02,-6.6694914554e-02,-6.8225774459e-02,-6.9756473744e-02,-7.1287008805e-02,-7.2817376039e-02,-7.4347571844e-02,-7.5877592615e-02,-7.7407434752e-02,-7.8937094653e-02,-8.0466568717e-02,-8.1995853342e-02,-8.3524944929e-02,-8.5053839878e-02,-8.6582534589e-02,-8.8111025464e-02,-8.9639308903e-02,-9.1167381310e-02,-9.2695239086e-02,-9.4222878635e-02,-9.5750296360e-02,-9.7277488665e-02,-9.8804451955e-02,-1.0033118263e-01,-1.0185767711e-01,-1.0338393179e-01,-1.0490994307e-01,-1.0643570738e-01,-1.0796122110e-01,-1.0948648066e-01,-1.1101148247e-01,-1.1253622292e-01,-1.1406069843e-01,-1.1558490542e-01,-1.1710884029e-01,-1.1863249946e-01,-1.2015587934e-01,-1.2167897635e-01,-1.2320178689e-01,-1.2472430738e-01,-1.2624653425e-01,-1.2776846389e-01,-1.2929009274e-01,-1.3081141721e-01,-1.3233243371e-01,-1.3385313868e-01,-1.3537352851e-01,-1.3689359965e-01,-1.3841334851e-01,-1.3993277150e-01,-1.4145186506e-01,-1.4297062561e-01,-1.4448904957e-01,-1.4600713337e-01,-1.4752487343e-01,-1.4904226618e-01,-1.5055930804e-01,-1.5207599546e-01,-1.5359232485e-01,-1.5510829264e-01,-1.5662389528e-01,-1.5813912918e-01,-1.5965399078e-01,-1.6116847652e-01,-1.6268258283e-01,-1.6419630614e-01,-1.6570964290e-01,-1.6722258953e-01,-1.6873514248e-01,-1.7024729819e-01,-1.7175905309e-01,-1.7327040363e-01,-1.7478134625e-01,-1.7629187739e-01,-1.7780199349e-01,-1.7931169101e-01,-1.8082096638e-01,-1.8232981606e-01,-1.8383823648e-01,-1.8534622411e-01,-1.8685377538e-01,-1.8836088676e-01,-1.8986755469e-01,-1.9137377562e-01,-1.9287954601e-01,-1.9438486232e-01,-1.9588972099e-01,-1.9739411849e-01,-1.9889805128e-01,-2.0040151582e-01,-2.0190450856e-01,-2.0340702596e-01,-2.0490906450e-01,-2.0641062063e-01,-2.0791169082e-01,-2.0941227153e-01,-2.1091235924e-01,-2.1241195040e-01,-2.1391104150e-01,-2.1540962899e-01,-2.1690770936e-01,-2.1840527908e-01,-2.1990233461e-01,-2.2139887245e-01,-2.2289488905e-01,-2.2439038090e-01,-2.2588534449e-01,-2.2737977628e-01,-2.2887367277e-01,-2.3036703043e-01,-2.3185984575e-01,-2.3335211522e-01,-2.3484383532e-01,-2.3633500253e-01,-2.3782561336e-01,-2.3931566429e-01,-2.4080515181e-01,-2.4229407241e-01,-2.4378242260e-01,-2.4527019886e-01,-2.4675739769e-01,-2.4824401560e-01,-2.4973004908e-01,-2.5121549463e-01,-2.5270034876e-01,-2.5418460797e-01,-2.5566826877e-01,-2.5715132766e-01,-2.5863378116e-01,-2.6011562576e-01,-2.6159685799e-01,-2.6307747436e-01,-2.6455747138e-01,-2.6603684557e-01,-2.6751559344e-01,-2.6899371151e-01,-2.7047119630e-01,-2.7194804434e-01,-2.7342425215e-01,-2.7489981624e-01,-2.7637473316e-01,-2.7784899942e-01,-2.7932261156e-01,-2.8079556610e-01,-2.8226785958e-01,-2.8373948854e-01,-2.8521044950e-01,-2.8668073900e-01,-2.8815035359e-01,-2.8961928980e-01,-2.9108754418e-01,-2.9255511326e-01,-2.9402199360e-01,-2.9548818174e-01,-2.9695367422e-01,-2.9841846761e-01,-2.9988255844e-01,-3.0134594328e-01,-3.0280861867e-01,-3.0427058118e-01,-3.0573182736e-01,-3.0719235377e-01,-3.0865215698e-01,-3.1011123354e-01,-3.1156958002e-01,-3.1302719300e-01,-3.1448406903e-01,-3.1594020468e-01,-3.1739559654e-01,-3.1885024117e-01,-3.2030413515e-01,-3.2175727505e-01,-3.2320965745e-01,-3.2466127895e-01,-3.2611213610e-01,-3.2756222552e-01,-3.2901154376e-01,-3.3046008744e-01,-3.3190785313e-01,-3.3335483743e-01,-3.3480103692e-01,-3.3624644822e-01,-3.3769106791e-01,-3.3913489258e-01,-3.4057791886e-01,-3.4202014333e-01,-3.4346156259e-01,-3.4490217327e-01,-3.4634197196e-01,-3.4778095528e-01,-3.4921911983e-01,-3.5065646224e-01,-3.5209297912e-01,-3.5352866708e-01,-3.5496352275e-01,-3.5639754274e-01,-3.5783072369e-01,-3.5926306222e-01,-3.6069455496e-01,-3.6212519853e-01,-3.6355498957e-01,-3.6498392471e-01,-3.6641200059e-01,-3.6783921384e-01,-3.6926556112e-01,-3.7069103905e-01,-3.7211564428e-01,-3.7353937346e-01,-3.7496222323e-01,-3.7638419026e-01,-3.7780527118e-01,-3.7922546265e-01,-3.8064476134e-01,-3.8206316389e-01,-3.8348066698e-01,-3.8489726725e-01,-3.8631296138e-01,-3.8772774604e-01,-3.8914161789e-01,-3.9055457361e-01,-3.9196660986e-01,-3.9337772333e-01,-3.9478791069e-01,-3.9619716862e-01,-3.9760549381e-01,-3.9901288293e-01,-4.0041933268e-01,-4.0182483975e-01,-4.0322940082e-01,-4.0463301259e-01,-4.0603567175e-01,-4.0743737501e-01,-4.0883811906e-01,-4.1023790060e-01,-4.1163671634e-01,-4.1303456299e-01,-4.1443143725e-01,-4.1582733584e-01,-4.1722225547e-01,-4.1861619286e-01,-4.2000914472e-01,-4.2140110777e-01,-4.2279207875e-01,-4.2418205436e-01,-4.2557103135e-01,-4.2695900644e-01,-4.2834597636e-01,-4.2973193785e-01,-4.3111688765e-01,-4.3250082249e-01,-4.3388373912e-01,-4.3526563428e-01,-4.3664650471e-01,-4.3802634717e-01,-4.3940515842e-01,-4.4078293519e-01,-4.4215967425e-01,-4.4353537236e-01,-4.4491002628e-01,-4.4628363277e-01,-4.4765618860e-01,-4.4902769053e-01,-4.5039813535e-01,-4.5176751981e-01,-4.5313584071e-01,-4.5450309481e-01,-4.5586927890e-01,-4.5723438976e-01,-4.5859842418e-01,-4.5996137894e-01,-4.6132325084e-01,-4.6268403668e-01,-4.6404373324e-01,-4.6540233733e-01,-4.6675984575e-01,-4.6811625530e-01,-4.6947156279e-01,-4.7082576502e-01,-4.7217885882e-01,-4.7353084099e-01,-4.7488170836e-01,-4.7623145774e-01,-4.7758008595e-01,-4.7892758982e-01,-4.8027396617e-01,-4.8161921184e-01,-4.8296332367e-01,-4.8430629848e-01,-4.8564813311e-01,-4.8698882440e-01,-4.8832836921e-01,-4.8966676437e-01,-4.9100400673e-01,-4.9234009315e-01,-4.9367502049e-01,-4.9500878558e-01,-4.9634138531e-01,-4.9767281653e-01,-4.9900307610e-01,-5.0033216089e-01,-5.0166006778e-01,-5.0298679364e-01,-5.0431233535e-01,-5.0563668978e-01,-5.0695985381e-01,-5.0828182434e-01,-5.0960259825e-01,-5.1092217243e-01,-5.1224054377e-01,-5.1355770917e-01,-5.1487366553e-01,-5.1618840975e-01,-5.1750193874e-01,-5.1881424940e-01,-5.2012533864e-01,-5.2143520338e-01,-5.2274384053e-01,-5.2405124702e-01,-5.2535741976e-01,-5.2666235568e-01,-5.2796605170e-01,-5.2926850477e-01,-5.3056971181e-01,-5.3186966975e-01,-5.3316837554e-01,-5.3446582613e-01,-5.3576201845e-01,-5.3705694945e-01,-5.3835061609e-01,-5.3964301532e-01,-5.4093414410e-01,-5.4222399938e-01,-5.4351257814e-01,-5.4479987733e-01,-5.4608589394e-01,-5.4737062492e-01,-5.4865406725e-01,-5.4993621792e-01,-5.5121707391e-01,-5.5249663219e-01,-5.5377488976e-01,-5.5505184361e-01,-5.5632749073e-01,-5.5760182812e-01,-5.5887485277e-01,-5.6014656170e-01,-5.6141695190e-01,-5.6268602039e-01,-5.6395376418e-01,-5.6522018029e-01,-5.6648526572e-01,-5.6774901751e-01,-5.6901143268e-01,-5.7027250826e-01,-5.7153224128e-01,-5.7279062876e-01,-5.7404766776e-01,-5.7530335531e-01,-5.7655768845e-01,-5.7781066424e-01,-5.7906227971e-01,-5.8031253193e-01,-5.8156141795e-01,-5.8280893484e-01,-5.8405507964e-01,-5.8529984944e-01,-5.8654324130e-01,-5.8778525229e-01,-5.8902587949e-01,-5.9026511998e-01,-5.9150297084e-01,-5.9273942916e-01,-5.9397449202e-01,-5.9520815652e-01,-5.9644041975e-01,-5.9767127882e-01,-5.9890073082e-01,-6.0012877286e-01,-6.0135540205e-01,-6.0258061550e-01,-6.0380441033e-01,-6.0502678365e-01,-6.0624773259e-01,-6.0746725428e-01,-6.0868534584e-01,-6.0990200440e-01,-6.1111722710e-01,-6.1233101109e-01,-6.1354335349e-01,-6.1475425147e-01,-6.1596370216e-01,-6.1717170272e-01,-6.1837825031e-01,-6.1958334208e-01,-6.2078697520e-01,-6.2198914684e-01,-6.2318985416e-01,-6.2438909434e-01,-6.2558686455e-01,-6.2678316198e-01,-6.2797798380e-01,-6.2917132721e-01,-6.3036318940e-01,-6.3155356756e-01,-6.3274245888e-01,-6.3392986058e-01,-6.3511576984e-01,-6.3630018389e-01,-6.3748309993e-01,-6.3866451518e-01,-6.3984442685e-01,-6.4102283218e-01,-6.4219972838e-01,-6.4337511268e-01,-6.4454898232e-01,-6.4572133453e-01,-6.4689216655e-01,-6.4806147564e-01,-6.4922925902e-01,-6.5039551396e-01,-6.5156023771e-01,-6.5272342753e-01,-6.5388508067e-01,-6.5504519441e-01,-6.5620376601e-01,-6.5736079275e-01,-6.5851627189e-01,-6.5967020073e-01,-6.6082257654e-01,-6.6197339662e-01,-6.6312265824e-01,-6.6427035871e-01,-6.6541649533e-01,-6.6656106539e-01,-6.6770406620e-01,-6.6884549507e-01,-6.6998534932e-01,-6.7112362625e-01,-6.7226032320e-01,-6.7339543748e-01,-6.7452896642e-01,-6.7566090735e-01,-6.7679125761e-01,-6.7792001454e-01,-6.7904717548e-01,-6.8017273777e-01,-6.8129669877e-01,-6.8241905583e-01,-6.8353980631e-01,-6.8465894756e-01,-6.8577647697e-01,-6.8689239188e-01,-6.8800668968e-01,-6.8911936774e-01,-6.9023042345e-01,-6.9133985419e-01,-6.9244765734e-01,-6.9355383030e-01,-6.9465837046e-01,-6.9576127522e-01,-6.9686254200e-01,-6.9796216818e-01,-6.9906015120e-01,-7.0015648845e-01,-7.0125117736e-01,-7.0234421536e-01,-7.0343559986e-01,-7.0452532830e-01,-7.0561339812e-01,-7.0669980675e-01,
		-7.0778455163e-01,-7.0886763022e-01,-7.0994903995e-01,-7.1102877830e-01,-7.1210684270e-01,-7.1318323063e-01,-7.1425793955e-01,-7.1533096694e-01,-7.1640231025e-01,-7.1747196698e-01,-7.1853993461e-01,-7.1960621061e-01,-7.2067079249e-01,-7.2173367773e-01,-7.2279486383e-01,-7.2385434829e-01,-7.2491212862e-01,-7.2596820233e-01,-7.2702256694e-01,-7.2807521995e-01,-7.2912615889e-01,-7.3017538130e-01,-7.3122288469e-01,-7.3226866660e-01,-7.3331272457e-01,-7.3435505614e-01,-7.3539565886e-01,-7.3643453028e-01,-7.3747166795e-01,-7.3850706943e-01,-7.3954073228e-01,-7.4057265407e-01,-7.4160283237e-01,-7.4263126476e-01,-7.4365794881e-01,-7.4468288210e-01,-7.4570606223e-01,-7.4672748679e-01,-7.4774715336e-01,-7.4876505955e-01,-7.4978120297e-01,-7.5079558121e-01,-7.5180819190e-01,-7.5281903265e-01,-7.5382810108e-01,-7.5483539480e-01,-7.5584091146e-01,-7.5684464869e-01,-7.5784660412e-01,-7.5884677539e-01,-7.5984516014e-01,-7.6084175604e-01,-7.6183656073e-01,-7.6282957186e-01,-7.6382078711e-01,-7.6481020414e-01,-7.6579782061e-01,-7.6678363421e-01,-7.6776764261e-01,-7.6874984349e-01,-7.6973023455e-01,-7.7070881348e-01,-7.7168557797e-01,-7.7266052572e-01,-7.7363365443e-01,-7.7460496183e-01,-7.7557444561e-01,-7.7654210350e-01,-7.7750793322e-01,-7.7847193249e-01,-7.7943409905e-01,-7.8039443063e-01,-7.8135292497e-01,-7.8230957981e-01,-7.8326439290e-01,-7.8421736200e-01,-7.8516848485e-01,-7.8611775923e-01,-7.8706518289e-01,-7.8801075361e-01,-7.8895446915e-01,-7.8989632730e-01,-7.9083632584e-01,-7.9177446256e-01,-7.9271073525e-01,-7.9364514170e-01,-7.9457767971e-01,-7.9550834710e-01,-7.9643714166e-01,-7.9736406121e-01,-7.9828910357e-01,-7.9921226656e-01,-8.0013354801e-01,-8.0105294575e-01,-8.0197045761e-01,-8.0288608144e-01,-8.0379981507e-01,-8.0471165637e-01,-8.0562160317e-01,-8.0652965334e-01,-8.0743580475e-01,-8.0834005525e-01,-8.0924240272e-01,-8.1014284503e-01,-8.1104138007e-01,-8.1193800572e-01,-8.1283271986e-01,-8.1372552040e-01,-8.1461640523e-01,-8.1550537225e-01,-8.1639241937e-01,-8.1727754450e-01,-8.1816074555e-01,-8.1904202046e-01,-8.1992136714e-01,-8.2079878353e-01,-8.2167426755e-01,-8.2254781715e-01,-8.2341943026e-01,-8.2428910485e-01,-8.2515683886e-01,-8.2602263024e-01,-8.2688647697e-01,-8.2774837700e-01,-8.2860832831e-01,-8.2946632886e-01,-8.3032237666e-01,-8.3117646966e-01,-8.3202860588e-01,-8.3287878329e-01,-8.3372699991e-01,-8.3457325372e-01,-8.3541754275e-01,-8.3625986499e-01,-8.3710021847e-01,-8.3793860122e-01,-8.3877501125e-01,-8.3960944660e-01,-8.4044190530e-01,-8.4127238539e-01,-8.4210088492e-01,-8.4292740194e-01,-8.4375193450e-01,-8.4457448066e-01,-8.4539503849e-01,-8.4621360604e-01,-8.4703018141e-01,-8.4784476265e-01,-8.4865734786e-01,-8.4946793512e-01,-8.5027652253e-01,-8.5108310817e-01,-8.5188769016e-01,-8.5269026659e-01,-8.5349083558e-01,-8.5428939524e-01,-8.5508594370e-01,-8.5588047907e-01,-8.5667299949e-01,-8.5746350309e-01,-8.5825198801e-01,-8.5903845239e-01,-8.5982289439e-01,-8.6060531215e-01,-8.6138570383e-01,-8.6216406761e-01,-8.6294040163e-01,-8.6371470408e-01,-8.6448697313e-01,-8.6525720697e-01,-8.6602540378e-01,-8.6679156176e-01,-8.6755567909e-01,-8.6831775399e-01,-8.6907778465e-01,-8.6983576928e-01,-8.7059170611e-01,-8.7134559336e-01,-8.7209742924e-01,-8.7284721199e-01,-8.7359493984e-01,-8.7434061103e-01,-8.7508422381e-01,-8.7582577643e-01,-8.7656526714e-01,-8.7730269420e-01,-8.7803805587e-01,-8.7877135043e-01,-8.7950257614e-01,-8.8023173128e-01,-8.8095881415e-01,-8.8168382302e-01,-8.8240675618e-01,-8.8312761195e-01,-8.8384638862e-01,-8.8456308449e-01,-8.8527769789e-01,-8.8599022712e-01,-8.8670067052e-01,-8.8740902640e-01,-8.8811529311e-01,-8.8881946897e-01,-8.8952155233e-01,-8.9022154154e-01,-8.9091943495e-01,-8.9161523092e-01,-8.9230892781e-01,-8.9300052398e-01,-8.9369001780e-01,-8.9437740767e-01,-8.9506269194e-01,-8.9574586902e-01,-8.9642693730e-01,-8.9710589516e-01,-8.9778274101e-01,-8.9845747327e-01,-8.9913009033e-01,-8.9980059062e-01,-9.0046897256e-01,-9.0113523458e-01,-9.0179937510e-01,-9.0246139256e-01,-9.0312128540e-01,-9.0377905208e-01,-9.0443469104e-01,-9.0508820073e-01,-9.0573957963e-01,-9.0638882619e-01,-9.0703593889e-01,-9.0768091621e-01,-9.0832375662e-01,-9.0896445861e-01,-9.0960302068e-01,-9.1023944131e-01,-9.1087371902e-01,-9.1150585231e-01,-9.1213583969e-01,-9.1276367968e-01,-9.1338937080e-01,-9.1401291157e-01,-9.1463430053e-01,-9.1525353622e-01,-9.1587061718e-01,-9.1648554195e-01,-9.1709830909e-01,-9.1770891716e-01,-9.1831736471e-01,-9.1892365032e-01,-9.1952777255e-01,-9.2012972999e-01,-9.2072952122e-01,-9.2132714483e-01,-9.2192259940e-01,-9.2251588354e-01,-9.2310699585e-01,-9.2369593494e-01,-9.2428269943e-01,-9.2486728792e-01,-9.2544969905e-01,-9.2602993145e-01,-9.2660798374e-01,-9.2718385457e-01,-9.2775754258e-01,-9.2832904642e-01,-9.2889836474e-01,-9.2946549621e-01,-9.3003043949e-01,-9.3059319325e-01,-9.3115375616e-01,-9.3171212691e-01,-9.3226830418e-01,-9.3282228666e-01,-9.3337407305e-01,-9.3392366204e-01,-9.3447105235e-01,-9.3501624269e-01,-9.3555923176e-01,-9.3610001830e-01,-9.3663860103e-01,-9.3717497868e-01,-9.3770914999e-01,-9.3824111371e-01,-9.3877086857e-01,-9.3929841334e-01,-9.3982374676e-01,-9.4034686761e-01,-9.4086777465e-01,-9.4138646666e-01,-9.4190294241e-01,-9.4241720069e-01,-9.4292924029e-01,-9.4343906001e-01,-9.4394665863e-01,-9.4445203497e-01,-9.4495518784e-01,-9.4545611605e-01,-9.4595481843e-01,-9.4645129379e-01,-9.4694554098e-01,-9.4743755882e-01,-9.4792734617e-01,-9.4841490186e-01,-9.4890022474e-01,-9.4938331368e-01,-9.4986416754e-01,-9.5034278519e-01,-9.5081916550e-01,-9.5129330734e-01,-9.5176520960e-01,-9.5223487118e-01,-9.5270229096e-01,-9.5316746784e-01,-9.5363040074e-01,-9.5409108855e-01,-9.5454953020e-01,-9.5500572460e-01,-9.5545967069e-01,-9.5591136739e-01,-9.5636081364e-01,-9.5680800838e-01,-9.5725295055e-01,-9.5769563912e-01,-9.5813607304e-01,-9.5857425127e-01,-9.5901017278e-01,-9.5944383655e-01,-9.5987524154e-01,-9.6030438676e-01,-9.6073127118e-01,-9.6115589381e-01,-9.6157825363e-01,-9.6199834967e-01,-9.6241618092e-01,-9.6283174641e-01,-9.6324504516e-01,-9.6365607619e-01,-9.6406483854e-01,-9.6447133124e-01,-9.6487555334e-01,-9.6527750389e-01,-9.6567718193e-01,-9.6607458654e-01,-9.6646971676e-01,-9.6686257168e-01,-9.6725315037e-01,-9.6764145190e-01,-9.6802747537e-01,-9.6841121986e-01,-9.6879268448e-01,-9.6917186832e-01,-9.6954877049e-01,-9.6992339010e-01,-9.7029572628e-01,-9.7066577814e-01,-9.7103354481e-01,-9.7139902543e-01,-9.7176221914e-01,-9.7212312509e-01,-9.7248174241e-01,-9.7283807028e-01,-9.7319210784e-01,-9.7354385427e-01,-9.7389330874e-01,-9.7424047043e-01,-9.7458533851e-01,-9.7492791218e-01,-9.7526819063e-01,-9.7560617306e-01,-9.7594185867e-01,-9.7627524668e-01,-9.7660633629e-01,-9.7693512673e-01,-9.7726161722e-01,-9.7758580700e-01,-9.7790769531e-01,-9.7822728138e-01,-9.7854456446e-01,-9.7885954380e-01,-9.7917221867e-01,-9.7948258833e-01,-9.7979065204e-01,-9.8009640909e-01,-9.8039985875e-01,-9.8070100030e-01,-9.8099983305e-01,-9.8129635628e-01,-9.8159056929e-01,-9.8188247140e-01,-9.8217206192e-01,-9.8245934016e-01,-9.8274430546e-01,-9.8302695713e-01,-9.8330729451e-01,-9.8358531695e-01,-9.8386102378e-01,-9.8413441436e-01,-9.8440548805e-01,-9.8467424421e-01,-9.8494068220e-01,-9.8520480140e-01,-9.8546660118e-01,-9.8572608093e-01,-9.8598324004e-01,-9.8623807791e-01,-9.8649059392e-01,-9.8674078750e-01,-9.8698865804e-01,-9.8723420497e-01,-9.8747742771e-01,-9.8771832569e-01,-9.8795689833e-01,-9.8819314508e-01,-9.8842706538e-01,-9.8865865867e-01,-9.8888792443e-01,-9.8911486209e-01,-9.8933947114e-01,-9.8956175104e-01,-9.8978170127e-01,-9.8999932130e-01,-9.9021461064e-01,-9.9042756877e-01,-9.9063819518e-01,-9.9084648939e-01,-9.9105245091e-01,-9.9125607924e-01,-9.9145737391e-01,-9.9165633445e-01,-9.9185296039e-01,-9.9204725125e-01,-9.9223920660e-01,-9.9242882597e-01,-9.9261610892e-01,-9.9280105501e-01,-9.9298366379e-01,-9.9316393486e-01,-9.9334186776e-01,-9.9351746210e-01,-9.9369071745e-01,-9.9386163341e-01,-9.9403020958e-01,-9.9419644555e-01,-9.9436034095e-01,-9.9452189537e-01,-9.9468110844e-01,-9.9483797979e-01,-9.9499250905e-01,-9.9514469584e-01,-9.9529453983e-01,-9.9544204064e-01,-9.9558719794e-01,-9.9573001139e-01,-9.9587048063e-01,-9.9600860536e-01,-9.9614438524e-01,-9.9627781994e-01,-9.9640890917e-01,-9.9653765260e-01,-9.9666404994e-01,-9.9678810088e-01,-9.9690980514e-01,-9.9702916243e-01,-9.9714617247e-01,-9.9726083498e-01,-9.9737314969e-01,-9.9748311634e-01,-9.9759073467e-01,-9.9769600443e-01,-9.9779892537e-01,-9.9789949724e-01,-9.9799771981e-01,-9.9809359284e-01,-9.9818711612e-01,-9.9827828943e-01,-9.9836711253e-01,-9.9845358524e-01,-9.9853770734e-01,-9.9861947864e-01,-9.9869889895e-01,-9.9877596807e-01,-9.9885068582e-01,-9.9892305204e-01,-9.9899306654e-01,-9.9906072917e-01,-9.9912603977e-01,-9.9918899817e-01,-9.9924960424e-01,-9.9930785783e-01,-9.9936375880e-01,-9.9941730703e-01,-9.9946850238e-01,-9.9951734474e-01,-9.9956383399e-01,-9.9960797001e-01,-9.9964975272e-01,-9.9968918200e-01,-9.9972625777e-01,-9.9976097994e-01,-9.9979334842e-01,-9.9982336315e-01,-9.9985102404e-01,-9.9987633104e-01,-9.9989928408e-01,-9.9991988312e-01,-9.9993812810e-01,-9.9995401898e-01,-9.9996755572e-01,-9.9997873829e-01,-9.9998756666e-01,-9.9999404082e-01,-9.9999816075e-01,-9.9999992643e-01,
		-9.9999933787e-01,-9.9999639506e-01,-9.9999109802e-01,-9.9998344675e-01,-9.9997344127e-01,-9.9996108162e-01,-9.9994636780e-01,-9.9992929987e-01,-9.9990987786e-01,-9.9988810181e-01,-9.9986397178e-01,-9.9983748783e-01,-9.9980865001e-01,-9.9977745839e-01,-9.9974391306e-01,-9.9970801408e-01,-9.9966976154e-01,-9.9962915554e-01,-9.9958619616e-01,-9.9954088351e-01,-9.9949321769e-01,-9.9944319882e-01,-9.9939082702e-01,-9.9933610240e-01,-9.9927902510e-01,-9.9921959526e-01,-9.9915781300e-01,-9.9909367848e-01,-9.9902719185e-01,-9.9895835326e-01,-9.9888716288e-01,-9.9881362087e-01,-9.9873772741e-01,-9.9865948268e-01,-9.9857888686e-01,-9.9849594013e-01,-9.9841064270e-01,-9.9832299477e-01,-9.9823299654e-01,-9.9814064822e-01,-9.9804595003e-01,-9.9794890220e-01,-9.9784950495e-01,-9.9774775852e-01,-9.9764366314e-01,-9.9753721906e-01,-9.9742842654e-01,-9.9731728583e-01,-9.9720379718e-01,-9.9708796087e-01,-9.9696977717e-01,-9.9684924636e-01,-9.9672636873e-01,-9.9660114455e-01,-9.9647357412e-01,-9.9634365776e-01,-9.9621139575e-01,-9.9607678842e-01,-9.9593983608e-01,-9.9580053905e-01,-9.9565889767e-01,-9.9551491225e-01,-9.9536858315e-01,-9.9521991071e-01,-9.9506889528e-01,-9.9491553720e-01,-9.9475983685e-01,-9.9460179460e-01,-9.9444141080e-01,-9.9427868585e-01,-9.9411362012e-01,-9.9394621400e-01,-9.9377646788e-01,-9.9360438218e-01,-9.9342995728e-01,-9.9325319361e-01,-9.9307409157e-01,-9.9289265159e-01,-9.9270887410e-01,-9.9252275953e-01,-9.9233430831e-01,-9.9214352090e-01,-9.9195039773e-01,-9.9175493927e-01,-9.9155714598e-01,-9.9135701831e-01,-9.9115455675e-01,-9.9094976177e-01,-9.9074263384e-01,-9.9053317347e-01,-9.9032138114e-01,-9.9010725734e-01,-9.8989080259e-01,-9.8967201739e-01,-9.8945090227e-01,-9.8922745773e-01,-9.8900168430e-01,-9.8877358253e-01,-9.8854315293e-01,-9.8831039607e-01,-9.8807531247e-01,-9.8783790271e-01,-9.8759816733e-01,-9.8735610690e-01,-9.8711172200e-01,-9.8686501319e-01,-9.8661598105e-01,-9.8636462618e-01,-9.8611094917e-01,-9.8585495061e-01,-9.8559663110e-01,-9.8533599125e-01,-9.8507303168e-01,-9.8480775301e-01,-9.8454015586e-01,-9.8427024086e-01,-9.8399800864e-01,-9.8372345985e-01,-9.8344659514e-01,-9.8316741514e-01,-9.8288592054e-01,-9.8260211197e-01,-9.8231599012e-01,-9.8202755565e-01,-9.8173680925e-01,-9.8144375160e-01,-9.8114838339e-01,-9.8085070532e-01,-9.8055071808e-01,-9.8024842239e-01,-9.7994381894e-01,-9.7963690847e-01,-9.7932769170e-01,-9.7901616934e-01,-9.7870234214e-01,-9.7838621084e-01,-9.7806777617e-01,-9.7774703889e-01,-9.7742399975e-01,-9.7709865952e-01,-9.7677101895e-01,-9.7644107883e-01,-9.7610883992e-01,-9.7577430302e-01,-9.7543746890e-01,-9.7509833836e-01,-9.7475691220e-01,-9.7441319122e-01,-9.7406717624e-01,-9.7371886806e-01,-9.7336826750e-01,-9.7301537540e-01,-9.7266019258e-01,-9.7230271988e-01,-9.7194295814e-01,-9.7158090821e-01,-9.7121657093e-01,-9.7084994718e-01,-9.7048103780e-01,-9.7010984367e-01,-9.6973636567e-01,-9.6936060467e-01,-9.6898256155e-01,-9.6860223721e-01,-9.6821963254e-01,-9.6783474845e-01,-9.6744758584e-01,-9.6705814561e-01,-9.6666642869e-01,-9.6627243601e-01,-9.6587616847e-01,-9.6547762703e-01,-9.6507681262e-01,-9.6467372618e-01,-9.6426836866e-01,-9.6386074101e-01,-9.6345084420e-01,-9.6303867919e-01,-9.6262424695e-01,-9.6220754845e-01,-9.6178858469e-01,-9.6136735663e-01,-9.6094386528e-01,-9.6051811163e-01,-9.6009009669e-01,-9.5965982145e-01,-9.5922728695e-01,-9.5879249418e-01,-9.5835544418e-01,-9.5791613798e-01,-9.5747457660e-01,-9.5703076110e-01,-9.5658469251e-01,-9.5613637188e-01,-9.5568580028e-01,-9.5523297875e-01,-9.5477790838e-01,-9.5432059021e-01,-9.5386102535e-01,-9.5339921486e-01,-9.5293515983e-01,-9.5246886136e-01,-9.5200032055e-01,-9.5152953849e-01,-9.5105651630e-01,-9.5058125508e-01,-9.5010375596e-01,-9.4962402007e-01,-9.4914204853e-01,-9.4865784247e-01,-9.4817140304e-01,-9.4768273138e-01,-9.4719182864e-01,-9.4669869598e-01,-9.4620333456e-01,-9.4570574554e-01,-9.4520593010e-01,-9.4470388941e-01,-9.4419962466e-01,-9.4369313703e-01,-9.4318442771e-01,-9.4267349790e-01,-9.4216034881e-01,-9.4164498165e-01,-9.4112739761e-01,-9.4060759794e-01,-9.4008558384e-01,-9.3956135654e-01,-9.3903491729e-01,-9.3850626732e-01,-9.3797540788e-01,-9.3744234021e-01,-9.3690706557e-01,-9.3636958522e-01,-9.3582990043e-01,-9.3528801246e-01,-9.3474392260e-01,-9.3419763211e-01,-9.3364914230e-01,-9.3309845445e-01,-9.3254556985e-01,-9.3199048981e-01,-9.3143321564e-01,-9.3087374864e-01,-9.3031209014e-01,-9.2974824146e-01,-9.2918220392e-01,-9.2861397885e-01,-9.2804356760e-01,-9.2747097151e-01,-9.2689619192e-01,-9.2631923019e-01,-9.2574008768e-01,-9.2515876574e-01,-9.2457526576e-01,-9.2398958910e-01,-9.2340173714e-01,-9.2281171126e-01,-9.2221951286e-01,-9.2162514333e-01,-9.2102860406e-01,-9.2042989647e-01,-9.1982902196e-01,-9.1922598194e-01,-9.1862077785e-01,-9.1801341109e-01,-9.1740388310e-01,-9.1679219532e-01,-9.1617834918e-01,-9.1556234613e-01,-9.1494418763e-01,-9.1432387512e-01,-9.1370141007e-01,-9.1307679394e-01,-9.1245002820e-01,-9.1182111433e-01,-9.1119005381e-01,-9.1055684813e-01,-9.0992149877e-01,-9.0928400723e-01,-9.0864437501e-01,-9.0800260362e-01,-9.0735869457e-01,-9.0671264937e-01,-9.0606446955e-01,-9.0541415663e-01,-9.0476171214e-01,-9.0410713762e-01,-9.0345043461e-01,-9.0279160466e-01,-9.0213064931e-01,-9.0146757012e-01,-9.0080236866e-01,-9.0013504649e-01,-8.9946560517e-01,-8.9879404630e-01,-8.9812037144e-01,-8.9744458219e-01,-8.9676668013e-01,-8.9608666686e-01,-8.9540454398e-01,-8.9472031310e-01,-8.9403397583e-01,-8.9334553379e-01,-8.9265498858e-01,-8.9196234185e-01,-8.9126759522e-01,-8.9057075033e-01,-8.8987180881e-01,-8.8917077232e-01,-8.8846764250e-01,-8.8776242101e-01,-8.8705510950e-01,-8.8634570966e-01,-8.8563422313e-01,-8.8492065161e-01,-8.8420499676e-01,-8.8348726028e-01,-8.8276744385e-01,-8.8204554917e-01,-8.8132157794e-01,-8.8059553186e-01,-8.7986741264e-01,-8.7913722200e-01,-8.7840496165e-01,-8.7767063332e-01,-8.7693423874e-01,-8.7619577963e-01,-8.7545525775e-01,-8.7471267483e-01,-8.7396803263e-01,-8.7322133288e-01,-8.7247257736e-01,-8.7172176783e-01,-8.7096890604e-01,-8.7021399378e-01,-8.6945703283e-01,-8.6869802496e-01,-8.6793697196e-01,-8.6717387562e-01,-8.6640873774e-01,-8.6564156012e-01,-8.6487234457e-01,-8.6410109290e-01,-8.6332780692e-01,-8.6255248845e-01,-8.6177513932e-01,-8.6099576137e-01,-8.6021435641e-01,-8.5943092630e-01,-8.5864547288e-01,-8.5785799800e-01,-8.5706850351e-01,-8.5627699126e-01,-8.5548346313e-01,-8.5468792099e-01,-8.5389036669e-01,-8.5309080213e-01,-8.5228922919e-01,-8.5148564974e-01,-8.5068006569e-01,-8.4987247893e-01,-8.4906289135e-01,-8.4825130488e-01,-8.4743772141e-01,-8.4662214287e-01,-8.4580457117e-01,-8.4498500824e-01,-8.4416345600e-01,-8.4333991640e-01,-8.4251439137e-01,-8.4168688285e-01,-8.4085739279e-01,-8.4002592315e-01,-8.3919247588e-01,-8.3835705295e-01,-8.3751965631e-01,-8.3668028795e-01,-8.3583894984e-01,-8.3499564396e-01,-8.3415037229e-01,-8.3330313683e-01,-8.3245393956e-01,-8.3160278250e-01,-8.3074966763e-01,-8.2989459698e-01,-8.2903757256e-01,-8.2817859637e-01,-8.2731767045e-01,-8.2645479682e-01,-8.2558997751e-01,-8.2472321455e-01,-8.2385451000e-01,-8.2298386589e-01,-8.2211128428e-01,-8.2123676721e-01,-8.2036031675e-01,-8.1948193496e-01,-8.1860162391e-01,-8.1771938566e-01,-8.1683522231e-01,-8.1594913592e-01,-8.1506112859e-01,-8.1417120241e-01,-8.1327935946e-01,-8.1238560186e-01,-8.1148993170e-01,-8.1059235109e-01,-8.0969286215e-01,-8.0879146699e-01,-8.0788816774e-01,-8.0698296652e-01,-8.0607586547e-01,-8.0516686671e-01,-8.0425597240e-01,-8.0334318467e-01,-8.0242850566e-01,-8.0151193755e-01,-8.0059348248e-01,-7.9967314261e-01,-7.9875092012e-01,-7.9782681717e-01,-7.9690083595e-01,-7.9597297862e-01,-7.9504324737e-01,-7.9411164440e-01,-7.9317817189e-01,-7.9224283205e-01,-7.9130562707e-01,-7.9036655916e-01,-7.8942563054e-01,-7.8848284341e-01,-7.8753820001e-01,-7.8659170254e-01,-7.8564335324e-01,-7.8469315435e-01,-7.8374110809e-01,-7.8278721672e-01,-7.8183148247e-01,-7.8087390760e-01,-7.7991449435e-01,-7.7895324500e-01,-7.7799016180e-01,-7.7702524702e-01,-7.7605850293e-01,-7.7508993181e-01,-7.7411953594e-01,-7.7314731760e-01,-7.7217327908e-01,-7.7119742267e-01,-7.7021975068e-01,-7.6924026540e-01,-7.6825896913e-01,-7.6727586420e-01,-7.6629095291e-01,-7.6530423759e-01,-7.6431572055e-01,-7.6332540412e-01,-7.6233329063e-01,-7.6133938243e-01,-7.6034368185e-01,-7.5934619123e-01,-7.5834691292e-01,-7.5734584928e-01,-7.5634300265e-01,-7.5533837542e-01,-7.5433196992e-01,-7.5332378855e-01,-7.5231383367e-01,-7.5130210765e-01,-7.5028861289e-01,-7.4927335176e-01,-7.4825632665e-01,-7.4723753997e-01,-7.4621699411e-01,-7.4519469147e-01,-7.4417063445e-01,-7.4314482548e-01,-7.4211726696e-01,-7.4108796131e-01,-7.4005691096e-01,-7.3902411833e-01,-7.3798958586e-01,-7.3695331598e-01,-7.3591531114e-01,-7.3487557376e-01,-7.3383410631e-01,-7.3279091123e-01,-7.3174599098e-01,-7.3069934802e-01,-7.2965098482e-01,-7.2860090383e-01,-7.2754910755e-01,-7.2649559843e-01,-7.2544037896e-01,-7.2438345163e-01,-7.2332481892e-01,-7.2226448333e-01,-7.2120244734e-01,-7.2013871347e-01,-7.1907328422e-01,-7.1800616209e-01,-7.1693734960e-01,-7.1586684926e-01,-7.1479466359e-01,-7.1372079513e-01,-7.1264524638e-01,-7.1156801990e-01,-7.1048911821e-01,-7.0940854385e-01,-7.0832629937e-01,-7.0724238732e-01,
		-7.0615681024e-01,-7.0506957070e-01,-7.0398067125e-01,-7.0289011445e-01,-7.0179790288e-01,-7.0070403911e-01,-6.9960852570e-01,-6.9851136525e-01,-6.9741256033e-01,-6.9631211352e-01,-6.9521002743e-01,-6.9410630464e-01,-6.9300094775e-01,-6.9189395937e-01,-6.9078534210e-01,-6.8967509856e-01,-6.8856323134e-01,-6.8744974308e-01,-6.8633463640e-01,-6.8521791391e-01,-6.8409957825e-01,-6.8297963206e-01,-6.8185807796e-01,-6.8073491860e-01,-6.7961015662e-01,-6.7848379467e-01,-6.7735583541e-01,-6.7622628148e-01,-6.7509513555e-01,-6.7396240028e-01,-6.7282807834e-01,-6.7169217239e-01,-6.7055468512e-01,-6.6941561919e-01,-6.6827497730e-01,-6.6713276212e-01,-6.6598897634e-01,-6.6484362267e-01,-6.6369670379e-01,-6.6254822240e-01,-6.6139818122e-01,-6.6024658294e-01,-6.5909343027e-01,-6.5793872594e-01,-6.5678247266e-01,-6.5562467315e-01,-6.5446533014e-01,-6.5330444635e-01,-6.5214202453e-01,-6.5097806741e-01,-6.4981257772e-01,-6.4864555821e-01,-6.4747701163e-01,-6.4630694074e-01,-6.4513534827e-01,-6.4396223700e-01,-6.4278760969e-01,-6.4161146909e-01,-6.4043381798e-01,-6.3925465914e-01,-6.3807399533e-01,-6.3689182933e-01,-6.3570816394e-01,-6.3452300194e-01,-6.3333634611e-01,-6.3214819925e-01,-6.3095856416e-01,-6.2976744364e-01,-6.2857484049e-01,-6.2738075752e-01,-6.2618519754e-01,-6.2498816337e-01,-6.2378965782e-01,-6.2258968372e-01,-6.2138824388e-01,-6.2018534115e-01,-6.1898097835e-01,-6.1777515831e-01,-6.1656788388e-01,-6.1535915790e-01,-6.1414898321e-01,-6.1293736267e-01,-6.1172429912e-01,-6.1050979541e-01,-6.0929385442e-01,-6.0807647900e-01,-6.0685767202e-01,-6.0563743635e-01,-6.0441577486e-01,-6.0319269042e-01,-6.0196818592e-01,-6.0074226424e-01,-5.9951492826e-01,-5.9828618088e-01,-5.9705602498e-01,-5.9582446347e-01,-5.9459149924e-01,-5.9335713520e-01,-5.9212137425e-01,-5.9088421930e-01,-5.8964567326e-01,-5.8840573905e-01,-5.8716441959e-01,-5.8592171780e-01,-5.8467763660e-01,-5.8343217893e-01,-5.8218534772e-01,-5.8093714590e-01,-5.7968757641e-01,-5.7843664220e-01,-5.7718434620e-01,-5.7593069137e-01,-5.7467568065e-01,-5.7341931701e-01,-5.7216160340e-01,-5.7090254277e-01,-5.6964213811e-01,-5.6838039236e-01,-5.6711730851e-01,-5.6585288953e-01,-5.6458713838e-01,-5.6332005806e-01,-5.6205165155e-01,-5.6078192183e-01,-5.5951087189e-01,-5.5823850472e-01,-5.5696482333e-01,-5.5568983070e-01,-5.5441352984e-01,-5.5313592375e-01,-5.5185701545e-01,-5.5057680794e-01,-5.4929530423e-01,-5.4801250735e-01,-5.4672842032e-01,-5.4544304615e-01,-5.4415638787e-01,-5.4286844852e-01,-5.4157923112e-01,-5.4028873871e-01,-5.3899697432e-01,-5.3770394101e-01,-5.3640964180e-01,-5.3511407976e-01,-5.3381725793e-01,-5.3251917936e-01,-5.3121984711e-01,-5.2991926423e-01,-5.2861743380e-01,-5.2731435887e-01,-5.2601004251e-01,-5.2470448780e-01,-5.2339769780e-01,-5.2208967560e-01,-5.2078042427e-01,-5.1946994689e-01,-5.1815824655e-01,-5.1684532634e-01,-5.1553118935e-01,-5.1421583867e-01,-5.1289927741e-01,-5.1158150865e-01,-5.1026253550e-01,-5.0894236107e-01,-5.0762098846e-01,-5.0629842079e-01,-5.0497466117e-01,-5.0364971271e-01,-5.0232357854e-01,-5.0099626177e-01,-4.9966776554e-01,-4.9833809296e-01,-4.9700724718e-01,-4.9567523131e-01,-4.9434204851e-01,-4.9300770190e-01,-4.9167219463e-01,-4.9033552985e-01,-4.8899771069e-01,-4.8765874032e-01,-4.8631862187e-01,-4.8497735851e-01,-4.8363495340e-01,-4.8229140968e-01,-4.8094673054e-01,-4.7960091913e-01,-4.7825397862e-01,-4.7690591218e-01,-4.7555672299e-01,-4.7420641423e-01,-4.7285498906e-01,-4.7150245068e-01,-4.7014880226e-01,-4.6879404700e-01,-4.6743818808e-01,-4.6608122870e-01,-4.6472317204e-01,-4.6336402132e-01,-4.6200377972e-01,-4.6064245045e-01,-4.5928003672e-01,-4.5791654172e-01,-4.5655196868e-01,-4.5518632081e-01,-4.5381960131e-01,-4.5245181341e-01,-4.5108296032e-01,-4.4971304528e-01,-4.4834207150e-01,-4.4697004222e-01,-4.4559696065e-01,-4.4422283005e-01,-4.4284765363e-01,-4.4147143464e-01,-4.4009417631e-01,-4.3871588190e-01,-4.3733655464e-01,-4.3595619779e-01,-4.3457481458e-01,-4.3319240828e-01,-4.3180898214e-01,-4.3042453942e-01,-4.2903908337e-01,-4.2765261725e-01,-4.2626514434e-01,-4.2487666789e-01,-4.2348719118e-01,-4.2209671747e-01,-4.2070525005e-01,-4.1931279218e-01,-4.1791934715e-01,-4.1652491823e-01,-4.1512950871e-01,-4.1373312188e-01,-4.1233576101e-01,-4.1093742940e-01,-4.0953813035e-01,-4.0813786714e-01,-4.0673664308e-01,-4.0533446145e-01,-4.0393132557e-01,-4.0252723874e-01,-4.0112220426e-01,-3.9971622544e-01,-3.9830930558e-01,-3.9690144801e-01,-3.9549265604e-01,-3.9408293298e-01,-3.9267228215e-01,-3.9126070687e-01,-3.8984821047e-01,-3.8843479627e-01,-3.8702046760e-01,-3.8560522779e-01,-3.8418908017e-01,-3.8277202808e-01,-3.8135407484e-01,-3.7993522380e-01,-3.7851547831e-01,-3.7709484169e-01,-3.7567331730e-01,-3.7425090848e-01,-3.7282761858e-01,-3.7140345096e-01,-3.6997840896e-01,-3.6855249594e-01,-3.6712571525e-01,-3.6569807027e-01,-3.6426956434e-01,-3.6284020083e-01,-3.6140998310e-01,-3.5997891453e-01,-3.5854699847e-01,-3.5711423831e-01,-3.5568063742e-01,-3.5424619916e-01,-3.5281092692e-01,-3.5137482408e-01,-3.4993789402e-01,-3.4850014011e-01,-3.4706156575e-01,-3.4562217433e-01,-3.4418196922e-01,-3.4274095382e-01,-3.4129913153e-01,-3.3985650573e-01,-3.3841307983e-01,-3.3696885723e-01,-3.3552384131e-01,-3.3407803549e-01,-3.3263144316e-01,-3.3118406774e-01,-3.2973591264e-01,-3.2828698125e-01,-3.2683727699e-01,-3.2538680328e-01,-3.2393556353e-01,-3.2248356115e-01,-3.2103079957e-01,-3.1957728220e-01,-3.1812301247e-01,-3.1666799380e-01,-3.1521222962e-01,-3.1375572334e-01,-3.1229847841e-01,-3.1084049826e-01,-3.0938178630e-01,-3.0792234599e-01,-3.0646218075e-01,-3.0500129403e-01,-3.0353968925e-01,-3.0207736987e-01,-3.0061433933e-01,-2.9915060106e-01,-2.9768615852e-01,-2.9622101515e-01,-2.9475517441e-01,-2.9328863974e-01,-2.9182141460e-01,-2.9035350244e-01,-2.8888490671e-01,-2.8741563088e-01,-2.8594567840e-01,-2.8447505273e-01,-2.8300375734e-01,-2.8153179569e-01,-2.8005917125e-01,-2.7858588747e-01,-2.7711194784e-01,-2.7563735582e-01,-2.7416211488e-01,-2.7268622849e-01,-2.7120970013e-01,-2.6973253328e-01,-2.6825473141e-01,-2.6677629801e-01,-2.6529723655e-01,-2.6381755051e-01,-2.6233724338e-01,-2.6085631864e-01,-2.5937477979e-01,-2.5789263030e-01,-2.5640987367e-01,-2.5492651339e-01,-2.5344255295e-01,-2.5195799584e-01,-2.5047284556e-01,-2.4898710561e-01,-2.4750077948e-01,-2.4601387067e-01,-2.4452638269e-01,-2.4303831902e-01,-2.4154968319e-01,-2.4006047869e-01,-2.3857070903e-01,-2.3708037772e-01,-2.3558948825e-01,-2.3409804416e-01,-2.3260604894e-01,-2.3111350610e-01,-2.2962041917e-01,-2.2812679166e-01,-2.2663262708e-01,-2.2513792895e-01,-2.2364270079e-01,-2.2214694612e-01,-2.2065066846e-01,-2.1915387134e-01,-2.1765655827e-01,-2.1615873279e-01,-2.1466039842e-01,-2.1316155868e-01,-2.1166221711e-01,-2.1016237723e-01,-2.0866204258e-01,-2.0716121669e-01,-2.0565990309e-01,-2.0415810531e-01,-2.0265582690e-01,-2.0115307138e-01,-1.9964984230e-01,-1.9814614320e-01,-1.9664197761e-01,-1.9513734908e-01,-1.9363226115e-01,-1.9212671735e-01,-1.9062072125e-01,-1.8911427638e-01,-1.8760738628e-01,-1.8610005451e-01,-1.8459228462e-01,-1.8308408015e-01,-1.8157544465e-01,-1.8006638169e-01,-1.7855689480e-01,-1.7704698754e-01,-1.7553666348e-01,-1.7402592615e-01,-1.7251477913e-01,-1.7100322596e-01,-1.6949127021e-01,-1.6797891544e-01,-1.6646616520e-01,-1.6495302306e-01,-1.6343949258e-01,-1.6192557733e-01,-1.6041128086e-01,-1.5889660674e-01,-1.5738155854e-01,-1.5586613983e-01,-1.5435035417e-01,-1.5283420513e-01,-1.5131769628e-01,-1.4980083119e-01,-1.4828361344e-01,-1.4676604659e-01,-1.4524813421e-01,-1.4372987989e-01,-1.4221128719e-01,-1.4069235969e-01,-1.3917310096e-01,-1.3765351459e-01,-1.3613360414e-01,-1.3461337321e-01,-1.3309282536e-01,-1.3157196418e-01,-1.3005079325e-01,-1.2852931614e-01,-1.2700753644e-01,-1.2548545774e-01,-1.2396308362e-01,-1.2244041765e-01,-1.2091746343e-01,-1.1939422454e-01,-1.1787070457e-01,-1.1634690710e-01,-1.1482283572e-01,-1.1329849402e-01,-1.1177388558e-01,-1.1024901401e-01,-1.0872388288e-01,-1.0719849579e-01,-1.0567285632e-01,-1.0414696808e-01,-1.0262083465e-01,-1.0109445962e-01,-9.9567846596e-02,-9.8040999161e-02,-9.6513920915e-02,-9.4986615450e-02,-9.3459086364e-02,-9.1931337252e-02,-9.0403371711e-02,-8.8875193338e-02,-8.7346805731e-02,-8.5818212488e-02,-8.4289417208e-02,-8.2760423491e-02,-8.1231234934e-02,-7.9701855140e-02,-7.8172287707e-02,-7.6642536238e-02,-7.5112604334e-02,-7.3582495595e-02,-7.2052213626e-02,-7.0521762028e-02,-6.8991144404e-02,-6.7460364359e-02,-6.5929425495e-02,-6.4398331416e-02,-6.2867085729e-02,-6.1335692037e-02,-5.9804153945e-02,-5.8272475060e-02,-5.6740658987e-02,-5.5208709332e-02,-5.3676629703e-02,-5.2144423706e-02,-5.0612094948e-02,-4.9079647036e-02,-4.7547083579e-02,-4.6014408185e-02,-4.4481624461e-02,-4.2948736017e-02,-4.1415746460e-02,-3.9882659401e-02,-3.8349478448e-02,-3.6816207211e-02,-3.5282849300e-02,-3.3749408324e-02,-3.2215887894e-02,-3.0682291620e-02,-2.9148623112e-02,-2.7614885981e-02,-2.6081083838e-02,-2.4547220293e-02,-2.3013298958e-02,-2.1479323445e-02,-1.9945297363e-02,-1.8411224326e-02,-1.6877107944e-02,-1.5342951829e-02,-1.3808759593e-02,-1.2274534848e-02,-1.0740281205e-02,-9.2060022777e-03,-7.6717016768e-03,-6.1373830149e-03,-4.6030499040e-03,-3.0687059564e-03,-1.5343547843e-03,-2.4492935983e-16,
};

const float d_square_table[] = { //128 entries
		0.0, -0.03534475, -0.0581243 , -0.07090385, -0.08747734,
		-0.10924251, -0.12566624, -0.16727466, -0.23184635, -0.31758417,
		-0.37985953, -0.46469878, -0.55283277, -0.67571116, -0.86528285,
		-0.98671356, -0.97505721, -0.96100469, -0.94495537, -0.93210094,
		-0.91924651, -0.90639207, -0.88879523, -0.87429343, -0.85684635,
		-0.85177945, -0.84406679, -0.83448213, -0.82489747, -0.81314127,
		-0.80028684, -0.7897537 , -0.77697414, -0.76419459, -0.752064  ,
		-0.74502526, -0.74183037, -0.7354406 , -0.73224571, -0.72905082,
		-0.72585593, -0.72585593, -0.72585593, -0.72585593, -0.72915066,
		-0.73863548, -0.74527486, -0.75493441, -0.76419459, -0.76738948,
		-0.77058437, -0.77697414, -0.78016903, -0.7897537 , -0.80338189,
		-0.82170258, -0.83548053, -0.85791963, -0.8867485 , -0.90599271,
		-0.91884715, -0.94128624, -0.50346176, -0.39540965, -0.18272494,
		-0.00655681,  0.1675646 ,  0.26044099,  0.38496675,  0.9131217 ,
		0.90149031,  0.856687  ,  0.8342479 ,  0.81500369,  0.79895437,
		0.7789364 ,  0.75727107,  0.73483197,  0.71503864,  0.70225908,
		0.68348912,  0.67350509,  0.66072554,  0.65114087,  0.64155621,
		0.63519139,  0.63197154,  0.62558177,  0.62558177,  0.62558177,
		0.62558177,  0.62558177,  0.62558177,  0.62615585,  0.63197154,
		0.63836132,  0.64235493,  0.65433576,  0.66392043,  0.67452845,
		0.68308976,  0.69384754,  0.70864886,  0.71955641,  0.73241084,
		0.74526527,  0.75811971,  0.76935174,  0.7789364 ,  0.79171595,
		0.79810573,  0.80769039,  0.81607698,  0.83005461,  0.83963928,
		0.85241883,  0.85880861,  0.86839327,  0.87478305,  0.89008357,
		0.89654822,  0.90992682,  0.9103761 ,  0.82121875,  0.73310972,
		0.64520038,  0.26825349,  0.1306856
};

const float d_saw_table[] = { //128 entries
				0.        ,  0.01709453,  0.03358925,  0.04798464,  0.06357965,
		        0.0815739 ,  0.09776871,  0.11486324,  0.12955854,  0.14425384,
		        0.16134837,  0.17754319,  0.19193858,  0.20783349,  0.22492802,
		        0.23992322,  0.25431862,  0.27351248,  0.28790787,  0.30560221,
		        0.32149712,  0.33589251,  0.35208733,  0.36918186,  0.38387716,
		        0.39857246,  0.41566699,  0.4318618 ,  0.4462572 ,  0.46215211,
		        0.47984645,  0.49424184,  0.5134357 ,  0.52783109,  0.5428263 ,
		        0.55992083,  0.57581574,  0.59021113,  0.60640595,  0.62350048,
		        0.63819578,  0.65289107,  0.6699856 ,  0.68618042,  0.70417466,
		        0.71976967,  0.73416507,  0.75065979,  0.76775432,  0.78214971,
		        0.79714491,  0.81423944,  0.83013436,  0.84452975,  0.86072457,
		        0.878119  ,  0.8925144 ,  0.91170825,  0.92910269,  0.93090211,
		        0.92610365,  0.9006118 ,  0.8409309 ,  0.74616123,  0.49424184,
		        0.27711132,  0.09476967, -0.06118042, -0.17634357, -0.29960413,
		       -0.44385797, -0.55602207, -0.63099808, -0.65259117, -0.64779271,
		       -0.64209453, -0.62380038, -0.61420345, -0.60040787, -0.59021113,
		       -0.57581574, -0.56621881, -0.55182342, -0.54222649, -0.52783109,
		       -0.51823417, -0.50683781, -0.49424184, -0.48224568, -0.47024952,
		       -0.45765355, -0.4462572 , -0.43306142, -0.42226488, -0.40846929,
		       -0.39827255, -0.38387716, -0.37428023, -0.35988484, -0.35028791,
		       -0.33949136, -0.32629559, -0.31489923, -0.30230326, -0.2903071 ,
		       -0.27831094, -0.26571497, -0.25431862, -0.24112284, -0.2303263 ,
		       -0.21653071, -0.20633397, -0.19193858, -0.18234165, -0.17214491,
		       -0.15834933, -0.14755278, -0.13435701, -0.12296065, -0.11036468,
		       -0.09836852, -0.08637236, -0.07377639, -0.06238004, -0.04918426,
		       -0.03838772, -0.02459213, -0.01439539
};
			//was kOcto
const float d_sn3_table[] = { //128
		0.        ,  0.00332779,  0.00665557,  0.00665557,  0.10368136,
		        0.13175957,  0.15640599,  0.16641535,  0.17450083,  0.1797005 ,
		        0.18635607,  0.18635607,  0.18635607,  0.18635607,  0.18635607,
		        0.18635607,  0.19758735,  0.29560108,  0.41420549,  0.53631968,
		        0.63394343,  0.7124584 ,  0.78171797,  0.86777246,  0.88623128,
		        0.8985025 ,  0.90573003,  0.91181364,  0.91514143,  0.91360753,
		        0.90848586,  0.90183028,  0.89517471,  0.88792117,  0.86782446,
		        0.84447795,  0.79263727,  0.73013727,  0.68682404,  0.62884775,
		        0.5765391 ,  0.50298981,  0.4514871 ,  0.374922  ,  0.30646839,
		        0.21074251,  0.21552621,  0.22628952,  0.22628952,  0.22628952,
		        0.22628952,  0.22628952,  0.22296173,  0.22296173,  0.21630616,
		        0.21297837,  0.20278702,  0.19301165,  0.18661606,  0.17520279,
		        0.15120632,  0.12294613,  0.09130616,  0.0389975 , -0.00332779,
		       -0.00665557, -0.00665557, -0.00665557, -0.08527454, -0.13859713,
		       -0.16332155, -0.17304493, -0.1797005 , -0.18635607, -0.18635607,
		       -0.18635607, -0.18635607, -0.18635607, -0.18302829, -0.17988249,
		       -0.18094842, -0.29170133, -0.41675333, -0.51892679, -0.60420133,
		       -0.69724938, -0.78759359, -0.8703203 , -0.89392679, -0.90596402,
		       -0.91181364, -0.91480345, -0.90848586, -0.90196027, -0.89387479,
		       -0.8797317 , -0.84109817, -0.79747296, -0.74173253, -0.67860857,
		       -0.63914309, -0.57906094, -0.51029534, -0.44420757, -0.37479201,
		       -0.31535982, -0.21932196, -0.19966722, -0.19966722, -0.2124324 ,
		       -0.22384567, -0.22628952, -0.22628952, -0.22628952, -0.22296173,
		       -0.22296173, -0.21630616, -0.20965058, -0.20065516, -0.19301165,
		       -0.18302829, -0.15978577, -0.12889975, -0.10131552, -0.04003744,
		       -0.01331115, -0.00665557, -0.00332779
};

const float saw_table[] = {
		-0.75, -0.7381889763779528, -0.7263779527559056, -0.7145669291338582, -0.702755905511811, -0.6909448818897638, -0.6791338582677166, -0.6673228346456693, -0.655511811023622, -0.6437007874015748, -0.6318897637795275, -0.6200787401574803, -0.6082677165354331, -0.5964566929133859, -0.5846456692913387, -0.5728346456692913, -0.5610236220472441, -0.5492125984251969, -0.5374015748031495, -0.5255905511811023, -0.5137795275590551, -0.5019685039370079, -0.49015748031496065, -0.47834645669291337, -0.46653543307086615, -0.4547244094488189, -0.44291338582677164, -0.4311023622047244, -0.4192913385826772, -0.4074803149606299, -0.3956692913385827, -0.3838582677165354, -0.3720472440944882, -0.36023622047244097, -0.3484251968503937, -0.33661417322834647, -0.3248031496062992, -0.31299212598425197, -0.30118110236220474, -0.28937007874015747,
		-0.27755905511811024, -0.265748031496063, -0.25393700787401574, -0.24212598425196852, -0.2303149606299213, -0.21850393700787407, -0.20669291338582674, -0.19488188976377951, -0.1830708661417323, -0.17125984251968507, -0.15944881889763785, -0.1476377952755905, -0.1358267716535433, -0.12401574803149606, -0.11220472440944884, -0.10039370078740162, -0.0885826771653544, -0.07677165354330706, -0.06496062992125984, -0.053149606299212615, -0.04133858267716539, -0.02952755905511817, -0.017716535433070835, -0.0059055118110236116, 0.0059055118110236116, 0.017716535433070835, 0.029527559055118058, 0.04133858267716539, 0.053149606299212615, 0.06496062992125984, 0.07677165354330706, 0.08858267716535428, 0.10039370078740162, 0.11220472440944884, 0.12401574803149606, 0.1358267716535433, 0.1476377952755905, 0.15944881889763773, 0.17125984251968507, 0.1830708661417323,
		0.19488188976377951, 0.20669291338582674, 0.21850393700787396, 0.2303149606299213, 0.24212598425196852, 0.25393700787401574, 0.26574803149606296, 0.2775590551181102, 0.2893700787401574, 0.30118110236220463, 0.31299212598425186, 0.3248031496062993, 0.3366141732283465, 0.34842519685039375, 0.36023622047244097, 0.3720472440944882, 0.3838582677165354, 0.39566929133858264, 0.40748031496062986, 0.4192913385826771, 0.4311023622047243, 0.44291338582677153, 0.454724409448819, 0.4665354330708662, 0.4783464566929134, 0.49015748031496065, 0.5019685039370079, 0.5137795275590551, 0.5255905511811023, 0.5374015748031495, 0.5492125984251968, 0.561023622047244, 0.5728346456692912, 0.5846456692913387, 0.5964566929133859, 0.6082677165354331, 0.6200787401574803, 0.6318897637795275, 0.6437007874015748, 0.655511811023622,
		0.6673228346456692, 0.6791338582677164, 0.6909448818897637, 0.7027559055118111, 0.7145669291338583, 0.7263779527559056, 0.7381889763779528, 0.75,
};

const float square_table[] = {
		0.8, 0.8, 0.8, 0.8, 0.8, 0.8, 0.8, 0.8, 0.8, 0.8, 0.8, 0.8, 0.8, 0.8, 0.8, 0.8, 0.8, 0.8, 0.8, 0.8, 0.8, 0.8, 0.8, 0.8, 0.8, 0.8, 0.8, 0.8, 0.8, 0.8, 0.8, 0.8,
		0.8, 0.8, 0.8, 0.8, 0.8, 0.8, 0.8, 0.8, 0.8, 0.8, 0.8, 0.8, 0.8, 0.8, 0.8, 0.8, 0.8, 0.8, 0.8, 0.8, 0.8, 0.8, 0.8, 0.8, 0.8, 0.8, 0.8, 0.8, 0.8, 0.8, 0.8, 0.8,
		-0.8, -0.8, -0.8, -0.8, -0.8, -0.8, -0.8, -0.8, -0.8, -0.8, -0.8, -0.8, -0.8, -0.8, -0.8, -0.8, -0.8, -0.8, -0.8, -0.8, -0.8, -0.8, -0.8, -0.8, -0.8, -0.8, -0.8, -0.8, -0.8, -0.8, -0.8, -0.8,
		-0.8, -0.8, -0.8, -0.8, -0.8, -0.8, -0.8, -0.8, -0.8, -0.8, -0.8, -0.8, -0.8, -0.8, -0.8, -0.8, -0.8, -0.8, -0.8, -0.8, -0.8, -0.8, -0.8, -0.8, -0.8, -0.8, -0.8, -0.8, -0.8, -0.8, -0.8, -0.8,
};

const float tri_table[] = {
		0.0, 0.0265625, 0.053125, 0.0796875, 0.10625, 0.1328125, 0.159375, 0.1859375, 0.2125, 0.23906249999999998, 0.265625, 0.2921875, 0.31875, 0.34531249999999997, 0.371875, 0.3984375, 0.425, 0.4515625, 0.47812499999999997, 0.5046875,
		0.53125, 0.5578124999999999, 0.584375, 0.6109375, 0.6375, 0.6640625, 0.6906249999999999, 0.7171875, 0.74375, 0.7703125, 0.796875, 0.8234374999999999, 0.85, 0.8242424242424242, 0.7984848484848485, 0.7727272727272727, 0.746969696969697, 0.7212121212121212, 0.6954545454545454, 0.6696969696969697,
		0.6439393939393939, 0.6181818181818182, 0.5924242424242424, 0.5666666666666667, 0.5409090909090909, 0.5151515151515151, 0.4893939393939394, 0.4636363636363636, 0.43787878787878787, 0.4121212121212121, 0.38636363636363635, 0.3606060606060606, 0.33484848484848484, 0.3090909090909091, 0.2833333333333333, 0.25757575757575757, 0.2318181818181818, 0.20606060606060606, 0.1803030303030303, 0.15454545454545454,
		0.12878787878787878, 0.10303030303030303, 0.07727272727272727, 0.051515151515151514, 0.025757575757575757, -0.0265625, -0.053125, -0.0796875, -0.10625, -0.1328125, -0.159375, -0.1859375, -0.2125, -0.23906249999999998, -0.265625, -0.2921875, -0.31875, -0.34531249999999997, -0.371875, -0.3984375,
		-0.425, -0.4515625, -0.47812499999999997, -0.5046875, -0.53125, -0.5578124999999999, -0.584375, -0.6109375, -0.6375, -0.6640625, -0.6906249999999999, -0.7171875, -0.74375, -0.7703125, -0.796875, -0.8234374999999999, -0.85, -0.8242424242424242, -0.7984848484848485, -0.7727272727272727,
		-0.746969696969697, -0.7212121212121212, -0.6954545454545454, -0.6696969696969697, -0.6439393939393939, -0.6181818181818182, -0.5924242424242424, -0.5666666666666667, -0.5409090909090909, -0.5151515151515151, -0.4893939393939394, -0.4636363636363636, -0.43787878787878787, -0.4121212121212121, -0.38636363636363635, -0.3606060606060606, -0.33484848484848484, -0.3090909090909091, -0.2833333333333333, -0.25757575757575757,
		-0.2318181818181818, -0.20606060606060606, -0.1803030303030303, -0.15454545454545454, -0.12878787878787878, -0.10303030303030303, -0.07727272727272727, -0.051515151515151514,
};

const float sn3_table[] = { //Hammond with first three drawbars (f, 2f, 3f)
		0.0, 0.07345382227808508, 0.14584803490003778, 0.21614256128502654, 0.28333599685020505, 0.34648396789407, 0.4047163409092004, 0.4572529368890344, 0.503417436515731, 0.5426491999968908, 0.5745127689501849, 0.5987048661866872, 0.6150587614835299, 0.6235459263519157, 0.6242749572288078, 0.617487803249965, 0.6035533905932737, 0.5829587891298973, 0.5562981176479913, 0.5242594301512685, 0.4876098667074901, 0.4471793871690113, 0.4038434340803349, 0.35850489164572913, 0.3120757203331862, 0.2654586512883612, 0.2195293211470415, 0.17511921616639572, 0.13299977511644376, 0.09386797352395007, 0.05833367823902913, 0.026909021642488096, 5.551115123125783e-17, -0.02209954852229226, -0.039211482769035105, -0.05127436510328112, -0.05834194106610116, -0.06057915224660319, -0.05825579536275974, -0.051737990793461586,
		-0.04147767026008778, -0.028000335035639347, -0.011891372070937673, 0.0062187549948336945, 0.025670100451846797, 0.04578926228516392, 0.06590547744637608, 0.08536642579379872, 0.10355339059327373, 0.11989543991386664, 0.13388231702719247, 0.14507575848581133, 0.15311899522788647, 0.15774423401250978, 0.15877796279891232, 0.15614397331552238, 0.14986404592245722, 0.14005629480721166, 0.12693122439939944, 0.11078559948107106, 0.09199428066766013, 0.07100022265779549, 0.04830287389197389, 0.02444525211330477, 6.123233995736765e-17, -0.024445252113304648, -0.04830287389197378, -0.07100022265779539, -0.09199428066766004, -0.11078559948107096, -0.12693122439939936, -0.1400562948072116, -0.14986404592245717, -0.15614397331552232, -0.15877796279891232, -0.15774423401250978, -0.15311899522788652, -0.14507575848581128, -0.13388231702719253, -0.11989543991386672,
		-0.10355339059327398, -0.08536642579379883, -0.06590547744637604, -0.04578926228516435, -0.025670100451846645, -0.006218754994833795, 0.011891372070937604, 0.028000335035639257, 0.04147767026008789, 0.05173799079346145, 0.058255795362759544, 0.06057915224660332, 0.0583419410661013, 0.05127436510328137, 0.03921148276903488, 0.022099548522292317, 8.326672684688674e-17, -0.026909021642487818, -0.05833367823902885, -0.09386797352395004, -0.13299977511644365, -0.17511921616639534, -0.21952932114704132, -0.2654586512883608, -0.3120757203331859, -0.3585048916457292, -0.40384343408033485, -0.44717938716901107, -0.48760986670748974, -0.5242594301512685, -0.5562981176479908, -0.5829587891298971, -0.6035533905932738, -0.6174878032499649, -0.6242749572288078, -0.6235459263519156, -0.6150587614835298, -0.5987048661866874, -0.5745127689501851, -0.5426491999968911,
		-0.5034174365157315, -0.45725293688903423, -0.40471634090920067, -0.3464839678940702, -0.28333599685020583, -0.21614256128502723, -0.14584803490003767, -0.07345382227808564,
};

// Attack, decay, and release times stolen from Nord Stage 3.
const float attack_table[] = { //256 elements
		5.0000000000e-04, 5.3083844279e-04, 5.6357890469e-04, 5.9833869632e-04, 6.3524236363e-04, 6.7442213421e-04, 7.1601839102e-04, 7.6018017540e-04, 8.0706572111e-04, 8.5684302125e-04, 9.0969043023e-04, 9.6579730282e-04, 1.0253646726e-03, 1.0886059722e-03, 1.1557477982e-03, 1.2270307229e-03, 1.3027101564e-03, 1.3830572616e-03, 1.4683599261e-03, 1.5589237933e-03, 1.6550733577e-03, 1.7571531278e-03, 1.8655288603e-03, 1.9805888703e-03, 2.1027454235e-03, 2.2324362124e-03, 2.3701259252e-03, 2.5163079108e-03, 2.6715059459e-03, 2.8362761124e-03, 3.0112087897e-03, 3.1969307697e-03, 3.3941075030e-03, 3.6034454832e-03, 3.8256947779e-03, 4.0616517170e-03, 4.3121617453e-03, 4.5781224519e-03, 4.8604867865e-03, 5.1602664740e-03, 5.4785356389e-03, 5.8164346547e-03, 6.1751742294e-03, 6.5560397438e-03, 6.9603958570e-03, 7.3896913959e-03, 7.8454645466e-03, 8.3293483658e-03, 8.8430766320e-03, 9.3884900577e-03, 9.9675428848e-03, 1.0582309887e-02, 1.1234993803e-02, 1.1927933230e-02, 1.2663611003e-02, 1.3444663090e-02, 1.4273888038e-02, 1.5154256997e-02, 1.6088924372e-02, 1.7081239120e-02, 1.8134756750e-02, 1.9253252068e-02, 2.0440732693e-02, 2.1701453424e-02,
		2.3039931484e-02, 2.4460962702e-02, 2.5969638700e-02, 2.7571365135e-02, 2.9271881068e-02, 3.1077279527e-02, 3.2994029341e-02, 3.5028998314e-02, 3.7189477835e-02, 3.9483209004e-02, 4.1918410369e-02, 4.4503807369e-02, 4.7248663604e-02, 5.0162814023e-02, 5.3256700165e-02, 5.6541407567e-02, 6.0028705493e-02, 6.3731089093e-02, 6.7661824184e-02, 7.1834994773e-02, 7.6265553526e-02, 8.0969375345e-02, 8.5963314244e-02, 9.1265263742e-02, 9.6894220971e-02, 1.0287035475e-01, 1.0921507785e-01, 1.1595112371e-01, 1.2310262790e-01, 1.3069521460e-01, 1.3875608840e-01, 1.4731413179e-01, 1.5640000864e-01, 1.6604627408e-01, 1.7628749113e-01, 1.8716035455e-01, 1.9870382232e-01, 2.1095925523e-01, 2.2397056508e-01, 2.3778437200e-01, 2.5245017151e-01, 2.6802051185e-01, 2.8455118229e-01, 3.0210141301e-01, 3.2073408729e-01, 3.4051596690e-01, 3.6151793123e-01, 3.8381523131e-01, 4.0748775942e-01, 4.3262033534e-01, 4.5930301026e-01, 4.8763138947e-01, 5.1770697489e-01, 5.4963752875e-01, 5.8353745972e-01, 6.1952823286e-01, 6.5773880480e-01, 6.9830608581e-01, 7.4137543036e-01, 7.8710115796e-01, 8.3564710602e-01, 8.8718721697e-01, 9.4190616145e-01, 1.0000000000e+00,
		1.0301861877e+00, 1.0612835814e+00, 1.0933196868e+00, 1.1263228402e+00, 1.1603222329e+00, 1.1953479376e+00, 1.2314309349e+00, 1.2686031403e+00, 1.3068974328e+00, 1.3463476841e+00, 1.3869887881e+00, 1.4288566920e+00, 1.4719884284e+00, 1.5164221474e+00, 1.5621971511e+00, 1.6093539275e+00, 1.6579341873e+00, 1.7079809000e+00, 1.7595383321e+00, 1.8126520865e+00, 1.8673691427e+00, 1.9237378982e+00, 1.9818082116e+00, 2.0416314463e+00, 2.1032605165e+00, 2.1667499333e+00, 2.2321558535e+00, 2.2995361292e+00, 2.3689503585e+00, 2.4404599388e+00, 2.5141281207e+00, 2.5900200641e+00, 2.6682028960e+00, 2.7487457696e+00, 2.8317199254e+00, 2.9171987547e+00, 3.0052578640e+00, 3.0959751421e+00, 3.1894308290e+00, 3.2857075867e+00, 3.3848905728e+00, 3.4870675151e+00, 3.5923287898e+00, 3.7007675011e+00, 3.8124795636e+00, 3.9275637875e+00, 4.0461219653e+00, 4.1682589626e+00, 4.2940828102e+00, 4.4237048001e+00, 4.5572395837e+00, 4.6948052733e+00, 4.8365235467e+00, 4.9825197545e+00, 5.1329230312e+00, 5.2878664095e+00, 5.4474869377e+00, 5.6119258011e+00, 5.7813284469e+00, 5.9558447128e+00, 6.1356289594e+00, 6.3208402071e+00, 6.5116422763e+00, 6.7082039325e+00,
		6.9106990358e+00, 7.1193066943e+00, 7.3342114228e+00, 7.5556033057e+00, 7.7836781656e+00, 8.0186377360e+00, 8.2606898401e+00, 8.5100485745e+00, 8.7669344984e+00, 9.0315748291e+00, 9.3042036424e+00, 9.5850620804e+00, 9.8743985638e+00, 1.0172469013e+01, 1.0479537072e+01, 1.0795874346e+01, 1.1121760635e+01, 1.1457484190e+01, 1.1803341959e+01, 1.2159639855e+01, 1.2526693027e+01, 1.2904826134e+01, 1.3294373638e+01, 1.3695680097e+01, 1.4109100468e+01, 1.4535000423e+01, 1.4973756675e+01, 1.5425757305e+01, 1.5891402111e+01, 1.6371102958e+01, 1.6865284146e+01, 1.7374382779e+01, 1.7898849160e+01, 1.8439147181e+01, 1.8995754739e+01, 1.9569164158e+01, 2.0159882621e+01, 2.0768432623e+01, 2.1395352429e+01, 2.2041196554e+01, 2.2706536252e+01, 2.3391960018e+01, 2.4098074115e+01, 2.4825503104e+01, 2.5574890401e+01, 2.6346898844e+01, 2.7142211279e+01, 2.7961531165e+01, 2.8805583194e+01, 2.9675113936e+01, 3.0570892497e+01, 3.1493711197e+01, 3.2444386276e+01, 3.3423758611e+01, 3.4432694463e+01, 3.5472086243e+01, 3.6542853298e+01, 3.7645942728e+01, 3.8782330223e+01, 3.9953020924e+01, 4.1159050314e+01, 4.2401485134e+01, 4.3681424325e+01, 4.5000000000e+01,
};

const float decay_table[] = {//256 elements
		3.0000000000e-03, 3.1404106514e-03, 3.2873930197e-03, 3.4412546848e-03, 3.6023176220e-03, 3.7709188766e-03, 3.9474112685e-03, 4.1321641310e-03, 4.3255640833e-03, 4.5280158402e-03, 4.7399430580e-03, 4.9617892220e-03, 5.1940185742e-03, 5.4371170846e-03, 5.6915934684e-03, 5.9579802505e-03, 6.2368348797e-03, 6.5287408957e-03, 6.8343091496e-03, 7.1541790827e-03, 7.4890200643e-03, 7.8395327927e-03, 8.2064507613e-03, 8.5905417936e-03, 8.9926096498e-03, 9.4134957093e-03, 9.8540807306e-03, 1.0315286695e-02, 1.0798078737e-02, 1.1303467159e-02, 1.1832509555e-02, 1.2386313013e-02, 1.2966036439e-02, 1.3572892980e-02, 1.4208152561e-02, 1.4873144546e-02, 1.5569260517e-02, 1.6297957187e-02, 1.7060759449e-02, 1.7859263565e-02, 1.8695140508e-02, 1.9570139460e-02, 2.0486091469e-02, 2.1444913285e-02, 2.2448611366e-02, 2.3499286081e-02, 2.4599136102e-02, 2.5750463010e-02, 2.6955676105e-02, 2.8217297451e-02, 2.9537967156e-02, 3.0920448892e-02, 3.2367635682e-02, 3.3882555952e-02, 3.5468379869e-02, 3.7128425975e-02, 3.8866168134e-02, 4.0685242795e-02, 4.2589456608e-02, 4.4582794390e-02, 4.6669427456e-02, 4.8853722359e-02, 5.1140250018e-02, 5.3533795290e-02,
		5.6039366979e-02, 5.8662208318e-02, 6.1407807945e-02, 6.4281911382e-02, 6.7290533065e-02, 7.0439968924e-02, 7.3736809564e-02, 7.7187954050e-02, 8.0800624352e-02, 8.4582380450e-02, 8.8541136161e-02, 9.2685175695e-02, 9.7023170992e-02, 1.0156419987e-01, 1.0631776502e-01, 1.1129381390e-01, 1.1650275954e-01, 1.2195550232e-01, 1.2766345283e-01, 1.3363855568e-01, 1.3989331456e-01, 1.4644081837e-01, 1.5329476860e-01, 1.6046950804e-01, 1.6798005075e-01, 1.7584211353e-01, 1.8407214877e-01, 1.9268737887e-01, 2.0170583233e-01, 2.1114638143e-01, 2.2102878174e-01, 2.3137371348e-01, 2.4220282475e-01, 2.5353877688e-01, 2.6540529182e-01, 2.7782720178e-01, 2.9083050124e-01, 3.0444240128e-01, 3.1869138656e-01, 3.3360727495e-01, 3.4922127988e-01, 3.6556607567e-01, 3.8267586594e-01, 4.0058645514e-01, 4.1933532350e-01, 4.3896170547e-01, 4.5950667180e-01, 4.8101321549e-01, 5.0352634179e-01, 5.2709316234e-01, 5.5176299375e-01, 5.7758746087e-01, 6.0462060474e-01, 6.3291899571e-01, 6.6254185186e-01, 6.9355116285e-01, 7.2601181970e-01, 7.5999175053e-01, 7.9556206277e-01, 8.3279719191e-01, 8.7177505730e-01, 9.1257722518e-01, 9.5528907938e-01, 1.0000000000e+00,
		1.0301861877e+00, 1.0612835814e+00, 1.0933196868e+00, 1.1263228402e+00, 1.1603222329e+00, 1.1953479376e+00, 1.2314309349e+00, 1.2686031403e+00, 1.3068974328e+00, 1.3463476841e+00, 1.3869887881e+00, 1.4288566920e+00, 1.4719884284e+00, 1.5164221474e+00, 1.5621971511e+00, 1.6093539275e+00, 1.6579341873e+00, 1.7079809000e+00, 1.7595383321e+00, 1.8126520865e+00, 1.8673691427e+00, 1.9237378982e+00, 1.9818082116e+00, 2.0416314463e+00, 2.1032605165e+00, 2.1667499333e+00, 2.2321558535e+00, 2.2995361292e+00, 2.3689503585e+00, 2.4404599388e+00, 2.5141281207e+00, 2.5900200641e+00, 2.6682028960e+00, 2.7487457696e+00, 2.8317199254e+00, 2.9171987547e+00, 3.0052578640e+00, 3.0959751421e+00, 3.1894308290e+00, 3.2857075867e+00, 3.3848905728e+00, 3.4870675151e+00, 3.5923287898e+00, 3.7007675011e+00, 3.8124795636e+00, 3.9275637875e+00, 4.0461219653e+00, 4.1682589626e+00, 4.2940828102e+00, 4.4237048001e+00, 4.5572395837e+00, 4.6948052733e+00, 4.8365235467e+00, 4.9825197545e+00, 5.1329230312e+00, 5.2878664095e+00, 5.4474869377e+00, 5.6119258011e+00, 5.7813284469e+00, 5.9558447128e+00, 6.1356289594e+00, 6.3208402071e+00, 6.5116422763e+00, 6.7082039325e+00,
		6.9106990358e+00, 7.1193066943e+00, 7.3342114228e+00, 7.5556033057e+00, 7.7836781656e+00, 8.0186377360e+00, 8.2606898401e+00, 8.5100485745e+00, 8.7669344984e+00, 9.0315748291e+00, 9.3042036424e+00, 9.5850620804e+00, 9.8743985638e+00, 1.0172469013e+01, 1.0479537072e+01, 1.0795874346e+01, 1.1121760635e+01, 1.1457484190e+01, 1.1803341959e+01, 1.2159639855e+01, 1.2526693027e+01, 1.2904826134e+01, 1.3294373638e+01, 1.3695680097e+01, 1.4109100468e+01, 1.4535000423e+01, 1.4973756675e+01, 1.5425757305e+01, 1.5891402111e+01, 1.6371102958e+01, 1.6865284146e+01, 1.7374382779e+01, 1.7898849160e+01, 1.8439147181e+01, 1.8995754739e+01, 1.9569164158e+01, 2.0159882621e+01, 2.0768432623e+01, 2.1395352429e+01, 2.2041196554e+01, 2.2706536252e+01, 2.3391960018e+01, 2.4098074115e+01, 2.4825503104e+01, 2.5574890401e+01, 2.6346898844e+01, 2.7142211279e+01, 2.7961531165e+01, 2.8805583194e+01, 2.9675113936e+01, 3.0570892497e+01, 3.1493711197e+01, 3.2444386276e+01, 3.3423758611e+01, 3.4432694463e+01, 3.5472086243e+01, 3.6542853298e+01, 3.7645942728e+01, 3.8782330223e+01, 3.9953020924e+01, 4.1159050314e+01, 4.2401485134e+01, 4.3681424325e+01, 4.5000000000e+0,
};

const float release_table[] = {//256 elements
		3.0000000000e-03, 3.1404106514e-03, 3.2873930197e-03, 3.4412546848e-03, 3.6023176220e-03, 3.7709188766e-03, 3.9474112685e-03, 4.1321641310e-03, 4.3255640833e-03, 4.5280158402e-03, 4.7399430580e-03, 4.9617892220e-03, 5.1940185742e-03, 5.4371170846e-03, 5.6915934684e-03, 5.9579802505e-03, 6.2368348797e-03, 6.5287408957e-03, 6.8343091496e-03, 7.1541790827e-03, 7.4890200643e-03, 7.8395327927e-03, 8.2064507613e-03, 8.5905417936e-03, 8.9926096498e-03, 9.4134957093e-03, 9.8540807306e-03, 1.0315286695e-02, 1.0798078737e-02, 1.1303467159e-02, 1.1832509555e-02, 1.2386313013e-02, 1.2966036439e-02, 1.3572892980e-02, 1.4208152561e-02, 1.4873144546e-02, 1.5569260517e-02, 1.6297957187e-02, 1.7060759449e-02, 1.7859263565e-02, 1.8695140508e-02, 1.9570139460e-02, 2.0486091469e-02, 2.1444913285e-02, 2.2448611366e-02, 2.3499286081e-02, 2.4599136102e-02, 2.5750463010e-02, 2.6955676105e-02, 2.8217297451e-02, 2.9537967156e-02, 3.0920448892e-02, 3.2367635682e-02, 3.3882555952e-02, 3.5468379869e-02, 3.7128425975e-02, 3.8866168134e-02, 4.0685242795e-02, 4.2589456608e-02, 4.4582794390e-02, 4.6669427456e-02, 4.8853722359e-02, 5.1140250018e-02, 5.3533795290e-02,
		5.6039366979e-02, 5.8662208318e-02, 6.1407807945e-02, 6.4281911382e-02, 6.7290533065e-02, 7.0439968924e-02, 7.3736809564e-02, 7.7187954050e-02, 8.0800624352e-02, 8.4582380450e-02, 8.8541136161e-02, 9.2685175695e-02, 9.7023170992e-02, 1.0156419987e-01, 1.0631776502e-01, 1.1129381390e-01, 1.1650275954e-01, 1.2195550232e-01, 1.2766345283e-01, 1.3363855568e-01, 1.3989331456e-01, 1.4644081837e-01, 1.5329476860e-01, 1.6046950804e-01, 1.6798005075e-01, 1.7584211353e-01, 1.8407214877e-01, 1.9268737887e-01, 2.0170583233e-01, 2.1114638143e-01, 2.2102878174e-01, 2.3137371348e-01, 2.4220282475e-01, 2.5353877688e-01, 2.6540529182e-01, 2.7782720178e-01, 2.9083050124e-01, 3.0444240128e-01, 3.1869138656e-01, 3.3360727495e-01, 3.4922127988e-01, 3.6556607567e-01, 3.8267586594e-01, 4.0058645514e-01, 4.1933532350e-01, 4.3896170547e-01, 4.5950667180e-01, 4.8101321549e-01, 5.0352634179e-01, 5.2709316234e-01, 5.5176299375e-01, 5.7758746087e-01, 6.0462060474e-01, 6.3291899571e-01, 6.6254185186e-01, 6.9355116285e-01, 7.2601181970e-01, 7.5999175053e-01, 7.9556206277e-01, 8.3279719191e-01, 8.7177505730e-01, 9.1257722518e-01, 9.5528907938e-01, 1.0000000000e+00,
		1.0301861877e+00, 1.0612835814e+00, 1.0933196868e+00, 1.1263228402e+00, 1.1603222329e+00, 1.1953479376e+00, 1.2314309349e+00, 1.2686031403e+00, 1.3068974328e+00, 1.3463476841e+00, 1.3869887881e+00, 1.4288566920e+00, 1.4719884284e+00, 1.5164221474e+00, 1.5621971511e+00, 1.6093539275e+00, 1.6579341873e+00, 1.7079809000e+00, 1.7595383321e+00, 1.8126520865e+00, 1.8673691427e+00, 1.9237378982e+00, 1.9818082116e+00, 2.0416314463e+00, 2.1032605165e+00, 2.1667499333e+00, 2.2321558535e+00, 2.2995361292e+00, 2.3689503585e+00, 2.4404599388e+00, 2.5141281207e+00, 2.5900200641e+00, 2.6682028960e+00, 2.7487457696e+00, 2.8317199254e+00, 2.9171987547e+00, 3.0052578640e+00, 3.0959751421e+00, 3.1894308290e+00, 3.2857075867e+00, 3.3848905728e+00, 3.4870675151e+00, 3.5923287898e+00, 3.7007675011e+00, 3.8124795636e+00, 3.9275637875e+00, 4.0461219653e+00, 4.1682589626e+00, 4.2940828102e+00, 4.4237048001e+00, 4.5572395837e+00, 4.6948052733e+00, 4.8365235467e+00, 4.9825197545e+00, 5.1329230312e+00, 5.2878664095e+00, 5.4474869377e+00, 5.6119258011e+00, 5.7813284469e+00, 5.9558447128e+00, 6.1356289594e+00, 6.3208402071e+00, 6.5116422763e+00, 6.7082039325e+00,
		6.9106990358e+00, 7.1193066943e+00, 7.3342114228e+00, 7.5556033057e+00, 7.7836781656e+00, 8.0186377360e+00, 8.2606898401e+00, 8.5100485745e+00, 8.7669344984e+00, 9.0315748291e+00, 9.3042036424e+00, 9.5850620804e+00, 9.8743985638e+00, 1.0172469013e+01, 1.0479537072e+01, 1.0795874346e+01, 1.1121760635e+01, 1.1457484190e+01, 1.1803341959e+01, 1.2159639855e+01, 1.2526693027e+01, 1.2904826134e+01, 1.3294373638e+01, 1.3695680097e+01, 1.4109100468e+01, 1.4535000423e+01, 1.4973756675e+01, 1.5425757305e+01, 1.5891402111e+01, 1.6371102958e+01, 1.6865284146e+01, 1.7374382779e+01, 1.7898849160e+01, 1.8439147181e+01, 1.8995754739e+01, 1.9569164158e+01, 2.0159882621e+01, 2.0768432623e+01, 2.1395352429e+01, 2.2041196554e+01, 2.2706536252e+01, 2.3391960018e+01, 2.4098074115e+01, 2.4825503104e+01, 2.5574890401e+01, 2.6346898844e+01, 2.7142211279e+01, 2.7961531165e+01, 2.8805583194e+01, 2.9675113936e+01, 3.0570892497e+01, 3.1493711197e+01, 3.2444386276e+01, 3.3423758611e+01, 3.4432694463e+01, 3.5472086243e+01, 3.6542853298e+01, 3.7645942728e+01, 3.8782330223e+01, 3.9953020924e+01, 4.1159050314e+01, 4.2401485134e+01, 4.3681424325e+01, 4.5000000000e+0,
};

const float d_sine_table[] = {
		0.00000000e+00, -6.38239408e-03, -6.39488409e-03, -6.39488409e-03,-4.99600320e-05,  2.07209233e-02,  4.30155875e-02,  7.66511791e-02,
		        1.05415667e-01,  1.35778877e-01,  1.75609512e-01,  2.17151279e-01,
		        2.60291767e-01,  2.90804856e-01,  3.33782974e-01,  3.73913369e-01,
		        4.13669065e-01,  4.53612110e-01,  4.85786371e-01,  5.20708433e-01,
		        5.62500000e-01,  5.94461930e-01,  6.32543965e-01,  6.75971723e-01,
		        7.04736211e-01,  7.41494305e-01,  7.63863909e-01,  7.84297562e-01,
		        8.07004396e-01,  8.34170164e-01,  8.50144884e-01,  8.74500400e-01,
		        8.88888889e-01,  9.01678657e-01,  9.15642486e-01,  9.22462030e-01,
		        9.30005995e-01,  9.36850520e-01,  9.41646683e-01,  9.41646683e-01,
		        9.41646683e-01,  9.41646683e-01,  9.41646683e-01,  9.41646683e-01,
		        9.41646683e-01,  9.41646683e-01,  9.37425060e-01,  9.28856914e-01,
		        9.18265388e-01,  9.05488110e-01,  8.92086331e-01,  8.80895284e-01,
		        8.76099121e-01,  8.66506795e-01,  7.99785172e-01,  7.64650779e-01,
		        7.05735412e-01,  6.46420364e-01,  5.89778177e-01,  5.55493106e-01,
		        5.01798561e-01,  4.23511191e-01,  3.61211031e-01,  2.65337730e-01,
		        1.82254197e-01,  1.02343125e-01, -1.74210631e-01, -2.48263889e-01,
		       -3.35631495e-01, -3.77173261e-01, -4.17990608e-01, -4.57059353e-01,
		       -5.85831335e-01, -6.26473821e-01, -6.61620703e-01, -7.00239808e-01,
		       -7.29666267e-01, -7.50437150e-01, -7.68635092e-01, -7.80175859e-01,
		       -7.96163070e-01, -8.02557954e-01, -8.08952838e-01, -8.20143885e-01,
		       -8.23341327e-01, -8.23878397e-01, -8.30260791e-01, -8.57426559e-01,
		       -8.92585931e-01, -9.10159373e-01, -9.30455635e-01, -9.51701139e-01,
		       -9.54436451e-01, -9.54436451e-01, -9.54436451e-01, -9.54436451e-01,
		       -9.54436451e-01, -9.54436451e-01, -9.54436451e-01, -9.42883193e-01,
		       -9.32054357e-01, -9.17328637e-01, -9.06150080e-01, -8.90487610e-01,
		       -8.69404476e-01, -8.52118305e-01, -8.27862710e-01, -8.02295663e-01,
		       -7.78327338e-01, -7.52760292e-01, -7.31989408e-01, -6.98428757e-01,
		       -6.71262990e-01, -6.42498501e-01, -6.10536571e-01, -5.65460132e-01,
		       -5.20883293e-01, -4.79478917e-01, -4.36325939e-01, -3.96370404e-01,
		       -3.56414868e-01, -3.06867006e-01, -2.55645484e-01, -1.94731715e-01,
		       -1.43834932e-01, -1.03879396e-01, -6.54976019e-02, -2.71407874e-02
};

const float d_tri_table[] = {
		0.00000000e+00, 0.5e-2, 1e-2, 1.5e-2,
		        2.35172820e-02,  4.55002946e-02,  7.53387667e-02,  9.73217793e-02,
		        1.14689709e-01,  1.36574529e-01,  1.67984093e-01,  1.97822565e-01,
		        2.21376669e-01,  2.41788590e-01,  2.60629419e-01,  2.73369992e-01,
		        2.96739984e-01,  3.23227612e-01,  3.48561469e-01,  3.75257757e-01,
		        3.98566379e-01,  4.19223782e-01,  4.42777887e-01,  4.69474175e-01,
		        5.13747054e-01,  5.41719855e-01,  5.66845051e-01,  5.91970247e-01,
		        6.18666536e-01,  6.45362824e-01,  6.67345837e-01,  6.92471033e-01,
		        7.16025137e-01,  7.50576885e-01,  7.74548311e-01,  7.93401414e-01,
		        7.87117046e-01,  7.16872054e-01,  6.80749214e-01,  6.38820699e-01,
		        5.92792616e-01,  5.57737628e-01,  5.23689120e-01,  4.90708464e-01,
		        4.67154360e-01,  4.26870581e-01,  3.88624313e-01,  3.56220542e-01,
		        3.15396701e-01,  2.72400334e-01,  2.40990770e-01,  2.04867930e-01,
		        1.73458366e-01,  1.40477710e-01,  1.14689709e-01,  9.17984093e-02,
		        6.66732129e-02,  2.42660055e-02, -1.81412019e-02, -5.51109584e-02,
		       -8.96504321e-02, -1.19476630e-01, -1.57919285e-01, -1.94042125e-01,
		       -2.25451689e-01, -2.45090338e-01, -2.63133346e-01, -2.83545267e-01,
		       -3.05528280e-01, -3.30653476e-01, -3.62063040e-01, -4.10754615e-01,
		       -4.50706991e-01, -4.88388649e-01, -5.31691870e-01, -5.67814709e-01,
		       -6.03299293e-01, -6.24975452e-01, -6.60472310e-01, -6.83424980e-01,
		       -7.06991359e-01, -7.32705715e-01, -7.54688727e-01, -7.73529556e-01,
		       -7.95512569e-01, -8.31635408e-01, -8.52047329e-01, -8.78240377e-01,
		       -8.97584446e-01, -9.16425275e-01, -9.33695012e-01, -9.60391300e-01,
		       -9.77219167e-01, -9.93359682e-01, -1.02047329e+00, -1.04989444e+00,
		       -1.03770621e+00, -9.96882364e-01, -9.54487431e-01, -9.04592989e-01,
		       -8.59043598e-01, -8.11923115e-01, -7.74229183e-01, -7.31821976e-01,
		       -6.92262372e-01, -6.56434112e-01, -6.21882364e-01, -5.87072859e-01,
		       -5.51207777e-01, -5.21369305e-01, -4.89959741e-01, -4.61692361e-01,
		       -4.28711705e-01, -3.98873233e-01, -3.67463668e-01, -3.37784760e-01,
		       -3.04644540e-01, -2.66950609e-01, -2.40254321e-01, -2.16810683e-01,
		       -1.94815397e-01, -1.75962294e-01, -1.53819717e-01, -1.25687353e-01,
		       -1.08405342e-01, -1.05226335e-01, -1.00549882e-01, -9.73954242e-02
};

const float d_clar_table[] = {
		0.00000000e+00,  4.02960526e-02,  1.05827068e-01,  1.93914474e-01,
		        2.40601504e-01,  2.94666353e-01,  3.49718045e-01,  3.93350564e-01,
		        4.30639098e-01,  4.68444549e-01,  5.51738722e-01,  6.30521617e-01,
		        7.10620301e-01,  7.59093045e-01,  7.92951128e-01,  8.16470865e-01,
		        8.74812030e-01,  8.98566729e-01,  9.08787594e-01,  9.16000940e-01,
		        9.26315789e-01,  9.29323308e-01,  9.29323308e-01,  9.25822368e-01,
		        8.98872180e-01,  8.18750000e-01,  7.96992481e-01,  7.89473684e-01,
		        7.87969925e-01,  7.83458647e-01,  7.83458647e-01,  7.77890038e-01,
		        7.48120301e-01,  7.16400376e-01,  7.00751880e-01,  6.96240602e-01,
		        6.93233083e-01,  6.93233083e-01,  6.93233083e-01,  6.93233083e-01,
		        6.93233083e-01,  6.93233083e-01,  6.93233083e-01,  6.93233083e-01,
		        6.93233083e-01,  6.91729323e-01,  6.91729323e-01,  6.91729323e-01,
		        6.88721805e-01,  6.87218045e-01,  6.87218045e-01,  6.87218045e-01,
		        6.87218045e-01,  6.87218045e-01,  6.82706767e-01,  6.66423872e-01,
		        6.66165414e-01,  6.60150376e-01,  6.44783835e-01,  6.19525376e-01,
		        5.94266917e-01,  5.61489662e-01,  5.45253759e-01,  5.21804511e-01,
		        4.61654135e-01,  4.23167293e-01,  3.82565789e-01,  3.29323308e-01,
		        2.41541353e-01,  1.74483083e-01,  9.52067669e-02, -2.34962406e-04,
		       -6.03383459e-02, -3.18068609e-01, -4.11795113e-01, -4.59093045e-01,
		       -4.88909774e-01, -5.46405075e-01, -5.69924812e-01, -5.72932331e-01,
		       -5.75939850e-01, -5.75939850e-01, -5.75939850e-01, -5.80662594e-01,
		       -5.98402256e-01, -6.14238722e-01, -6.18045113e-01, -6.19548872e-01,
		       -7.09962406e-01, -7.60667293e-01, -7.70347744e-01, -7.41306391e-01,
		       -6.97274436e-01, -6.43444549e-01, -5.91259398e-01, -5.04205827e-01,
		       -4.59398496e-01, -3.81062030e-01, -3.24248120e-01, -2.66329887e-01,
		       -2.14003759e-01, -1.91752820e-01, -1.75516917e-01, -1.74436090e-01,
		       -1.80451128e-01, -1.80451128e-01, -1.84962406e-01, -1.90977444e-01,
		       -2.15037594e-01, -2.16541353e-01, -2.28054511e-01, -2.37593985e-01,
		       -2.37593985e-01, -2.37593985e-01, -2.37593985e-01, -2.23096805e-01,
		       -2.12030075e-01, -2.12030075e-01, -2.16541353e-01, -2.16541353e-01,
		       -2.21052632e-01, -2.21052632e-01, -2.21052632e-01, -2.21052632e-01,
		       -2.00281955e-01, -1.56978383e-01, -1.21193609e-01, -8.24013158e-02
};

const float d_hills_table[] = {
		0.        ,  0.03243104,  0.07702541,  0.11119407,  0.14710035,
		        0.18933265,  0.22762815,  0.25369244,  0.29354909,  0.33354149,
		        0.37122611,  0.39965248,  0.42044961,  0.44940541,  0.47591768,
		        0.51419961,  0.54843614,  0.57044146,  0.59592202,  0.61618973,
		        0.63770634,  0.66020037,  0.68046807,  0.69031006,  0.70721112,
		        0.71173165,  0.71763684,  0.72458732,  0.7325695 ,  0.74196351,
		        0.75065161,  0.75586447,  0.75586447,  0.75586447,  0.76107732,
		        0.76107732,  0.76107732,  0.76107732,  0.76107732,  0.76107732,
		        0.76107732,  0.75760209,  0.75586447,  0.75142539,  0.74022589,
		        0.74022589,  0.74022589,  0.74022589,  0.74022589,  0.74022589,
		        0.74022589,  0.74022589,  0.73848827,  0.71729746,  0.68486642,
		        0.63936251,  0.57971329,  0.5131136 ,  0.47779105,  0.40076564,
		        0.30690704,  0.25537576,  0.14913662,  0.07876303,  0.03040834,
		       -0.03358493, -0.14522698, -0.2300038 , -0.29072546, -0.33126086,
		       -0.3796427 , -0.42944993, -0.4824066 , -0.59153725, -0.65035838,
		       -0.71242398, -0.74706777, -0.80544092, -0.8701944 , -0.89300065,
		       -0.93331885, -0.94005213, -0.94352737, -0.94526499, -0.94526499,
		       -0.94951401, -0.95221546, -0.95221546, -0.95221546, -0.95221546,
		       -0.95221546, -0.95221546, -0.95221546, -0.95221546, -0.95221546,
		       -0.95221546, -0.95221546, -0.95149598, -0.94700261, -0.94700261,
		       -0.9376086 , -0.93136403, -0.92962641, -0.91746308, -0.90703736,
		       -0.89361153, -0.87508145, -0.84100782, -0.80723284, -0.78300119,
		       -0.72632493, -0.69705691, -0.65790617, -0.6097008 , -0.56524218,
		       -0.52476108, -0.47426151, -0.39202324, -0.33709818, -0.29535458,
		       -0.23859687, -0.17254018, -0.14069288, -0.10356483, -0.0532689 ,
		       -0.02778834, -0.02142159, -0.00521286
};

const float d_piano_table[] = {
		0.04475339,  0.08165876,  0.13362226,  0.20261453,  0.27992246,
		        0.35915215,  0.43875508,  0.51890475,  0.59667807,  0.66378181,
		        0.70914982,  0.72935053,  0.73442071,  0.73726376,  0.74038419,
		        0.74059677,  0.73426962,  0.71671905,  0.68202045,  0.62854296,
		        0.56406724,  0.49969306,  0.44005652,  0.38323764,  0.32790869,
		        0.27463405,  0.22416898,  0.17979585,  0.14536057,  0.11679514,
		        0.08041148,  0.02476103, -0.04889792, -0.12985947, -0.2077625 ,
		       -0.27920657, -0.34704663, -0.41885353, -0.49832623, -0.57723274,
		       -0.64516824, -0.7020026 , -0.75150865, -0.78815866, -0.80064974,
		       -0.78686434, -0.75683046, -0.72555677, -0.70490633, -0.69690394,
		       -0.69590836, -0.69584599, -0.69844425, -0.71337359, -0.74180192,
		       -0.77108779, -0.78655072, -0.78566112, -0.77619455, -0.76539634,
		       -0.75488778, -0.74037791, -0.71271808, -0.6641216 , -0.59600676,
		       -0.51833086, -0.43696464, -0.34997503, -0.25801983, -0.17005367,
		       -0.09084372, -0.0142283 ,  0.0640441 ,  0.13886824,  0.20438223,
		        0.26155609,  0.31569367,  0.37151128,  0.42533112,  0.46351086,
		        0.47393013,  0.46176228,  0.44765925,  0.45116318,  0.47260996,
		        0.49626844,  0.50658415,  0.49715932,  0.46875572,  0.43281357,
		        0.40625074,  0.39942478,  0.41269045,  0.44133938,  0.47838314,
		        0.50557333,  0.49632985,  0.43645819,  0.33884501,  0.23343056,
		        0.14374302,  0.07362314,  0.01354589, -0.04562028, -0.10017516,
		       -0.13380162, -0.13649379, -0.11710097, -0.09134478, -0.06457795,
		       -0.03191067,  0.0098344 ,  0.05544086,  0.09736913,  0.13022453,
		        0.1509328 ,  0.15819387,  0.15459534,  0.14421003,  0.12565168,
		        0.09718258,  0.06696016,  0.04447172,  0.02985379,  0.01800302,
		        0.00762166,  0.00093961, -0.00233918
};

const float d_cello_table[] = {
		0.        ,  0.        , -0.00974509, -0.0517585 , -0.06293798,
		       -0.08854897, -0.1201384 , -0.15230816, -0.19428872, -0.26702654,
		       -0.27082603, -0.26244963, -0.21662579, -0.20505212, -0.18125876,
		       -0.15935967, -0.12245971, -0.10202786, -0.09110021, -0.08969867,
		       -0.09324632, -0.0974181 , -0.19336896, -0.23675105, -0.26270147,
		       -0.29524352, -0.3917966 , -0.50647118, -0.5601787 , -0.62531754,
		       -0.71520235, -0.76537316, -0.85423966, -0.89590268, -0.91800981,
		       -0.9051441 , -0.83632621, -0.74328793, -0.65997285, -0.61071084,
		       -0.54922915, -0.48628022, -0.38813945, -0.30699238, -0.23410126,
		       -0.19216451, -0.15589961, -0.12081727, -0.10126139,  0.18297784,
		        0.29524352,  0.34481211,  0.43106167,  0.50387614,  0.52697968,
		        0.55099203,  0.60502803,  0.64423835,  0.67223633,  0.74594867,
		        0.78626489,  0.80328048,  0.81786528,  0.82764322,  0.83742116,
		        0.84299448,  0.84512964,  0.87436493,  0.8821391 ,  0.88577435,
		        0.88577435,  0.88437281,  0.87789068,  0.77984846,  0.72899877,
		        0.6874781 ,  0.53757884,  0.3414287 ,  0.14549755,  0.03197267,
		        0.00140154, -0.01990627, -0.04776191, -0.0444661 ,  0.0071829 ,
		        0.06028819,  0.08680799,  0.14845392,  0.20322355,  0.2116328 ,
		        0.21303434,  0.21303434,  0.21303434,  0.21188464,  0.20771286,
		        0.14919849,  0.08269096,  0.07046032,  0.03473196, -0.00515724,
		       -0.13126314, -0.15416959, -0.15416959, -0.15416959, -0.15416959,
		       -0.13659557, -0.12821917, -0.12473721, -0.12193413, -0.12053259,
		       -0.12112386, -0.12529564, -0.20234758, -0.2284513 , -0.23918185,
		       -0.32375613, -0.32515767, -0.30024746, -0.26563595, -0.24608006,
		       -0.2019096 , -0.15954581, -0.10892607, -0.08186974, -0.06153644,
		       -0.05596312, -0.04905396, -0.04625088
};
#endif

double gains[COMP_TABLE_SIZE]; // To store the pre-calculated gains

float vel_table[128];

// Declare the array to hold frequencies globally
float f_table[MIDI_PITCH_COUNT];

float Process_Filter(float input_sample) {
    float output_sample;

    // Direct Form II Transposed implementation for 4th order IIR
    // y[n] = b0*x[n] + w1[n-1]
    // w1[n] = b1*x[n] - a1*y[n] + w2[n-1]
    // w2[n] = b2*x[n] - a2*y[n] + w3[n-1]
    // w3[n] = b3*x[n] - a3*y[n] + w4[n-1]
    // w4[n] = b4*x[n] - a4*y[n]

    output_sample = b_coeffs[0] * input_sample + w_states[0];

    w_states[0] = b_coeffs[1] * input_sample - a_coeffs[1] * output_sample + w_states[1];
    w_states[1] = b_coeffs[2] * input_sample - a_coeffs[2] * output_sample + w_states[2];
    w_states[2] = b_coeffs[3] * input_sample - a_coeffs[3] * output_sample + w_states[3];
    w_states[3] = b_coeffs[4] * input_sample - a_coeffs[4] * output_sample; // No next state to add


    return fmax(-10.0, fmin(output_sample, 10.0));;
}

// Button stuff
#define NUM_PRESETS 8

// Define the size of the lookup table
#define COMP_TABLE_SIZE 1024

// Define the range of linear values used to generate the table
#define LIN_MIN_INPUT 0.000000000001 // A very small number instead of 0 to avoid log(0)
#define LIN_MAX_INPUT 10.0

// Convert linear amplitude to decibels
float dB(float lin) {
    if (lin <= 0) {
        return -200.0f; // Effectively -infinity for practical audio purposes
    }
    return 20.0f * log10(lin);
}

// Convert decibels to linear amplitude
float lin(float dB_val) {
    return pow(10.0f, dB_val / 20.0f);
}

// Function to initialize the lookup tables
void Comp_LUT_Init() {
    // Compressor parameters
	// Global arrays for lookup tables (or pass them as arguments)
	double lvl_ins[COMP_TABLE_SIZE];
	double lvl_outs[COMP_TABLE_SIZE];
    double W = 10.0; // Knee width

    // Populate lvl_ins with linear values, then convert to dB
    for (int i = 0; i < COMP_TABLE_SIZE; i++) {
        // Calculate the linear value that corresponds to this table index
        // This is crucial for direct indexing later
        double linear_val_for_index = LIN_MIN_INPUT + (double)i / (COMP_TABLE_SIZE - 1) * (LIN_MAX_INPUT - LIN_MIN_INPUT);
        lvl_ins[i] = dB(linear_val_for_index);
    }

    // Calculate lvl_outs and gains based on soft knee compression
    for (int i = 0; i < COMP_TABLE_SIZE; i++) {
        double lvl = lvl_ins[i];
        // No compression regime
        if (lvl < thresh - W / 2.0) {
            lvl_outs[i] = lvl;
        // Soft knee regime
        } else if (lvl < thresh + W / 2.0) {
            lvl_outs[i] = lvl + (ratio - 1.0) * pow(lvl - thresh + 0.5 * W, 2.0) / (2.0 * W);
        // Linear in log units regime
        } else {
            lvl_outs[i] = thresh + ratio * (lvl - thresh);
        }

        // Calculate the gain for each entry
        double linear_lvl_in = lin(lvl_ins[i]);
        if (linear_lvl_in > 1e-10) { // A small threshold to prevent division by near zero
            gains[i] = lin(lvl_outs[i]) / linear_lvl_in;
        } else {
            gains[i] = 1.0; // Default for very low input
        }
    }
}

void F_Table_Init() {
    for (uint8_t midi_note = MIDI_PITCH_MIN; midi_note <= MIDI_PITCH_MAX; midi_note++) {
        // Calculate the exponent: (MIDI_note - 69) / 12.0
        // Use 12.0 to ensure floating-point division
        float exponent = (float)(midi_note - A4_MIDI_NOTE) / 12.0f;
        // Calculate the frequency using the formula
        f_table[midi_note] = A4_FREQUENCY * powf(2.0f, exponent);
        // powf is the float version of pow (better for float arguments)
    }
}

void Populate_Vel_Table() {
	float amp_min = 0.18;
	for (uint8_t i = 0; i < 128; i++) {
		vel_table[i] = amp_min + (i/127.0)*(i/127.0)*(1.0 - amp_min);
	}
}

//these are decay coefficients. Each time step, multiply envelope by these.
float inv_attack_ticks_table[ADR_TABLE_SIZE];
float k_decay_table[ADR_TABLE_SIZE];
float k_release_table[ADR_TABLE_SIZE];

/* USER CODE END PV */

/* Private function prototypes -----------------------------------------------*/
void SystemClock_Config(void);
static void MX_GPIO_Init(void);
static void MX_DMA_Init(void);
static void MX_I2C1_Init(void);
static void MX_I2S3_Init(void);
static void MX_SPI1_Init(void);
static void MX_USB_OTG_FS_PCD_Init(void);
static void MX_ADC1_Init(void);
static void MX_USART2_UART_Init(void);
/* USER CODE BEGIN PFP */

/* USER CODE END PFP */

/* Private user code ---------------------------------------------------------*/
/* USER CODE BEGIN 0 */

// When ADC conversion is complete, copy the results into another buffer.
void HAL_ADC_ConvCpltCallback(ADC_HandleTypeDef* hadc) {
	uint8_t changed = 0;

	for (int i = 0; i < N_ADC; i++) {
		// Check if the new value is more than 5 away from the old value
		if (abs(AD_RES_BUFFER[i] - AD_RES_COPY[i]) > 5) {
			changed |= (1 << i);
		}
		AD_RES_COPY[i] = AD_RES_BUFFER[i];

		//printf("%d\r\n",AD_RES_COPY[i]);
	}
	// Update knob values unless you're using a preset
	if (!preset_ind) {
		AD_LPF = AD_RES_COPY[0];
		AD_decay = AD_RES_COPY[1];
		AD_FX = AD_RES_COPY[2];
		AD_attack = AD_RES_COPY[3];
		AD_release = AD_RES_COPY[4];
		AD_waveform = AD_RES_COPY[5];
		AD_LA_rate = AD_RES_COPY[6];
	}
	//Else, update preset status only if knob changed by more than 5
	else {
		if (changed & (1 << 0)) {
			AD_LPF = AD_RES_COPY[0];
		}
		if (changed & (1 << 1)) {
			AD_decay = AD_RES_COPY[1];
		}
		if (changed & (1 << 2)) {
			AD_FX = AD_RES_COPY[2];
		}
		if (changed & (1 << 3)) {
			AD_attack = AD_RES_COPY[3];
		}
		if (changed & (1 << 4)) {
			AD_release = AD_RES_COPY[4];
		}
		if (changed & (1 << 5)) {
			AD_waveform = AD_RES_COPY[5];
		}
		if (changed & (1 << 6)) {
			AD_LA_rate = AD_RES_COPY[6];
		}
	}
	//printf("\r\n");
}

/**
  * @brief  EXTI line detection callback.
  * @param  GPIO_Pin Specifies the pins connected to the EXTI line.
  * @retval None
  */
void HAL_GPIO_EXTI_Callback(uint16_t GPIO_Pin)
{
  /* USER CODE BEGIN HAL_GPIO_EXTI_Callback 0 */
	// Only listen to the button if not in a preset
	  if ((GPIO_Pin == B1_Pin) & !preset_ind)
	  {
		  Notes_Init(&my_midi_notes);
		  // Set the flag when the interrupt for PA0 (EXTI Line0) occurs
		  //button_flag = 1;
		  if (loops - loops_PLA_press > 175) {
			  loops_PLA_press = loops;
			  PLA_ind += 1;
			  PLA_ind %= 3;
			  HAL_GPIO_WritePin(poly_GPIO_Port, poly_Pin,        PLA_disp_map[PLA_ind] & 0b1);
			  HAL_GPIO_WritePin(legato_GPIO_Port,legato_Pin,     PLA_disp_map[PLA_ind] & 0b10);
			  HAL_GPIO_WritePin(arpeggio_GPIO_Port, arpeggio_Pin,PLA_disp_map[PLA_ind] & 0b100);
			  legato_mode = (PLA_ind == 1);
			  arpeggio_mode = (PLA_ind == 2);
		  }
	  }
  /* USER CODE END HAL_GPIO_EXTI_Callback 0 */

  /* USER CODE BEGIN HAL_GPIO_EXTI_Callback 1 */

  /* USER CODE END HAL_GPIO_EXTI_Callback 1 */
}

// When I2S buffer (digital audio data to DAC) is halfway and fully complete,
// point to different halves of the output buffer. "ping pong". Light up LEDs
// to keep track of timing issues.
void HAL_I2S_TxHalfCpltCallback(I2S_HandleTypeDef *hi2s) {
	//HAL_GPIO_TogglePin(GPIOD, LD4_Pin); //green
	out_buf_ptr = &dac_data[0];
	data_ready_flag = 1;
}

void HAL_I2S_TxCpltCallback(I2S_HandleTypeDef *hi2s) {
	//HAL_GPIO_TogglePin(GPIOD, LD3_Pin);
	out_buf_ptr = &dac_data[BUFFER_SIZE / 2];
	data_ready_flag = 1;
}

void Populate_ADR_Tables() {
    // Populate resultArray based on attackTable and FS
	float attack_duration_ticks;
    for (int i = 0; i < ADR_TABLE_SIZE; i++) {
    	attack_duration_ticks = (FS > 0.0f) ? (attack_table[i] * FS) : 1.0f; // Prevent div by zero if FS is 0
    	inv_attack_ticks_table[i] = 1.0f/attack_duration_ticks;
    	k_decay_table[i] = expf(-1.0f / (decay_table[i] * FS));
    	k_release_table[i] = expf(-1.0f / (release_table[i] * FS));
    }
    // Max decay should yield NO decay, so just hardcode that
    k_decay_table[ADR_TABLE_SIZE - 1] = 1.0f;
    k_release_table[ADR_TABLE_SIZE - 1] = 1.0f;

}

// Function to get the compressed output for a given linear audio sample
// using direct index calculation and linear interpolation.
// 'sample' is assumed to be a linear amplitude (e.g., -1.0 to 1.0 or 0.0 to 1.0).
float Gain_Of_Sample(float sample) {
    // 1. Get the absolute amplitude of the input sample
    float abs_sample = fabs(sample);

    // Handle very small or zero samples separately to avoid issues with log/indexing
    if (abs_sample < LIN_MIN_INPUT) {
        return sample; // No compression for silence or extremely low levels
    }
    // Clip high values to prevent out-of-bounds access if the input exceeds our table generation range
    if (abs_sample > LIN_MAX_INPUT) {
        abs_sample = LIN_MAX_INPUT;
    }

    // 2. Map the linear input amplitude to an approximate table index.
    // This is the core of "jumping to the index".
    // We normalize the input linear value to the range [0, 1] based on LIN_MIN_INPUT and LIN_MAX_INPUT,
    // then scale it by (TABLE_SIZE - 1) to get the floating-point index.
    float normalized_linear_input = (abs_sample - LIN_MIN_INPUT) / (LIN_MAX_INPUT - LIN_MIN_INPUT);
    float float_index = normalized_linear_input * (COMP_TABLE_SIZE - 1);

    // 3. Get the two surrounding integer indices for interpolation
    int index1 = (int)floor(float_index);
    int index2 = (int)ceil(float_index);

    // Clamp indices to prevent out-of-bounds access
    if (index1 < 0) index1 = 0;
    if (index2 >= COMP_TABLE_SIZE) index2 = COMP_TABLE_SIZE - 1;

    // Handle edge case where index1 and index2 are the same (e.g., float_index is an integer)
    if (index1 == index2) {
        return sample * gains[index1];
    }

    // 4. Calculate the interpolation factor (fractional part of the float_index)
    float frac = float_index - index1;

    // 5. Perform linear interpolation on the gain values
    float gain1 = gains[index1];
    float gain2 = gains[index2];
    float interpolated_gain = gain1 + frac * (gain2 - gain1);

    // 6. Apply the interpolated gain to the original sample
    // Maintain the sign of the original sample.
    return interpolated_gain;
}

// Function to process a single audio sample
float Compressor(float input_sample){
	// TODO replace with LUT logic.
	float target_gain = Gain_Of_Sample(input_sample);

	// 4. Apply envelope follower (Attack and Release)
	// Calculate attack and release coefficients based on sample rate
	// These are simplified one-pole filter coefficients

	if (target_gain < envelope_gain) {
		// Attack phase: reduce gain quickly
		envelope_gain = (target_gain * (1.0 - attack_coeff)) + (envelope_gain * attack_coeff);
	} else {
		// Release phase: increase gain slowly
		envelope_gain = (target_gain * (1.0 - release_coeff)) + (envelope_gain * release_coeff);
	}

	// Ensure gain doesn't go above 1.0 (no boosting)
//	if (envelope_gain > 1.0) {
//		envelope_gain = 1.0;
//	}


	// 5. Apply the calculated gain to the input sample
	float output_sample = fmax(-1.0, fmin(input_sample * envelope_gain, 1.0));

	return output_sample;
}


// Note management functions
void Notes_Init(Notes* notes_system) {
    // Loop through all possible MIDI pitches and set their initial state
    for (int i = 0; i < MIDI_PITCH_COUNT; i++) {
        notes_system->vel[i] = 0;              // No velocity (note off)
        notes_system->released[i] = 0;         //
        notes_system->ticks_pressed[i] = 0;    // No ticks yet
        notes_system->ticks_released[i] = 0;   // No ticks yet
        notes_system->env[i] = 0.0f;           // Envelope at zero
        notes_system->phase_decimal[i] = 0.0f;
        notes_system->phase_integer[i] = 0;
    }
}

void Release_Note(Notes* notes_system, uint8_t note_index) {
    // Basic validation to ensure the index is within bounds
    if (note_index < MIDI_PITCH_COUNT) {
        notes_system->released[note_index] = 1;         //
        //notes_system->vel[note_index] = 0; // get rid of this, velocity is supposed to be historic
    } else {
        // Optional: Add an error handling or logging mechanism if an invalid index is provided
    	Error_Handler();
    }
}

void Clear_Note(Notes* notes_system, uint8_t note_index) {
    // Basic validation to ensure the index is within bounds
    if (note_index < MIDI_PITCH_COUNT) {
        notes_system->vel[note_index] = 0;              // No velocity (note off)
        notes_system->released[note_index] = 0;         //
        notes_system->ticks_pressed[note_index] = 0;    // No ticks yet
        notes_system->ticks_released[note_index] = 0;   // No ticks yet
        notes_system->env[note_index] = 0.0f;           // Envelope at zero
        notes_system->phase_decimal[note_index] = 0.0f;
        notes_system->phase_integer[note_index] = 0;
        //notes_system->vel[note_index] = 0; // get rid of this, velocity is supposed to be historic
    } else {
        // Optional: Add an error handling or logging mechanism if an invalid index is provided
    	Error_Handler();
    }
}

uint16_t Incr_Note_Phase(Notes* notes_system, uint8_t note_index, float dph, uint16_t LUT_size) {
	notes_system->phase_decimal[note_index] += dph;
	// Calculate how many full increments have occurred
	// This ensures correctness even if dph is much larger than 1.0f
	int full_increments = (int)notes_system->phase_decimal[note_index];
	// Update the integer part
	notes_system->phase_integer[note_index] += full_increments;
	// Keep the decimal part within [0.0f, 1.0f)
	notes_system->phase_decimal[note_index] -= (float)full_increments;
	// Handle integer part wrap-around for the lookup table
	notes_system->phase_integer[note_index] &= LUT_size - 1;
	// Ensure phase_integer is always positive after modulo, especially if negative increments were possible
//	if (phase_integer < 0) {
//	    phase_integer += LOOKUP_SIZE;
//	}
	// Use the integer part for direct lookup
	return notes_system->phase_integer[note_index];
}

void Release_Legato_Note(LegatoNote* legato_note) {
	legato_note->released = 1;
}

void Clear_Legato_Note(LegatoNote* legato_note) {
    // Basic validation to ensure the index is within bounds
	legato_note->vel = 0;              // No velocity (note off)
	legato_note->released = 1;         //
	legato_note->ticks_pressed = 0;    // No ticks yet
	legato_note->ticks_released = 0;   // No ticks yet
	legato_note->env = 0.0f;           // Envelope at zero
	legato_note->freq = 0.0f;
	legato_note->target_freq = 0.0f;
	legato_note->target_pitch = 0.0f;
	legato_note->current_phase = 0.0f;

}

void Arpeggio_State_Init(ArpeggioState* arp) {
    // Loop through all possible MIDI pitches and set their initial state
    for (int i = 0; i < MIDI_PITCH_COUNT; i++) {
        arp->bools[i] = 0;
        arp->notes[i] = 0;
    }
    arp->num_notes = 0;
    arp->ticks_played = 4294967295; //max uint32_t
    arp->cycle_num = 0;
}


/**
 * @brief Adds (activates) a note in the Notes tracking system with a given pitch and velocity.
 *
 * @param notes_system A pointer to the Notes struct holding the state of all MIDI pitches.
 * @param pitch The MIDI pitch number (0-127) of the note to activate.
 * @param velocity The velocity value (0-127) for the note.
 */
void Add_Note(Notes* notes_system, uint8_t pitch, uint8_t velocity) {
    // Basic validation for the pitch
    if (notes_system == NULL) {
        //printf("Error: NULL Notes system pointer passed to add_note.\r\n");
        return;
    }
    if (pitch >= MIDI_PITCH_COUNT) {
        //printf("Error: add_note called with invalid pitch: %u (max %u)\r\n", pitch, MIDI_PITCH_COUNT - 1);
        return;
    }
    // A velocity of 0 is typically interpreted as a "Note Off" event.
    // While this function is named "add_note", it's good practice to handle
    // velocity 0 either by calling clear_note or just returning.
    if (velocity == 0) {
        // If velocity is 0, treat it as a note off (set released flag)
        // or clear the note entirely. For simplicity here, we'll mark it released
        // and let updateNoteEnvelope handle the decay.
        notes_system->released[pitch] = 1;
        // Don't actually set the vel[pitch] to 0! That variable tracks what was :')
        return;
    }

    // Set the velocity for the specified pitch
    notes_system->vel[pitch] = velocity;
    // Mark the note as pressed (not released)
    notes_system->released[pitch] = 0;
    // Reset ticks related to pressing/releasing for a new press
    notes_system->ticks_pressed[pitch] = 0;
    notes_system->ticks_released[pitch] = 0; // Not applicable for a pressed note
    // Reset envelope to 0.0f, as it will start its attack phase
    notes_system->env[pitch] = 0.0f;
}

void Add_Legato_Note(LegatoNote* legato_note, uint8_t pitch, uint8_t velocity) {
    // Basic validation for the pitch
    if (legato_note == NULL) {
        //printf("Error: NULL Notes system pointer passed to add_note.\r\n");
        return;
    }
    if (pitch >= MIDI_PITCH_COUNT) {
        //printf("Error: add_note called with invalid pitch: %u (max %u)\r\n", pitch, MIDI_PITCH_COUNT - 1);
        return;
    }

    // Set the velocity for the specified pitch
    legato_note->vel = velocity;
    // Mark the note as pressed (not released)
    legato_note->released = 0;
    // Reset ticks related to pressing/releasing for a new press
    legato_note->ticks_pressed = 0;
    legato_note->ticks_released = 0; // Not applicable for a pressed note
    // Reset envelope to 0.0f, as it will start its attack phase
    legato_note->env = 0.0f;
    // Frequencies
    legato_note->target_pitch = pitch;
    legato_note->freq = f_table[pitch];
    legato_note->target_freq = f_table[pitch];
    //legato_note->current_phase = 0.0f;
    //legato_note->freq;
}

void Update_Legato_Note(LegatoNote* legato_note, uint8_t attack_ind, float decay_k, float release_k) {
    // Ensure notes_system is not NULL
    if (legato_note == NULL) {
        //printf("Error: NULL Notes system pointer passed to updateNoteEnvelope.\r\n");
        return;
    }
    float attack_duration_ticks = (FS > 0.0f) ? (attack_table[attack_ind] * FS) : 1.0f;

    // Calculate attack duration in ticks (common for all notes)
    // Ensure FS is not zero to prevent division by zero in attack_increment_per_tick
    // Handle frequency sliding

    // Calculate the maximum change allowed in this time step
    // Make the rate of change proportional to current frequency so the perceived
    // glide rate is linear?
    float max_change = (0.5 + AD_LA_rate * 0.1)*legato_note->freq * TS; // was glide_rate * TS

    // Calculate the difference between the current and target frequency
    float freq_diff = legato_note->target_freq - legato_note->freq;

    // Determine the direction of the glide
    if (fabsf(freq_diff) <= max_change) {
        // If the remaining difference is less than or equal to max_change,
        // we can just snap to the target frequency to avoid overshooting and oscillation.
        legato_note->freq = legato_note->target_freq;
    } else {
        // Otherwise, move freq towards target_freq by max_change
        if (freq_diff > 0) {
            // Target is higher, so increase freq
            legato_note->freq += max_change;
        } else {
            // Target is lower, so decrease freq
            legato_note->freq -= max_change;
        }
    }

	// Only process notes that have velocity (are "on") and we haven't hit N_voices limit
	if (legato_note->vel != 0) {
		// Check if the note is currently pressed (not released)
		if (legato_note->released == 0) {
			legato_note->ticks_pressed++; // Increment ticks since press

			// Attack Phase: if ticks_pressed is within the attack duration
			if (legato_note->ticks_pressed <= attack_duration_ticks) {
				// Calculate the linear increment per tick
				if (attack_duration_ticks > 0.0f) {
					float attack_increment_per_tick = vel_table[legato_note->vel] * inv_attack_ticks_table[attack_ind];
					legato_note->env += attack_increment_per_tick;
				} else { // Instant attack
					legato_note->env = 1.0f;
				}
				// Clip the envelope level at 1.0 (maximum)
				legato_note->env = fminf(legato_note->env, 1.0f);
			}
			// Decay Phase: if attack is finished and note is still pressed
			else {
				legato_note->env *= decay_k;
				// Ensure envelope doesn't go below 0 due to floating point inaccuracies
				legato_note->env = fmaxf(legato_note->env, 0.0f);
			}

		} else { // If the note has been released (notes_system->released[pitch] == 1)
			legato_note->ticks_released++; // Increment ticks since release
			legato_note->ticks_pressed++; // Increment ticks since press
			// Release Phase: apply release scalar
			legato_note->env *= release_k;
			// Ensure envelope doesn't go below 0
			legato_note->env = fmaxf(legato_note->env, 0.0f);
		}

		// After envelope processing, if the envelope has decayed to near zero,
		// and the note is released, we can "turn off" the note entirely
		if (legato_note->env < 0.001f && legato_note->released == 1) {
			// Call your clear_note function here if you have one
			// clear_note(notes_system, pitch); // Assuming clear_note sets vel to 0, released to 1, etc.
			// If you don't have clear_note, you'd do:
			Clear_Legato_Note(legato_note);
		}
	}
}
/**
 * @brief Updates the envelope level for active notes within the Notes tracking system.
 *
 * This function iterates over the `Notes` arrays from highest to lowest pitch.
 * For the first N_voices (where velocity is not 0), it applies the ADSR envelope logic
 * (simplified to AD-Release here) to update the 'env' level for that specific note.
 *
 * @param notes_system A pointer to the Notes struct holding the state of all MIDI pitches.
 * @param attack_time_sec The duration of the attack phase in seconds.
 * @param decay_k The exponential decay factor for the decay phase (0.0 to 1.0, typically < 1.0).
 * @param release_k The exponential release factor for the release phase (0.0 to 1.0, typically < 1.0).
 */
void Update_Note_Envelope(Notes* notes_system, uint8_t attack_ind, float decay_k, float release_k) {
    // Ensure notes_system is not NULL
    if (notes_system == NULL) {
        //printf("Error: NULL Notes system pointer passed to updateNoteEnvelope.\r\n");
        return;
    }
    float attack_duration_ticks = (FS > 0.0f) ? (attack_table[attack_ind] * FS) : 1.0f;

    // Calculate attack duration in ticks (common for all notes)
    // Ensure FS is not zero to prevent division by zero in attack_increment_per_tick
    uint8_t pitch;
    // Iterate over active notes
    for (int ind = 0; ind < num_active_notes; ind++) {
    	pitch = active_notes[ind];
        // Only process notes that have velocity (are "on") and we haven't hit N_voices limit
        if (notes_system->vel[pitch] != 0) {
			// Check if the note is currently pressed (not released)
			if (notes_system->released[pitch] == 0) {
				notes_system->ticks_pressed[pitch]+=1; // Increment ticks since press

				// Attack Phase: if ticks_pressed is within the attack duration
				if (notes_system->ticks_pressed[pitch] <= attack_duration_ticks) {
					// Calculate the linear increment per tick
					if (attack_duration_ticks > 0.0f) {
						float attack_increment_per_tick = vel_table[notes_system->vel[pitch]] * inv_attack_ticks_table[attack_ind];
						notes_system->env[pitch] += attack_increment_per_tick;
					} else { // Instant attack
						notes_system->env[pitch] = 1.0f;
					}
					// Clip the envelope level at 1.0 (maximum)
					notes_system->env[pitch] = fminf(notes_system->env[pitch], 1.0f);
				}
				// Decay Phase: if attack is finished and note is still pressed
				else {
					notes_system->env[pitch] *= decay_k;
					// Ensure envelope doesn't go below 0 due to floating point inaccuracies
					notes_system->env[pitch] = fmaxf(notes_system->env[pitch], 0.0f);
				}

			} else { // If the note has been released (notes_system->released[pitch] == 1)
				notes_system->ticks_released[pitch]+=1; // Increment ticks since release
				notes_system->ticks_pressed[pitch]+=1; // Increment ticks since press
				// Release Phase: apply release scalar. If sustained, use decay scalar.
				if (sustain) {
					notes_system->env[pitch] *= decay_k;
				}
				else {
					notes_system->env[pitch] *= release_k;
				}
				// Ensure envelope doesn't go below 0
				notes_system->env[pitch] = fmaxf(notes_system->env[pitch], 0.0f);
			}

			// After envelope processing, if the envelope has decayed to near zero,
			// and the note is released, we can "turn off" the note entirely
			// by setting its velocity to 0 and clearing its state.
			// This is crucial for managing polyphony and avoiding processing
			// completely silent, released notes indefinitely.
			if (notes_system->env[pitch] < 0.001f && notes_system->released[pitch] == 1) {
				// Call your clear_note function here if you have one
				// clear_note(notes_system, pitch); // Assuming clear_note sets vel to 0, released to 1, etc.
				// If you don't have clear_note, you'd do:
				notes_system->vel[pitch] = 0;
				notes_system->ticks_pressed[pitch] = 0;
				notes_system->ticks_released[pitch] = 0;
				notes_system->env[pitch] = 0.0f; // Ensure it's exactly zero
				notes_system->released[pitch] = 0.0f; // Set released to 0 so that the next instance is ready.
			}
        }
    }
}

void Parse_MIDI(uint8_t* data, uint16_t length) {
	int did_something = 0;
	uint8_t byte;
	// Iterate through all received MIDI bytes
	for (uint16_t i = 0; i < length; i++) {
		byte = data[i];
		// 254 is Yamaha CP reface's "heartbeat"; it means nothing
		if ((byte != 254) & (byte != 248)) {
			did_something = 1;
			//printf("%02X\r\n", byte);
			// Status byte if MSB = 1. This is a note command or a pedal command
			if ((byte >> 7) & 0x01) {
				// if MS Nybble is 0x9, Note On command
				current_last_read = LAST_READ_STATUS;
				if ((byte >> 4) == 0x9) {
					//inNoteEvent = 1;
					//printf("ON ");
				}
				else if ((byte >> 4) == 0x8) {
					//inNoteEvent = 0;
					//printf("OFF ");
				}
				else if ((byte >> 4) == 0xB) {
					//printf("PEDAL 0xB \r\n");
					current_last_read = LAST_READ_CONTROL;
				}
			}
			// Data byte if MSB = 0
			else {
				// Expect control command is followed by 0d40 = sustain pedal flag.
				if ((current_last_read == LAST_READ_CONTROL) | (current_last_read == LAST_READ_PEDAL_VELOCITY)) {
					// For now assume we're receiving a 40 (decimal), which is sustain
					current_last_read = LAST_READ_PEDAL;
					//printf("last read pedal\r\n");
				}
				// Sustain pedal flag followed by sustain velocity. 0 for off.
				else if (current_last_read == LAST_READ_PEDAL) {
					current_last_read = LAST_READ_PEDAL_VELOCITY;
					// Interpret any nonzero pedal velocity as sustain.
					sustain = byte;
				}
				// If in a note status event, or in a rolling status (last read velocity), you're receiving a pitch.
				else if ((current_last_read == LAST_READ_STATUS) | (current_last_read == LAST_READ_VELOCITY)) {
					current_last_read = LAST_READ_PITCH;
					MIDI_ptr = byte;
					//printf("note %02X ", byte);
				}
				// Interpret velocity.
				else if (current_last_read == LAST_READ_PITCH) {
					current_last_read = LAST_READ_VELOCITY;
					if (byte == 0) {
						in_note_event = 0;
						if (legato_mode) {
							// Only release the legato note if the released note is the currentMIDIpitch
							if (MIDI_ptr == curr_MIDI_pitch) {
								Release_Legato_Note(&my_legato_note);
							}
						}
						else {
							//For poly mode, don't release if pedal is down
							Release_Note(&my_midi_notes, MIDI_ptr);

							if (arpeggio_mode) {
								arp_state.bools[MIDI_ptr] = 0;
							}
						}
					}
					else {
						curr_MIDI_pitch = MIDI_ptr;
						if (legato_mode) {
							// If a fresh note is required, instantiate it!
							if (my_legato_note.released) {
								Add_Legato_Note(&my_legato_note, curr_MIDI_pitch, byte);
							}
							else {
								// If there is an existing note being played, update the target pitch
								my_legato_note.target_pitch = curr_MIDI_pitch;
								my_legato_note.target_freq = f_table[curr_MIDI_pitch];
							}
						}
						else if (arpeggio_mode) {
							arp_state.bools[curr_MIDI_pitch] = 1;
							arp_state.vels[curr_MIDI_pitch] = byte;
						}
						// Poly mode
						else {
							Add_Note(&my_midi_notes, curr_MIDI_pitch, byte);
						}
					}
					//printf("vel %02X ", byte);
				}
			}
		}
	}
	if (did_something) {
		HAL_GPIO_TogglePin(GPIOD, LD3_Pin); //orange toggle every MIDI input
	}

}

void Read_RX_Buffer() {
	//HAL_DMA_GET_COUNTER tells us where in the RxUART buffer the DMA has last put data
	uint16_t pos = RX_BUFFER_SIZE - __HAL_DMA_GET_COUNTER(&hdma_usart2_rx);
	if (pos != old_pos) {
		if (pos > old_pos) {
			// Data is contiguous
			Parse_MIDI(&RX_UART[old_pos], pos - old_pos);
		}
		else {
			// Data loops around
			Parse_MIDI(&RX_UART[old_pos], RX_BUFFER_SIZE - old_pos);
			Parse_MIDI(&RX_UART[0], pos);
		}
		old_pos = pos;
	}
}

// Calculates the waveform and stores it in the DAC output buffer
void Calc_Wave() {
	debug_flag = 0;
	Read_RX_Buffer(); // Get MIDI status.
	debug_flag = 1;
	//navflag
	// Alternate blue and red LEDs so you can see the ping pong effect/timing errors
	if (out_buf_ptr == &dac_data[0]) {
		HAL_GPIO_WritePin(GPIOD, LD6_Pin, GPIO_PIN_SET); //blue
	}
	else {
		HAL_GPIO_WritePin(GPIOD, LD5_Pin, GPIO_PIN_SET); //red
	}
	static float left_out, left_out_filt; //, compressed;
	left_out = 0.0;
	float vibrato = 1.0;
	float tremolo = 1.0;
	//double phase;
	uint16_t phase = 0;
	//uint16_t phase_vib = 0;
	//uint8_t vibrato_amt;
	uint8_t pitch;
	uint8_t do_filt;
	float trem_freq;
	float trem_dph;
	float vib_dph;
	uint16_t LUT_size = 128;



	// Filter updating was up here

	//Vibrato knob rate set
	if (FX_bool_map[FX_ind] & VIB_MASK) {
		// 1-25 Hz are reasonable vibrato values
		// If not organ preset
		if (preset_ind != 6) { //TODO make these presets enums like a civilized person
			vib_freq = (1.0f + 0.0941f*AD_FX);
			vib_amp = 0.01;
		}
		else {
			// target is 6 or 0.75 Hz depending on rotor toggle
			vib_freq = 0.000666666667*(5.25*rotor+0.75) + (1-0.000666666667)*vib_freq;
			vib_amp = 1.125*0.00166666667*vib_freq; //6 maps to 0.012 or 1.2% vibrato
		}
		vib_dph = (vib_freq * TS) * SINE_LOOKUP_SIZE;
	}

	//Tremolo knob rate set
	if (FX_bool_map[FX_ind] & TREM_MASK) {
		// 1-25 Hz are reasonable tremolo values
		trem_freq = (1.0f + 0.0941f*AD_FX);
		trem_dph = (trem_freq * TS) * SINE_LOOKUP_SIZE;
	}
	// Was in the loop
	ticks_arpeggio = (uint32_t)((4.0f/(2.0f + 0.25f*AD_LA_rate))*FS);

	// Arpeggio mode data population
	if (arpeggio_mode) {
		// Calculate arpeggio note duration
		// 0 --> 0.5 seconds, 255 --> 0.016 seconds (1/64th)
		debug_flag = 11;
		//TODO division is evil!

		// Arpeggio mode requires notes be added to my_midi_notes here. Store list of chord tones in diff
		// data structure, since active_notes below has a different definition including released notes.
		arp_state.num_notes = 0;
		debug_flag = 12;
		for (int pitch = 0; pitch < MIDI_PITCH_COUNT; pitch++) {
			if (arp_state.bools[pitch]) {
				arp_state.notes[arp_state.num_notes] = pitch;
				arp_state.num_notes++;
			}
			if (arp_state.num_notes >= N_VOICES) {
				break;
			}
		}
		debug_flag = 13;
		// If it's time for a new arpeggio note:
		if (arp_state.ticks_played > ticks_arpeggio) {
			// If a note is being played at all
			if (arp_state.num_notes > 0) {
				HAL_GPIO_TogglePin(GPIOD, LD3_Pin); //orange toggle every arp note
				//Add_Note(&my_midi_notes, arp_state.notes[arp_state.cycle_num % arp_state.num_notes], 10); //default velocity to 100.
									//column of matrix: how many notes
				arp_ind = arp_cycle_matrix[arp_state.num_notes][arp_state.cycle_num % arp_state.num_notes];
				arp_pitch = arp_state.notes[arp_ind];
				arp_vel = arp_state.vels[arp_pitch];
				Add_Note(&my_midi_notes, arp_pitch,arp_vel);

			}
			arp_state.cycle_num++;
			arp_state.ticks_played = 0;

		}
		debug_flag = 14;

		arp_state.ticks_played+= BUFFER_SIZE;

	}


	//First figure out which notes are active
	debug_flag = 2;
	num_active_notes = 0;
	// First pass: Prioritize unreleased notes
	for (int pitch = MIDI_PITCH_COUNT - 1; pitch >= 0; pitch--) {
	    if (num_active_notes < N_VOICES) {
	        if (my_midi_notes.vel[pitch] != 0 && my_midi_notes.released[pitch] == 0) {
	            active_notes[num_active_notes] = pitch;
	            num_active_notes++;
	        }
	    } else {
	        // We've filled all voices with unreleased notes, no need to check further
	        break;
	    }
	}

	// Second pass: Add released notes if there are still voices available
	for (int pitch = MIDI_PITCH_COUNT - 1; pitch >= 0; pitch--) {

		// Only add if it's a released note AND it hasn't been added yet (i.e., not an unreleased note)
		if (my_midi_notes.vel[pitch] != 0 && my_midi_notes.released[pitch] != 0) {
			if (num_active_notes < N_VOICES) {
	            // You might want to add a check here to ensure this pitch wasn't already added in the first pass,
	            // though given the separate conditions (released == 0 vs released != 0), it shouldn't be.
	            active_notes[num_active_notes] = pitch;
	            num_active_notes++;
	        }
			// Delete the note if number of active voices is filled
			else {
				Clear_Note(&my_midi_notes, pitch);
			}
		}
	}
	debug_flag = 3;

	// Iterate over time, populating the buffer
	for (uint16_t n = 0; n < (BUFFER_SIZE / 2) - 1; n += 2) {
		// Handle filter
		//Update filter coefficients based on knob
		// If trying to filter (not turning cut-off freq to the extreme)
		if ((n & 3) == 0) {
			if (FX_bool_map[FX_ind] & LPM_MASK) {
				do_filt = 1;			//was 50.0f
				int new_lpf_value;
				// if only using LPMod, use the AD_FX knob, else reserve it for vib/trem
				if (FX_bool_map[FX_ind] == LPM_MASK) {
					new_lpf_value = (int)(0.4f*AD_FX * total_env);
				}
				else {
					new_lpf_value = (int)(50.0f * total_env);
				}
							//was 180, 190, 200// was max(0
				//TODO: why so vulnerable to popping in legato mode??
				new_lpf_value = min(190, max(AD_LPF, new_lpf_value));
				for (int i = 0; i<5; i++) {
					a_coeffs[i] = 0.2f*a_table[5*new_lpf_value + i] + 0.8f*a_coeffs[i];
					b_coeffs[i] = 0.2f*b_table[5*new_lpf_value + i] + 0.8f*b_coeffs[i];
				}
			}
			else if (AD_LPF <= 245) {
				do_filt = 1;
				for (int i = 0; i<5; i++) {
					a_coeffs[i] = 0.2f*a_table[5*AD_LPF + i] + 0.8f*a_coeffs[i];
					b_coeffs[i] = 0.2f*b_table[5*AD_LPF + i] + 0.8f*b_coeffs[i];
				}
			}
			// If user turns knob almost all the way to the high end, just don't filter.
			else {
				do_filt = 0;
			}
		}


		//t = (ticks % (uint16_t)FS)/(float)FS;
		//debug_flag = 4;
		left_out = 0.0f;
		total_env = 0.0f;

		// Vibrato evolution handler
		if (FX_bool_map[FX_ind] & VIB_MASK) {
			vib_phase += vib_dph;
			if (vib_phase > SINE_LOOKUP_SIZE) {
				vib_phase -= SINE_LOOKUP_SIZE; //instead of modulo.
			}
			vib_phase_int = (uint16_t) vib_phase;
			vib_phase_int &= (SINE_LOOKUP_SIZE-1);
			vibrato = 1.0f + vib_amp*sine_table[vib_phase_int];
		}

		// Iterate over all active notes as calculated above.
		// For poly or arpeggio mode:
		if (!legato_mode) {
			for (uint8_t ind = 0; ind < num_active_notes; ind++) {
				pitch = active_notes[ind];
				//debug_flag = 5;
				// Only process notes that have velocity (are "on"). Not redundant; they may be turned off by updateNoteEnvelope within here.
				if (my_midi_notes.vel[pitch] != 0) {
					//playing_note = pitch;
					// Calculate phase with lookuptable. Phase is out of LOOKUPSIZE, not 2pi.
					if (p_wave_table == sine_table) {
						LUT_size = SINE_LOOKUP_SIZE;
					}
					else {
						LUT_size = WAVE_TABLE_SIZE;
					}
					float phase_increment = (f_table[pitch] * vibrato * TS) * LUT_size;
					phase = Incr_Note_Phase(&my_midi_notes, pitch, phase_increment, LUT_size);
					// Accumulate the sample from all the voices.
					left_out += p_wave_table[phase]*my_midi_notes.env[pitch];
					total_env += (1.0f + 4.0f*arpeggio_mode)*my_midi_notes.env[pitch];

					//debug_flag = 6;
				}
			}
		}
		//legato mode
		else {
			left_out = my_legato_note.env;
			total_env = 3.0f*my_legato_note.env;
			float phase_increment = (my_legato_note.freq * vibrato * TS) * SINE_LOOKUP_SIZE;
			my_legato_note.current_phase += phase_increment;
			my_legato_note.current_phase = fmodf(my_legato_note.current_phase, (float)SINE_LOOKUP_SIZE);
			// Ensure phase is always positive after fmodf (fmodf can return negative if dividend is negative)
			if (my_legato_note.current_phase < 0) {
			    my_legato_note.current_phase += (float)SINE_LOOKUP_SIZE;
			}
			uint16_t phase_index = (uint16_t)my_legato_note.current_phase;

			// Accumulate the sample from all the voices using the pointer.
			if (p_wave_table == sine_table) {
			    left_out *= p_wave_table[phase_index];
			} else {
			    uint16_t phase_128 = (uint16_t)(0.03125f * phase_index);
			    left_out *= p_wave_table[phase_128];
			}

		}
		// Tremolo effect
		if (FX_bool_map[FX_ind] & TREM_MASK) {
			trem_phase += trem_dph;
			if (trem_phase > SINE_LOOKUP_SIZE) {
				trem_phase -= SINE_LOOKUP_SIZE; //instead of modulo.
			}
			trem_phase_int = (uint16_t) trem_phase;
			trem_phase_int &= (SINE_LOOKUP_SIZE-1);
			tremolo = 1.0f + 0.2f*sine_table[trem_phase_int];
			left_out *= tremolo;
		}
		//debug_flag = 7;
		// Filter processing
		// Pre compressor
		//leftOut = compressor(leftOut);
		// EQ
		if (do_filt) {
			left_out_filt = Process_Filter(left_out);
		}
		else {
			left_out_filt = left_out;
		}
//		if (leftOutFilt > samp_max) {
//			samp_max = leftOutFilt;
//		}
		// Post compressor
		// Not enough compute for compressor compressed = compressor(leftOutFilt);
		//compressed = leftOutFilt;

							// Potentiometers connected to PC1 (attack), PA1 (decay), PA3 (release)
		if (legato_mode) {
			Update_Legato_Note(&my_legato_note, AD_attack, k_decay_table[AD_decay], k_release_table[AD_release]);
		}
		else {
			Update_Note_Envelope(&my_midi_notes, AD_attack, k_decay_table[AD_decay], k_release_table[AD_release]);
		}
		debug_flag = 8;
		out_buf_ptr[n] = (int16_t)(FLOAT_TO_INT16 * left_out_filt * 0.1f); //32768 OVERFLOWs
		out_buf_ptr[n + 1] = out_buf_ptr[n]; //TODO: do something with stereo.
		ticks++;

	}
	loops++;
	data_ready_flag = 0;
	// Turn off LEDs. You can see how hard this function works based on the LED brightness!
	HAL_GPIO_WritePin(GPIOD, LD6_Pin, GPIO_PIN_RESET); //blue
	HAL_GPIO_WritePin(GPIOD, LD5_Pin, GPIO_PIN_RESET); //red

}

// CS43L22 Stereo DAC driver by https://github.com/deadsy/googoomuck/blob/master/drivers/cs43l22.h
#if 1
enum {
	DAC_OUTPUT_OFF,		// must be 0
	DAC_OUTPUT_SPEAKER,
	DAC_OUTPUT_HEADPHONE,
	DAC_OUTPUT_BOTH,
	DAC_OUTPUT_AUTO,
	DAC_OUTPUT_MAX,		// must be last
};

struct cs4x_cfg {
	//struct i2c_drv *i2c;	// i2c bus
	uint8_t adr;		// device i2c bus address
	//int rst;		// gpio for reset pin
	int out;		// output device
};

struct cs4x_drv {
	struct cs4x_cfg cfg;
};

HAL_StatusTypeDef i2c_wr(uint8_t *buf, uint8_t Nbytes) {
	HAL_StatusTypeDef rc;
	rc = HAL_I2C_Master_Transmit(&hi2c1, DACADDR, buf, Nbytes, HAL_MAX_DELAY);
	return rc;
}

HAL_StatusTypeDef i2c_rd(uint8_t *buf, uint8_t Nbytes) {
	HAL_StatusTypeDef rc;
	rc = HAL_I2C_Master_Receive(&hi2c1, DACADDR, buf, Nbytes, HAL_MAX_DELAY);
	return rc;
}
// read a dac register
static int cs4x_rd(struct cs4x_drv *dac, uint8_t reg, uint8_t *val) {
	uint8_t buf[1] = { reg };
	int rc;
	rc = i2c_wr(buf, 1);
	if (rc != 0) {
		return rc;
	}
	rc = i2c_rd(buf, 1);
	if (rc != 0) {
		return rc;
	}
	*val = buf[0];
	return 0;
}

// write a dac register
static int cs4x_wr(struct cs4x_drv *dac, uint8_t reg, uint8_t val) {
	uint8_t buf[2] = { reg, val };
	return i2c_wr(buf, 2);
}

// read/modify/write a register
static int cs4x_rmw(struct cs4x_drv *dac, uint8_t reg, uint8_t mask,
		uint8_t val) {
	uint8_t x;
	int rc;
	rc = cs4x_rd(dac, reg, &x);
	if (rc != 0) {
		return rc;
	}
	x &= ~mask;
	x |= val & mask;
	return cs4x_wr(dac, reg, x);
}

// set bits in a register
static int cs4x_set(struct cs4x_drv *dac, uint8_t reg, uint8_t bits) {
	return cs4x_rmw(dac, reg, bits, 0xff);
}

// clear bits in a register
static int cs4x_clr(struct cs4x_drv *dac, uint8_t reg, uint8_t bits) {
	return cs4x_rmw(dac, reg, bits, 0);
}

//-----------------------------------------------------------------------------

// read and verify the device id
static int cs4x_id(struct cs4x_drv *dac) {
	uint8_t id;
	int rc;
	rc = cs4x_rd(dac, CS43L22_REG_ID, &id);
	if (rc != 0) {
		return rc;
	}
	if ((id & 0xf8) != 0xe0) {
		return -1;
	}
	return 0;
}

//-----------------------------------------------------------------------------

// set the output device
int cs4x_output(struct cs4x_drv *dac, unsigned int out) {
	const uint8_t ctrl[DAC_OUTPUT_MAX] = { 0xff, 0xfa, 0xaf, 0xaa, 0x05 };
	int rc;
	if (out >= DAC_OUTPUT_MAX) {
		out = DAC_OUTPUT_OFF;
	}
	rc = cs4x_wr(dac, CS43L22_REG_Power_Ctl_2, ctrl[out]);
	if (rc != 0) {
		return rc;
	}
	dac->cfg.out = out;
	return 0;
}

//-----------------------------------------------------------------------------
// volume controls
// Map 0..255 to the control value for a volume register.
// 0 is minium volume (or mute), 255 is maximum volume.

// set the master volume
int cs4x_master_volume(struct cs4x_drv *dac, uint8_t vol) {
	uint32_t x;
	int rc;
	x = (((281 - 52) << 16) / 255) * vol + (52 << 16);
	x >>= 16;
	x &= 255;
	rc = cs4x_wr(dac, CS43L22_REG_Master_A_Vol, x);
	rc |= cs4x_wr(dac, CS43L22_REG_Master_B_Vol, x);
	return rc;
}

// set the headphone volume
int cs4x_headphone_volume(struct cs4x_drv *dac, uint8_t vol) {
	uint32_t x;
	int rc;
	if (vol == 0) {
		x = 1;		// muted
	} else {
		x = (((257 - 52) << 16) / 255) * (vol - 1) + (52 << 16);
		x >>= 16;
		x &= 255;
	}
	rc = cs4x_wr(dac, CS43L22_REG_Headphone_A_Volume, x);
	rc |= cs4x_wr(dac, CS43L22_REG_Headphone_B_Volume, x);
	return rc;
}

// set the speaker volume
int cs4x_speaker_volume(struct cs4x_drv *dac, uint8_t vol) {
	uint32_t x;
	int rc;
	if (vol == 0) {
		x = 1;		// muted
	} else {
		x = (((257 - 64) << 16) / 255) * (vol - 1) + (64 << 16);
		x >>= 16;
		x &= 255;
	}
	rc = cs4x_wr(dac, CS43L22_REG_Speaker_A_Volume, x);
	rc |= cs4x_wr(dac, CS43L22_REG_Speaker_B_Volume, x);
	return rc;
}

// set the pcm volume
int cs4x_pcm_volume(struct cs4x_drv *dac, uint8_t vol) {
	uint32_t x;
	int rc;
	if (vol == 0) {
		x = 0x80;	// muted
	} else {
		x = (((281 - 25) << 16) / (255 - 1)) * (vol - 1) + (25 << 16);
		x >>= 16;
		x &= 255;
	}
	rc = cs4x_wr(dac, CS43L22_REG_PCMA_Vol, x);
	rc |= cs4x_wr(dac, CS43L22_REG_PCMB_Vol, x);
	return rc;
}

//-----------------------------------------------------------------------------
// mute on/off

static int cs4x_mute_on(struct cs4x_drv *dac) {
	int rc = cs4x_wr(dac, CS43L22_REG_Power_Ctl_2, 0xff);
	rc |= cs4x_headphone_volume(dac, 0);
	return rc;
}

static int cs4x_mute_off(struct cs4x_drv *dac) {
	int rc = cs4x_headphone_volume(dac, 0xff);
	rc |= cs4x_output(dac, dac->cfg.out);
	return rc;
}

//-----------------------------------------------------------------------------

int cs4x_init(struct cs4x_drv *dac, struct cs4x_cfg *cfg) {
	int rc;

	memset(dac, 0, sizeof(struct cs4x_drv));
	dac->cfg = *cfg;

	// 4.9 Recommended Power-Up Sequence (1,2)
	// reset the dac
	// DAC Reset is active low, so pull the pin high.
	HAL_GPIO_WritePin(Audio_RST_GPIO_Port, Audio_RST_Pin, GPIO_PIN_RESET);
	HAL_GPIO_WritePin(Audio_RST_GPIO_Port, Audio_RST_Pin, GPIO_PIN_SET);

	rc = cs4x_id(dac);
	if (rc != 0) {
		printf("cs4x bad device id %d\r\n", rc);
		goto exit;
	}
	// 4.9 Recommended Power-Up Sequence (4)
	// 4.11 Required Initialization Settings
	rc |= cs4x_wr(dac, 0, 0x99);
	rc |= cs4x_wr(dac, 0x47, 0x80);
	rc |= cs4x_set(dac, 0x32, 1 << 7);
	rc |= cs4x_clr(dac, 0x32, 1 << 7);
	rc |= cs4x_wr(dac, 0, 0);

	// set the output to AUTO
	rc |= cs4x_output(dac, DAC_OUTPUT_AUTO);
	// Clock configuration: Auto detection
	rc |= cs4x_wr(dac, CS43L22_REG_Clocking_Ctl, 0x81);
	// Set the Slave Mode and the audio Standard
	rc |= cs4x_wr(dac, CS43L22_REG_Interface_Ctl_1, 0x04);

	// Set the Master volume
	rc |= cs4x_master_volume(dac, 169);

	// If the Speaker is enabled, set the Mono mode and volume attenuation level
	if (dac->cfg.out != DAC_OUTPUT_OFF
			&& dac->cfg.out != DAC_OUTPUT_HEADPHONE) {
		// Set the Speaker Mono mode
		rc |= cs4x_wr(dac, CS43L22_REG_Playback_Ctl_2, 0x06);
		rc |= cs4x_speaker_volume(dac, 0xff);
	}
	// Additional configuration for the CODEC. These configurations are done to reduce
	// the time needed for the Codec to power off. If these configurations are removed,
	// then a long delay should be added between powering off the Codec and switching
	// off the I2S peripheral MCLK clock (which is the operating clock for Codec).
	// If this delay is not inserted, then the codec will not shut down properly and
	// it results in high noise after shut down.

	// Disable the analog soft ramp
	rc |= cs4x_rmw(dac, CS43L22_REG_Analog_ZC_and_SR_Settings, 0x0f, 0x00);
	// Disable the digital soft ramp
	rc |= cs4x_wr(dac, CS43L22_REG_Misc_Ctl, 0x04);
	// Disable the limiter attack level
	rc |= cs4x_wr(dac, CS43L22_REG_Limit_Ctl_1_Thresholds, 0x00);
	// Adjust Bass and Treble levels
	rc |= cs4x_wr(dac, CS43L22_REG_Tone_Ctl, 0x0f);
	// Adjust PCM volume level
	rc |= cs4x_pcm_volume(dac, 241);

	exit: return rc;
}

//-----------------------------------------------------------------------------

int cs4x_start(struct cs4x_drv *dac) {
	// Enable the digital soft ramp
	int rc = cs4x_wr(dac, CS43L22_REG_Misc_Ctl, 0x06);
	// Enable Output device
	rc |= cs4x_mute_off(dac);
	// Power on the Codec
	rc |= cs4x_wr(dac, CS43L22_REG_Power_Ctl_1, 0x9e);
	return rc;
}

int cs4x_stop(struct cs4x_drv *dac) {
	// Mute the output
	int rc = cs4x_mute_on(dac);
	// Disable the digital soft ramp
	rc |= cs4x_wr(dac, CS43L22_REG_Misc_Ctl, 0x04);
	// Power down the DAC and the speaker (PMDAC and PMSPK bits)
	rc |= cs4x_wr(dac, CS43L22_REG_Power_Ctl_1, 0x9f);
	return rc;
}

int cs4x_pause(struct cs4x_drv *dac) {
	// Mute the output
	int rc = cs4x_mute_on(dac);
	// Put the Codec in Power save mode
	rc |= cs4x_wr(dac, CS43L22_REG_Power_Ctl_1, 0x01);
	return rc;
}

int cs4x_resume(struct cs4x_drv *dac) {
	// Unmute the output
	int rc = cs4x_mute_off(dac);
	// Power on the Codec
	rc |= cs4x_wr(dac, CS43L22_REG_Power_Ctl_1, 0x9e);
	return rc;
}
#endif

/* USER CODE END 0 */

/**
  * @brief  The application entry point.
  * @retval int
  */
int main(void)
{

  /* USER CODE BEGIN 1 */

  /* USER CODE END 1 */

  /* MCU Configuration--------------------------------------------------------*/

  /* Reset of all peripherals, Initializes the Flash interface and the Systick. */
  HAL_Init();

  /* USER CODE BEGIN Init */

  /* USER CODE END Init */

  /* Configure the system clock */
  SystemClock_Config();

  /* USER CODE BEGIN SysInit */

  /* USER CODE END SysInit */

  /* Initialize all configured peripherals */
  MX_GPIO_Init();
  MX_DMA_Init();
  MX_I2C1_Init();
  MX_I2S3_Init();
  MX_SPI1_Init();
  MX_USB_OTG_FS_PCD_Init();
  MX_ADC1_Init();
  MX_USART2_UART_Init();
  /* USER CODE BEGIN 2 */
  HAL_GPIO_WritePin(pre0_GPIO_Port, pre0_Pin, 0);
  HAL_GPIO_WritePin(pre1_GPIO_Port, pre1_Pin, 0);
  HAL_GPIO_WritePin(pre2_GPIO_Port, pre2_Pin, 0);
  HAL_GPIO_WritePin(doodle_GPIO_Port, doodle_Pin, 0);
  HAL_GPIO_WritePin(poly_GPIO_Port, poly_Pin, 0);
  HAL_GPIO_WritePin(legato_GPIO_Port, legato_Pin, 0);
  HAL_GPIO_WritePin(arpeggio_GPIO_Port, arpeggio_Pin, 0);
  HAL_GPIO_WritePin(vibrato_GPIO_Port, vibrato_Pin, 0);
  HAL_GPIO_WritePin(trem_GPIO_Port, trem_Pin, 0);
  HAL_GPIO_WritePin(fxx_GPIO_Port, fxx_Pin, 0);
  HAL_GPIO_WritePin(poly_GPIO_Port, poly_Pin, 1);


	// Lookup table population
	Populate_ADR_Tables();
	F_Table_Init();
	Populate_Vel_Table();
	Comp_LUT_Init();

	// Legato Note state
	my_legato_note.released = 1;

	// EXT DAC INTIIALIZATION
	struct cs4x_cfg cfgdac;
	cfgdac.adr = DACADDR;
	cfgdac.out = DAC_OUTPUT_HEADPHONE;
	struct cs4x_drv dac;
	rc = cs4x_init(&dac, &cfgdac);
	printf("CS4X init returned %d\r\n", rc);
	rc = cs4x_start(&dac);
	printf("CS4X start returned %d\r\n", rc);
	cs4x_master_volume(&dac, 225); //255 max, 169 default, 225 is nice and loud.

	HAL_Delay(1);

	HAL_StatusTypeDef res;

	Notes_Init(&my_midi_notes); // Initialize the Notes state system
	Arpeggio_State_Init(&arp_state);

	// Attempt to transmit audio data to DAC
	Calc_Wave();
	out_buf_ptr = &dac_data[BUFFER_SIZE/2];
	Calc_Wave();
	//CalcWave();
	res = HAL_I2S_Transmit_DMA(&hi2s3, (uint16_t*) dac_data, BUFFER_SIZE);
	if (res != HAL_OK) {
		printf("I2S - ERROR, res = %d!\r\n", res);
	}
	// Start Listening to MIDI input
	HAL_UART_Receive_DMA(&huart2, RX_UART, RX_BUFFER_SIZE);

  /* USER CODE END 2 */

  /* Infinite loop */
  /* USER CODE BEGIN WHILE */
	while (1) {
    /* USER CODE END WHILE */

    /* USER CODE BEGIN 3 */
		// Populate half of the DAC buffer if it just sent off that half.
		if (data_ready_flag) {
			// Every __ loops through the half DAC buffer, read the ADC knobs.
			if (! (loops % 255)) {
				HAL_ADC_Start_DMA(&hadc1, (uint32_t *) AD_RES_BUFFER, N_ADC);
			}
//			Centers
//			B 0
//			A 13
//			Sin 38
//			3sn 73
//			tri 124
//			sq 178
//			saw 209
//			X 235
//			Y 255
			// Set wavemode
			if (doodle_mode) {
				if (AD_waveform < wave_knob_edges[0]) {
					p_wave_table = d_cello_table;
				}
				else if (AD_waveform < wave_knob_edges[1]) {
					p_wave_table = d_hills_table;
				}
				else if (AD_waveform < wave_knob_edges[2]) {
					p_wave_table = d_sine_table;
				}
				else if (AD_waveform <wave_knob_edges[3]) {
					p_wave_table = d_sn3_table;
				}
				else if (AD_waveform <wave_knob_edges[4]) {
					p_wave_table = d_tri_table;
				}
				else if (AD_waveform< wave_knob_edges[5]) {
					p_wave_table = d_square_table;
				}
				else if (AD_waveform< wave_knob_edges[6]) {
					p_wave_table = d_saw_table;
				}
				else if (AD_waveform< wave_knob_edges[7]) {
					p_wave_table = d_clar_table;
				}
				else {
					p_wave_table = d_piano_table;
				}
			}
			else {
				if (AD_waveform < wave_knob_edges[2]) {
					p_wave_table = sine_table;
				}
				else if (AD_waveform < wave_knob_edges[3]) {
					p_wave_table = sn3_table;
				}
				else if (AD_waveform < wave_knob_edges[4]) {
					p_wave_table = tri_table;
				}
				else if (AD_waveform< wave_knob_edges[5]) {
					p_wave_table = square_table;
				}
				else {
					p_wave_table = saw_table;
				}
			}

			// Poll buttons
			FX_press = !HAL_GPIO_ReadPin(FX_button_GPIO_Port, FX_button_Pin);
			//PLA_press = !HAL_GPIO_ReadPin(B1_GPIO_Port, B1_Pin);//!HAL_GPIO_ReadPin(PLA_button_GPIO_Port, PLA_button_Pin);
			doodle_press = !HAL_GPIO_ReadPin(doodle_button_GPIO_Port, doodle_button_Pin);
			preset_press = !HAL_GPIO_ReadPin(preset_button_GPIO_Port, preset_button_Pin);
			if (preset_press && (loops - loops_preset_press > 350)) {
				loops_preset_press = loops;
				preset_ind += 1;
				preset_ind %= NUM_PRESETS;
				uint8_t preset_disp = preset_disp_map[preset_ind];
				HAL_GPIO_WritePin(pre0_GPIO_Port, pre0_Pin, preset_disp & 0b1);
				HAL_GPIO_WritePin(pre1_GPIO_Port, pre1_Pin, preset_disp & 0b10);
				HAL_GPIO_WritePin(pre2_GPIO_Port, pre2_Pin, preset_disp & 0b100);

			// If we're using a preset, don't query the buttons:
				if (preset_ind) {
					AD_LPF =     preset_matrix[preset_ind-1][0];
					AD_decay =   preset_matrix[preset_ind-1][1];
					AD_FX =      preset_matrix[preset_ind-1][2];
					AD_attack =  preset_matrix[preset_ind-1][3];
					AD_release=  preset_matrix[preset_ind-1][4];
					AD_waveform= preset_matrix[preset_ind-1][5];
					AD_LA_rate = preset_matrix[preset_ind-1][6];
					doodle_mode= preset_matrix[preset_ind-1][7];
					PLA_ind =    preset_matrix[preset_ind-1][8];
					FX_ind =     preset_matrix[preset_ind-1][9];

					legato_mode = (PLA_ind == 1);
					arpeggio_mode = (PLA_ind == 2);

					HAL_GPIO_WritePin(poly_GPIO_Port, poly_Pin,        PLA_disp_map[PLA_ind] & 0b001);
					HAL_GPIO_WritePin(legato_GPIO_Port,legato_Pin,     PLA_disp_map[PLA_ind] & 0b010);
					HAL_GPIO_WritePin(arpeggio_GPIO_Port, arpeggio_Pin,PLA_disp_map[PLA_ind] & 0b100);
					HAL_GPIO_WritePin(doodle_GPIO_Port, doodle_Pin, doodle_mode);
					HAL_GPIO_WritePin(vibrato_GPIO_Port, vibrato_Pin, FX_bool_map[FX_ind] & 0b001); //1
					HAL_GPIO_WritePin(trem_GPIO_Port,    trem_Pin,    FX_bool_map[FX_ind] & 0b010);//2
					HAL_GPIO_WritePin(fxx_GPIO_Port,     fxx_Pin,     FX_bool_map[FX_ind] & 0b100);//3

				}
			}
			// Query buttons if not in a preset:
			if (!preset_ind) {
				if (doodle_press && (loops - loops_doodle_press > 350)) {
					loops_doodle_press = loops;
					doodle_mode ^= 1;
					HAL_GPIO_WritePin(doodle_GPIO_Port, doodle_Pin, doodle_mode);
				}

				if (FX_press && (loops - loops_FX_press > 350)) {
					loops_FX_press = loops;
					FX_ind += 1;
					FX_ind %= 6;
					HAL_GPIO_WritePin(vibrato_GPIO_Port, vibrato_Pin, FX_bool_map[FX_ind] & 0b001); //1
					HAL_GPIO_WritePin(trem_GPIO_Port,    trem_Pin,    FX_bool_map[FX_ind] & 0b010);//2
					HAL_GPIO_WritePin(fxx_GPIO_Port,     fxx_Pin,     FX_bool_map[FX_ind] & 0b100);//3
				}
			}
			//TODO comment this back in if button works on different PCB
			// MOVED TO EXTI because mapping to blue mcu button instead (broken connection on my PCB).
//			if (PLA_press && (loops - loops_PLA_press > 350)) {
//				loops_PLA_press = loops;
//				PLA_ind += 1;
//				PLA_ind %= 3;
//				HAL_GPIO_WritePin(poly_GPIO_Port, poly_Pin,        PLA_disp_map[PLA_ind] & 0b1);
//				HAL_GPIO_WritePin(legato_GPIO_Port,legato_Pin,     PLA_disp_map[PLA_ind] & 0b10);
//				HAL_GPIO_WritePin(arpeggio_GPIO_Port, arpeggio_Pin,PLA_disp_map[PLA_ind] & 0b100);
//			}

			// If in hammond mode, treat sustain like a toggle switch
			if (sustain && (preset_ind == 6) && (loops - loops_sustain_press > 350)) {
				loops_sustain_press = loops;
				rotor ^= 1;
				HAL_GPIO_TogglePin(GPIOD, LD4_Pin);
			}

			// Calculate the waveform, fill the buffer.
			Calc_Wave();
		}
	}

  /* USER CODE END 3 */
}

/**
  * @brief System Clock Configuration
  * @retval None
  */
void SystemClock_Config(void)
{
  RCC_OscInitTypeDef RCC_OscInitStruct = {0};
  RCC_ClkInitTypeDef RCC_ClkInitStruct = {0};

  /** Configure the main internal regulator output voltage
  */
  __HAL_RCC_PWR_CLK_ENABLE();
  __HAL_PWR_VOLTAGESCALING_CONFIG(PWR_REGULATOR_VOLTAGE_SCALE1);

  /** Initializes the RCC Oscillators according to the specified parameters
  * in the RCC_OscInitTypeDef structure.
  */
  RCC_OscInitStruct.OscillatorType = RCC_OSCILLATORTYPE_HSE;
  RCC_OscInitStruct.HSEState = RCC_HSE_ON;
  RCC_OscInitStruct.PLL.PLLState = RCC_PLL_ON;
  RCC_OscInitStruct.PLL.PLLSource = RCC_PLLSOURCE_HSE;
  RCC_OscInitStruct.PLL.PLLM = 8;
  RCC_OscInitStruct.PLL.PLLN = 336;
  RCC_OscInitStruct.PLL.PLLP = RCC_PLLP_DIV2;
  RCC_OscInitStruct.PLL.PLLQ = 7;
  if (HAL_RCC_OscConfig(&RCC_OscInitStruct) != HAL_OK)
  {
    Error_Handler();
  }

  /** Initializes the CPU, AHB and APB buses clocks
  */
  RCC_ClkInitStruct.ClockType = RCC_CLOCKTYPE_HCLK|RCC_CLOCKTYPE_SYSCLK
                              |RCC_CLOCKTYPE_PCLK1|RCC_CLOCKTYPE_PCLK2;
  RCC_ClkInitStruct.SYSCLKSource = RCC_SYSCLKSOURCE_PLLCLK;
  RCC_ClkInitStruct.AHBCLKDivider = RCC_SYSCLK_DIV1;
  RCC_ClkInitStruct.APB1CLKDivider = RCC_HCLK_DIV4;
  RCC_ClkInitStruct.APB2CLKDivider = RCC_HCLK_DIV2;

  if (HAL_RCC_ClockConfig(&RCC_ClkInitStruct, FLASH_LATENCY_5) != HAL_OK)
  {
    Error_Handler();
  }
}

/**
  * @brief ADC1 Initialization Function
  * @param None
  * @retval None
  */
static void MX_ADC1_Init(void)
{

  /* USER CODE BEGIN ADC1_Init 0 */

  /* USER CODE END ADC1_Init 0 */

  ADC_ChannelConfTypeDef sConfig = {0};

  /* USER CODE BEGIN ADC1_Init 1 */

  /* USER CODE END ADC1_Init 1 */

  /** Configure the global features of the ADC (Clock, Resolution, Data Alignment and number of conversion)
  */
  hadc1.Instance = ADC1;
  hadc1.Init.ClockPrescaler = ADC_CLOCK_SYNC_PCLK_DIV4;
  hadc1.Init.Resolution = ADC_RESOLUTION_8B;
  hadc1.Init.ScanConvMode = ENABLE;
  hadc1.Init.ContinuousConvMode = DISABLE;
  hadc1.Init.DiscontinuousConvMode = DISABLE;
  hadc1.Init.ExternalTrigConvEdge = ADC_EXTERNALTRIGCONVEDGE_NONE;
  hadc1.Init.ExternalTrigConv = ADC_SOFTWARE_START;
  hadc1.Init.DataAlign = ADC_DATAALIGN_RIGHT;
  hadc1.Init.NbrOfConversion = 7;
  hadc1.Init.DMAContinuousRequests = DISABLE;
  hadc1.Init.EOCSelection = ADC_EOC_SINGLE_CONV;
  if (HAL_ADC_Init(&hadc1) != HAL_OK)
  {
    Error_Handler();
  }

  /** Configure for the selected ADC regular channel its corresponding rank in the sequencer and its sample time.
  */
  sConfig.Channel = ADC_CHANNEL_1;
  sConfig.Rank = 1;
  sConfig.SamplingTime = ADC_SAMPLETIME_56CYCLES;
  if (HAL_ADC_ConfigChannel(&hadc1, &sConfig) != HAL_OK)
  {
    Error_Handler();
  }

  /** Configure for the selected ADC regular channel its corresponding rank in the sequencer and its sample time.
  */
  sConfig.Channel = ADC_CHANNEL_3;
  sConfig.Rank = 2;
  if (HAL_ADC_ConfigChannel(&hadc1, &sConfig) != HAL_OK)
  {
    Error_Handler();
  }

  /** Configure for the selected ADC regular channel its corresponding rank in the sequencer and its sample time.
  */
  sConfig.Channel = ADC_CHANNEL_8;
  sConfig.Rank = 3;
  if (HAL_ADC_ConfigChannel(&hadc1, &sConfig) != HAL_OK)
  {
    Error_Handler();
  }

  /** Configure for the selected ADC regular channel its corresponding rank in the sequencer and its sample time.
  */
  sConfig.Channel = ADC_CHANNEL_9;
  sConfig.Rank = 4;
  if (HAL_ADC_ConfigChannel(&hadc1, &sConfig) != HAL_OK)
  {
    Error_Handler();
  }

  /** Configure for the selected ADC regular channel its corresponding rank in the sequencer and its sample time.
  */
  sConfig.Channel = ADC_CHANNEL_11;
  sConfig.Rank = 5;
  if (HAL_ADC_ConfigChannel(&hadc1, &sConfig) != HAL_OK)
  {
    Error_Handler();
  }

  /** Configure for the selected ADC regular channel its corresponding rank in the sequencer and its sample time.
  */
  sConfig.Channel = ADC_CHANNEL_12;
  sConfig.Rank = 6;
  if (HAL_ADC_ConfigChannel(&hadc1, &sConfig) != HAL_OK)
  {
    Error_Handler();
  }

  /** Configure for the selected ADC regular channel its corresponding rank in the sequencer and its sample time.
  */
  sConfig.Channel = ADC_CHANNEL_14;
  sConfig.Rank = 7;
  if (HAL_ADC_ConfigChannel(&hadc1, &sConfig) != HAL_OK)
  {
    Error_Handler();
  }
  /* USER CODE BEGIN ADC1_Init 2 */

  /* USER CODE END ADC1_Init 2 */

}

/**
  * @brief I2C1 Initialization Function
  * @param None
  * @retval None
  */
static void MX_I2C1_Init(void)
{

  /* USER CODE BEGIN I2C1_Init 0 */

  /* USER CODE END I2C1_Init 0 */

  /* USER CODE BEGIN I2C1_Init 1 */

  /* USER CODE END I2C1_Init 1 */
  hi2c1.Instance = I2C1;
  hi2c1.Init.ClockSpeed = 100000;
  hi2c1.Init.DutyCycle = I2C_DUTYCYCLE_2;
  hi2c1.Init.OwnAddress1 = 0;
  hi2c1.Init.AddressingMode = I2C_ADDRESSINGMODE_7BIT;
  hi2c1.Init.DualAddressMode = I2C_DUALADDRESS_DISABLE;
  hi2c1.Init.OwnAddress2 = 0;
  hi2c1.Init.GeneralCallMode = I2C_GENERALCALL_DISABLE;
  hi2c1.Init.NoStretchMode = I2C_NOSTRETCH_DISABLE;
  if (HAL_I2C_Init(&hi2c1) != HAL_OK)
  {
    Error_Handler();
  }
  /* USER CODE BEGIN I2C1_Init 2 */

  /* USER CODE END I2C1_Init 2 */

}

/**
  * @brief I2S3 Initialization Function
  * @param None
  * @retval None
  */
static void MX_I2S3_Init(void)
{

  /* USER CODE BEGIN I2S3_Init 0 */

  /* USER CODE END I2S3_Init 0 */

  /* USER CODE BEGIN I2S3_Init 1 */

  /* USER CODE END I2S3_Init 1 */
  hi2s3.Instance = SPI3;
  hi2s3.Init.Mode = I2S_MODE_MASTER_TX;
  hi2s3.Init.Standard = I2S_STANDARD_PHILIPS;
  hi2s3.Init.DataFormat = I2S_DATAFORMAT_16B;
  hi2s3.Init.MCLKOutput = I2S_MCLKOUTPUT_ENABLE;
  hi2s3.Init.AudioFreq = I2S_AUDIOFREQ_32K;
  hi2s3.Init.CPOL = I2S_CPOL_LOW;
  hi2s3.Init.ClockSource = I2S_CLOCK_PLL;
  hi2s3.Init.FullDuplexMode = I2S_FULLDUPLEXMODE_DISABLE;
  if (HAL_I2S_Init(&hi2s3) != HAL_OK)
  {
    Error_Handler();
  }
  /* USER CODE BEGIN I2S3_Init 2 */

  /* USER CODE END I2S3_Init 2 */

}

/**
  * @brief SPI1 Initialization Function
  * @param None
  * @retval None
  */
static void MX_SPI1_Init(void)
{

  /* USER CODE BEGIN SPI1_Init 0 */

  /* USER CODE END SPI1_Init 0 */

  /* USER CODE BEGIN SPI1_Init 1 */

  /* USER CODE END SPI1_Init 1 */
  /* SPI1 parameter configuration*/
  hspi1.Instance = SPI1;
  hspi1.Init.Mode = SPI_MODE_MASTER;
  hspi1.Init.Direction = SPI_DIRECTION_2LINES;
  hspi1.Init.DataSize = SPI_DATASIZE_8BIT;
  hspi1.Init.CLKPolarity = SPI_POLARITY_LOW;
  hspi1.Init.CLKPhase = SPI_PHASE_1EDGE;
  hspi1.Init.NSS = SPI_NSS_SOFT;
  hspi1.Init.BaudRatePrescaler = SPI_BAUDRATEPRESCALER_2;
  hspi1.Init.FirstBit = SPI_FIRSTBIT_MSB;
  hspi1.Init.TIMode = SPI_TIMODE_DISABLE;
  hspi1.Init.CRCCalculation = SPI_CRCCALCULATION_DISABLE;
  hspi1.Init.CRCPolynomial = 10;
  if (HAL_SPI_Init(&hspi1) != HAL_OK)
  {
    Error_Handler();
  }
  /* USER CODE BEGIN SPI1_Init 2 */

  /* USER CODE END SPI1_Init 2 */

}

/**
  * @brief USART2 Initialization Function
  * @param None
  * @retval None
  */
static void MX_USART2_UART_Init(void)
{

  /* USER CODE BEGIN USART2_Init 0 */

  /* USER CODE END USART2_Init 0 */

  /* USER CODE BEGIN USART2_Init 1 */

  /* USER CODE END USART2_Init 1 */
  huart2.Instance = USART2;
  huart2.Init.BaudRate = 31250;
  huart2.Init.WordLength = UART_WORDLENGTH_8B;
  huart2.Init.StopBits = UART_STOPBITS_1;
  huart2.Init.Parity = UART_PARITY_NONE;
  huart2.Init.Mode = UART_MODE_TX_RX;
  huart2.Init.HwFlowCtl = UART_HWCONTROL_NONE;
  huart2.Init.OverSampling = UART_OVERSAMPLING_16;
  if (HAL_UART_Init(&huart2) != HAL_OK)
  {
    Error_Handler();
  }
  /* USER CODE BEGIN USART2_Init 2 */

  /* USER CODE END USART2_Init 2 */

}

/**
  * @brief USB_OTG_FS Initialization Function
  * @param None
  * @retval None
  */
static void MX_USB_OTG_FS_PCD_Init(void)
{

  /* USER CODE BEGIN USB_OTG_FS_Init 0 */

  /* USER CODE END USB_OTG_FS_Init 0 */

  /* USER CODE BEGIN USB_OTG_FS_Init 1 */

  /* USER CODE END USB_OTG_FS_Init 1 */
  hpcd_USB_OTG_FS.Instance = USB_OTG_FS;
  hpcd_USB_OTG_FS.Init.dev_endpoints = 4;
  hpcd_USB_OTG_FS.Init.speed = PCD_SPEED_FULL;
  hpcd_USB_OTG_FS.Init.dma_enable = DISABLE;
  hpcd_USB_OTG_FS.Init.phy_itface = PCD_PHY_EMBEDDED;
  hpcd_USB_OTG_FS.Init.Sof_enable = DISABLE;
  hpcd_USB_OTG_FS.Init.low_power_enable = DISABLE;
  hpcd_USB_OTG_FS.Init.lpm_enable = DISABLE;
  hpcd_USB_OTG_FS.Init.vbus_sensing_enable = ENABLE;
  hpcd_USB_OTG_FS.Init.use_dedicated_ep1 = DISABLE;
  if (HAL_PCD_Init(&hpcd_USB_OTG_FS) != HAL_OK)
  {
    Error_Handler();
  }
  /* USER CODE BEGIN USB_OTG_FS_Init 2 */

  /* USER CODE END USB_OTG_FS_Init 2 */

}

/**
  * Enable DMA controller clock
  */
static void MX_DMA_Init(void)
{

  /* DMA controller clock enable */
  __HAL_RCC_DMA1_CLK_ENABLE();
  __HAL_RCC_DMA2_CLK_ENABLE();

  /* DMA interrupt init */
  /* DMA1_Stream5_IRQn interrupt configuration */
  HAL_NVIC_SetPriority(DMA1_Stream5_IRQn, 0, 0);
  HAL_NVIC_EnableIRQ(DMA1_Stream5_IRQn);
  /* DMA1_Stream7_IRQn interrupt configuration */
  HAL_NVIC_SetPriority(DMA1_Stream7_IRQn, 0, 0);
  HAL_NVIC_EnableIRQ(DMA1_Stream7_IRQn);
  /* DMA2_Stream0_IRQn interrupt configuration */
  HAL_NVIC_SetPriority(DMA2_Stream0_IRQn, 0, 0);
  HAL_NVIC_EnableIRQ(DMA2_Stream0_IRQn);

}

/**
  * @brief GPIO Initialization Function
  * @param None
  * @retval None
  */
static void MX_GPIO_Init(void)
{
  GPIO_InitTypeDef GPIO_InitStruct = {0};
  /* USER CODE BEGIN MX_GPIO_Init_1 */

  /* USER CODE END MX_GPIO_Init_1 */

  /* GPIO Ports Clock Enable */
  __HAL_RCC_GPIOE_CLK_ENABLE();
  __HAL_RCC_GPIOC_CLK_ENABLE();
  __HAL_RCC_GPIOH_CLK_ENABLE();
  __HAL_RCC_GPIOA_CLK_ENABLE();
  __HAL_RCC_GPIOB_CLK_ENABLE();
  __HAL_RCC_GPIOD_CLK_ENABLE();

  /*Configure GPIO pin Output Level */
  HAL_GPIO_WritePin(GPIOE, pre0_Pin|pre1_Pin, GPIO_PIN_SET);

  /*Configure GPIO pin Output Level */
  HAL_GPIO_WritePin(CS_I2C_SPI_GPIO_Port, CS_I2C_SPI_Pin, GPIO_PIN_RESET);

  /*Configure GPIO pin Output Level */
  HAL_GPIO_WritePin(GPIOC, doodle_Pin|OTG_FS_PowerSwitchOn_Pin|vibrato_Pin|fxx_Pin, GPIO_PIN_SET);

  /*Configure GPIO pin Output Level */
  HAL_GPIO_WritePin(GPIOD, LD4_Pin|LD3_Pin|LD5_Pin|LD6_Pin
                          |Audio_RST_Pin, GPIO_PIN_RESET);

  /*Configure GPIO pin Output Level */
  HAL_GPIO_WritePin(trem_GPIO_Port, trem_Pin, GPIO_PIN_SET);

  /*Configure GPIO pin Output Level */
  HAL_GPIO_WritePin(arpeggio_GPIO_Port, arpeggio_Pin, GPIO_PIN_SET);

  /*Configure GPIO pin Output Level */
  HAL_GPIO_WritePin(GPIOB, poly_Pin|legato_Pin|pre2_Pin, GPIO_PIN_SET);

  /*Configure GPIO pins : pre0_Pin pre1_Pin */
  GPIO_InitStruct.Pin = pre0_Pin|pre1_Pin;
  GPIO_InitStruct.Mode = GPIO_MODE_OUTPUT_PP;
  GPIO_InitStruct.Pull = GPIO_PULLUP;
  GPIO_InitStruct.Speed = GPIO_SPEED_FREQ_LOW;
  HAL_GPIO_Init(GPIOE, &GPIO_InitStruct);

  /*Configure GPIO pin : CS_I2C_SPI_Pin */
  GPIO_InitStruct.Pin = CS_I2C_SPI_Pin;
  GPIO_InitStruct.Mode = GPIO_MODE_OUTPUT_PP;
  GPIO_InitStruct.Pull = GPIO_NOPULL;
  GPIO_InitStruct.Speed = GPIO_SPEED_FREQ_LOW;
  HAL_GPIO_Init(CS_I2C_SPI_GPIO_Port, &GPIO_InitStruct);

  /*Configure GPIO pins : doodle_button_Pin preset_button_Pin */
  GPIO_InitStruct.Pin = doodle_button_Pin|preset_button_Pin;
  GPIO_InitStruct.Mode = GPIO_MODE_INPUT;
  GPIO_InitStruct.Pull = GPIO_NOPULL;
  HAL_GPIO_Init(GPIOE, &GPIO_InitStruct);

  /*Configure GPIO pins : doodle_Pin OTG_FS_PowerSwitchOn_Pin */
  GPIO_InitStruct.Pin = doodle_Pin|OTG_FS_PowerSwitchOn_Pin;
  GPIO_InitStruct.Mode = GPIO_MODE_OUTPUT_PP;
  GPIO_InitStruct.Pull = GPIO_NOPULL;
  GPIO_InitStruct.Speed = GPIO_SPEED_FREQ_LOW;
  HAL_GPIO_Init(GPIOC, &GPIO_InitStruct);

  /*Configure GPIO pin : PDM_OUT_Pin */
  GPIO_InitStruct.Pin = PDM_OUT_Pin;
  GPIO_InitStruct.Mode = GPIO_MODE_AF_PP;
  GPIO_InitStruct.Pull = GPIO_NOPULL;
  GPIO_InitStruct.Speed = GPIO_SPEED_FREQ_LOW;
  GPIO_InitStruct.Alternate = GPIO_AF5_SPI2;
  HAL_GPIO_Init(PDM_OUT_GPIO_Port, &GPIO_InitStruct);

  /*Configure GPIO pin : B1_Pin */
  GPIO_InitStruct.Pin = B1_Pin;
  GPIO_InitStruct.Mode = GPIO_MODE_IT_RISING;
  GPIO_InitStruct.Pull = GPIO_NOPULL;
  HAL_GPIO_Init(B1_GPIO_Port, &GPIO_InitStruct);

  /*Configure GPIO pins : BOOT1_Pin PLA_button_Pin */
  GPIO_InitStruct.Pin = BOOT1_Pin|PLA_button_Pin;
  GPIO_InitStruct.Mode = GPIO_MODE_INPUT;
  GPIO_InitStruct.Pull = GPIO_NOPULL;
  HAL_GPIO_Init(GPIOB, &GPIO_InitStruct);

  /*Configure GPIO pin : CLK_IN_Pin */
  GPIO_InitStruct.Pin = CLK_IN_Pin;
  GPIO_InitStruct.Mode = GPIO_MODE_AF_PP;
  GPIO_InitStruct.Pull = GPIO_NOPULL;
  GPIO_InitStruct.Speed = GPIO_SPEED_FREQ_LOW;
  GPIO_InitStruct.Alternate = GPIO_AF5_SPI2;
  HAL_GPIO_Init(CLK_IN_GPIO_Port, &GPIO_InitStruct);

  /*Configure GPIO pins : LD4_Pin LD3_Pin LD5_Pin LD6_Pin */
  GPIO_InitStruct.Pin = LD4_Pin|LD3_Pin|LD5_Pin|LD6_Pin;
  GPIO_InitStruct.Mode = GPIO_MODE_OUTPUT_PP;
  GPIO_InitStruct.Pull = GPIO_NOPULL;
  GPIO_InitStruct.Speed = GPIO_SPEED_FREQ_LOW;
  HAL_GPIO_Init(GPIOD, &GPIO_InitStruct);

  /*Configure GPIO pins : vibrato_Pin fxx_Pin */
  GPIO_InitStruct.Pin = vibrato_Pin|fxx_Pin;
  GPIO_InitStruct.Mode = GPIO_MODE_OUTPUT_PP;
  GPIO_InitStruct.Pull = GPIO_PULLUP;
  GPIO_InitStruct.Speed = GPIO_SPEED_FREQ_LOW;
  HAL_GPIO_Init(GPIOC, &GPIO_InitStruct);

  /*Configure GPIO pin : trem_Pin */
  GPIO_InitStruct.Pin = trem_Pin;
  GPIO_InitStruct.Mode = GPIO_MODE_OUTPUT_PP;
  GPIO_InitStruct.Pull = GPIO_PULLUP;
  GPIO_InitStruct.Speed = GPIO_SPEED_FREQ_LOW;
  HAL_GPIO_Init(trem_GPIO_Port, &GPIO_InitStruct);

  /*Configure GPIO pins : FX_button_Pin OTG_FS_OverCurrent_Pin */
  GPIO_InitStruct.Pin = FX_button_Pin|OTG_FS_OverCurrent_Pin;
  GPIO_InitStruct.Mode = GPIO_MODE_INPUT;
  GPIO_InitStruct.Pull = GPIO_NOPULL;
  HAL_GPIO_Init(GPIOD, &GPIO_InitStruct);

  /*Configure GPIO pins : Audio_RST_Pin arpeggio_Pin */
  GPIO_InitStruct.Pin = Audio_RST_Pin|arpeggio_Pin;
  GPIO_InitStruct.Mode = GPIO_MODE_OUTPUT_PP;
  GPIO_InitStruct.Pull = GPIO_PULLUP;
  GPIO_InitStruct.Speed = GPIO_SPEED_FREQ_LOW;
  HAL_GPIO_Init(GPIOD, &GPIO_InitStruct);

  /*Configure GPIO pins : poly_Pin legato_Pin pre2_Pin */
  GPIO_InitStruct.Pin = poly_Pin|legato_Pin|pre2_Pin;
  GPIO_InitStruct.Mode = GPIO_MODE_OUTPUT_PP;
  GPIO_InitStruct.Pull = GPIO_PULLUP;
  GPIO_InitStruct.Speed = GPIO_SPEED_FREQ_LOW;
  HAL_GPIO_Init(GPIOB, &GPIO_InitStruct);

  /*Configure GPIO pin : MEMS_INT2_Pin */
  GPIO_InitStruct.Pin = MEMS_INT2_Pin;
  GPIO_InitStruct.Mode = GPIO_MODE_EVT_RISING;
  GPIO_InitStruct.Pull = GPIO_NOPULL;
  HAL_GPIO_Init(MEMS_INT2_GPIO_Port, &GPIO_InitStruct);

  /* EXTI interrupt init*/
  HAL_NVIC_SetPriority(EXTI0_IRQn, 0, 0);
  HAL_NVIC_EnableIRQ(EXTI0_IRQn);

  /* USER CODE BEGIN MX_GPIO_Init_2 */

  /* USER CODE END MX_GPIO_Init_2 */
}

/* USER CODE BEGIN 4 */
// This is what maps printf to serial wire viewer.
int _write(int file, char *ptr, int len) {
	(void) file;
	int DataIdx;

	for (DataIdx = 0; DataIdx < len; DataIdx++) {
		ITM_SendChar(*ptr++);
	}
	return len;
}
/* USER CODE END 4 */

/**
  * @brief  This function is executed in case of error occurrence.
  * @retval None
  */
void Error_Handler(void)
{
  /* USER CODE BEGIN Error_Handler_Debug */
	/* User can add his own implementation to report the HAL error return state */
	__disable_irq();
	while (1) {
		//printf("Error\r\n");
		HAL_GPIO_TogglePin(GPIOD, LD4_Pin);
		HAL_Delay(500);
	}
  /* USER CODE END Error_Handler_Debug */
}

#ifdef  USE_FULL_ASSERT
/**
  * @brief  Reports the name of the source file and the source line number
  *         where the assert_param error has occurred.
  * @param  file: pointer to the source file name
  * @param  line: assert_param error line source number
  * @retval None
  */
void assert_failed(uint8_t *file, uint32_t line)
{
  /* USER CODE BEGIN 6 */
	/* User can add his own implementation to report the file name and line number,
     ex: printf("Wrong parameters value: file %s on line %d\r\n", file, line) */
  /* USER CODE END 6 */
}
#endif /* USE_FULL_ASSERT */
